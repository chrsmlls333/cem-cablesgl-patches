"use strict";var CABLES=CABLES||{};CABLES.OPS=CABLES.OPS||{};var Ops=Ops||{};Ops.Gl=Ops.Gl||{},Ops.Ui=Ops.Ui||{},Ops.Anim=Ops.Anim||{},Ops.Date=Ops.Date||{},Ops.Html=Ops.Html||{},Ops.Json=Ops.Json||{},Ops.Math=Ops.Math||{},Ops.Time=Ops.Time||{},Ops.Vars=Ops.Vars||{},Ops.Array=Ops.Array||{},Ops.Patch=Ops.Patch||{},Ops.Value=Ops.Value||{},Ops.Cables=Ops.Cables||{},Ops.String=Ops.String||{},Ops.Boolean=Ops.Boolean||{},Ops.Devices=Ops.Devices||{},Ops.Trigger=Ops.Trigger||{},Ops.Website=Ops.Website||{},Ops.TimeLine=Ops.TimeLine||{},Ops.Extension=Ops.Extension||{},Ops.Gl.Meshes=Ops.Gl.Meshes||{},Ops.Gl.Shader=Ops.Gl.Shader||{},Ops.Gl.Textures=Ops.Gl.Textures||{},Ops.Math.Compare=Ops.Math.Compare||{},Ops.Devices.Mouse=Ops.Devices.Mouse||{},Ops.Patch.Pw01AEC=Ops.Patch.Pw01AEC||{},Ops.Devices.Mobile=Ops.Devices.Mobile||{},Ops.Devices.Keyboard=Ops.Devices.Keyboard||{},Ops.Extension.FxHash=Ops.Extension.FxHash||{},Ops.Gl.TextureEffects=Ops.Gl.TextureEffects||{},Ops.Gl.TextureEffects.Noise=Ops.Gl.TextureEffects.Noise||{},Ops.Gl.MainLoop=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inValue("FPS Limit",0),n=e.outTrigger("trigger"),r=e.outNumber("width"),o=e.outNumber("height"),i=e.inValueBool("Reduce FPS not focussed",!0),a=e.inValueBool("Reduce FPS loading"),s=e.inValueBool("Clear",!0),l=e.inValueBool("ClearAlpha",!0),g=e.inValueBool("Fullscreen Button",!1),c=e.inValueBool("Active",!0),u=e.inValueBool("Hires Displays",!1),p=e.inSwitch("Pixel Unit",["Display","CSS"],"Display");e.onAnimFrame=A,u.onChange=function(){u.get()?e.patch.cgl.pixelDensity=window.devicePixelRatio:e.patch.cgl.pixelDensity=1,e.patch.cgl.updateSize(),CABLES.UI&&gui.setLayout()},c.onChange=function(){e.patch.removeOnAnimFrame(e),c.get()?(e.setUiAttrib({extendTitle:""}),e.onAnimFrame=A,e.patch.addOnAnimFrame(e),e.log("adding again!")):e.setUiAttrib({extendTitle:"Inactive"})};const f=e.patch.cgl;let h=0,d=0;e.patch.cgl||e.uiAttr({error:"No webgl cgl context"});const m=vec3.create();vec3.set(m,0,0,0);const C=vec3.create();vec3.set(C,0,0,-2),g.onChange=E,setTimeout(E,100);let S=null,O=!0,x=!0;function b(){if(a.get()&&e.patch.loading.getProgress()<1)return 5;if(i.get()){if(!x)return 10;if(!O)return 30}return t.get()}function E(){function t(){S&&(S.style.display="block")}if(e.patch.cgl.canvas.addEventListener("mouseleave",(function(){S&&(S.style.display="none")})),e.patch.cgl.canvas.addEventListener("mouseenter",t),g.get()){if(!S){S=document.createElement("div");const n=e.patch.cgl.canvas.parentElement;n&&n.appendChild(S),S.addEventListener("mouseenter",t),S.addEventListener("click",(function(e){CABLES.UI&&!e.shiftKey?gui.cycleFullscreen():f.fullScreen()}))}S.style.padding="10px",S.style.position="absolute",S.style.right="5px",S.style.top="5px",S.style.width="20px",S.style.height="20px",S.style.cursor="pointer",S.style["border-radius"]="40px",S.style.background="#444",S.style["z-index"]="9999",S.style.display="none",S.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="Capa_1" x="0px" y="0px" viewBox="0 0 490 490" style="width:20px;height:20px;" xml:space="preserve" width="512px" height="512px"><g><path d="M173.792,301.792L21.333,454.251v-80.917c0-5.891-4.776-10.667-10.667-10.667C4.776,362.667,0,367.442,0,373.333V480     c0,5.891,4.776,10.667,10.667,10.667h106.667c5.891,0,10.667-4.776,10.667-10.667s-4.776-10.667-10.667-10.667H36.416     l152.459-152.459c4.093-4.237,3.975-10.99-0.262-15.083C184.479,297.799,177.926,297.799,173.792,301.792z" fill="#FFFFFF"/><path d="M480,0H373.333c-5.891,0-10.667,4.776-10.667,10.667c0,5.891,4.776,10.667,10.667,10.667h80.917L301.792,173.792     c-4.237,4.093-4.354,10.845-0.262,15.083c4.093,4.237,10.845,4.354,15.083,0.262c0.089-0.086,0.176-0.173,0.262-0.262     L469.333,36.416v80.917c0,5.891,4.776,10.667,10.667,10.667s10.667-4.776,10.667-10.667V10.667C490.667,4.776,485.891,0,480,0z" fill="#FFFFFF"/><path d="M36.416,21.333h80.917c5.891,0,10.667-4.776,10.667-10.667C128,4.776,123.224,0,117.333,0H10.667     C4.776,0,0,4.776,0,10.667v106.667C0,123.224,4.776,128,10.667,128c5.891,0,10.667-4.776,10.667-10.667V36.416l152.459,152.459     c4.237,4.093,10.99,3.975,15.083-0.262c3.992-4.134,3.992-10.687,0-14.82L36.416,21.333z" fill="#FFFFFF"/><path d="M480,362.667c-5.891,0-10.667,4.776-10.667,10.667v80.917L316.875,301.792c-4.237-4.093-10.99-3.976-15.083,0.261     c-3.993,4.134-3.993,10.688,0,14.821l152.459,152.459h-80.917c-5.891,0-10.667,4.776-10.667,10.667s4.776,10.667,10.667,10.667     H480c5.891,0,10.667-4.776,10.667-10.667V373.333C490.667,367.442,485.891,362.667,480,362.667z" fill="#FFFFFF"/></g></svg>'}else S&&(S.style.display="none",S.remove(),S=null)}function A(t){if(!c.get())return;if(f.aborted||0===f.canvas.clientWidth||0===f.canvas.clientHeight)return;e.patch.cg=f;const i=performance.now();if(e.patch.config.fpsLimit=b(),-1!=f.canvasWidth){if(f.canvasWidth!=r.get()||f.canvasHeight!=o.get()){let t=1;"CSS"==p.get()&&(t=e.patch.cgl.pixelDensity),r.set(f.canvasWidth/t),o.set(f.canvasHeight/t)}CABLES.now()-d>1e3&&(CGL.fpsReport=CGL.fpsReport||[],e.patch.loading.getProgress()>=1&&0!==d&&CGL.fpsReport.push(h),h=0,d=CABLES.now()),CGL.MESH.lastShader=null,CGL.MESH.lastMesh=null,f.renderStart(f,m,C),s.get()&&(f.gl.clearColor(0,0,0,1),f.gl.clear(f.gl.COLOR_BUFFER_BIT|f.gl.DEPTH_BUFFER_BIT)),n.trigger(),CGL.MESH.lastMesh&&CGL.MESH.lastMesh.unBind(),CGL.Texture.previewTexture&&(CGL.Texture.texturePreviewer||(CGL.Texture.texturePreviewer=new CGL.Texture.texturePreview(f)),CGL.Texture.texturePreviewer.render(CGL.Texture.previewTexture)),f.renderEnd(f),e.patch.cg=null,l.get()&&(f.gl.clearColor(1,1,1,1),f.gl.colorMask(!1,!1,!1,!0),f.gl.clear(f.gl.COLOR_BUFFER_BIT),f.gl.colorMask(!0,!0,!0,!0)),f.frameStore.phong||(f.frameStore.phong={}),h++,e.patch.cgl.profileData.profileMainloopMs=performance.now()-i}else f.setCanvas(e.patch.config.glCanvasId)}function T(){setTimeout((()=>{e.patch.getOpsByObjName(e.name).length>1?(e.setUiError("multimainloop","there should only be one mainloop op!"),e.patch.addEventListener("onOpDelete",T)):e.setUiError("multimainloop",null,1)}),500)}window.addEventListener("blur",(()=>{O=!1})),window.addEventListener("focus",(()=>{O=!0})),document.addEventListener("visibilitychange",(()=>{x=!document.hidden})),T(),p.onChange=()=>{r.set(0),o.set(0)},e.onDelete=function(){f.gl.clearColor(0,0,0,0),f.gl.clear(f.gl.COLOR_BUFFER_BIT|f.gl.DEPTH_BUFFER_BIT)}},Ops.Gl.MainLoop.prototype=new CABLES.Op,CABLES.OPS["b0472a1d-db16-4ba6-8787-f300fbdc77bb"]={f:Ops.Gl.MainLoop,objName:"Ops.Gl.MainLoop"},Ops.Math.DegreeToVector=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inValueFloat("degree",0),n=e.outNumber("x"),r=e.outNumber("y");function o(){let e=t.get()*CGL.DEG2RAD;n.set(-1*Math.sin(e)),r.set(Math.cos(e))}t.onChange=o},Ops.Math.DegreeToVector.prototype=new CABLES.Op,CABLES.OPS["56b1618b-4eed-41a8-87a2-57397ffc9029"]={f:Ops.Math.DegreeToVector,objName:"Ops.Math.DegreeToVector"},Ops.Trigger.Sequence=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inTrigger("exe"),n=e.inTriggerButton("Clean up connections"),r=[],o=[],i=16;let a=null,s=[];t.onTriggered=c,n.onTriggered=u,n.setUiAttribs({hideParam:!0,hidePort:!0});for(let t=0;t<i;t++){const n=e.outTrigger("trigger "+t);if(o.push(n),n.onLinkChanged=g,t<i-1){let n=e.inTrigger("exe "+t);n.onTriggered=c,r.push(n)}}function l(){s.length=0;for(let e=0;e<o.length;e++)o[e].links.length>0&&s.push(o[e])}function g(){l(),clearTimeout(a),a=setTimeout((()=>{let t=!1;for(let e=0;e<o.length;e++)o[e].links.length>1&&(t=!0);n.setUiAttribs({hideParam:!t}),e.isCurrentUiOp()&&e.refreshParams()}),60)}function c(){for(let e=0;e<s.length;e++)s[e].trigger()}function u(){let t=0;for(let n=0;n<o.length;n++){let r=[];if(o[n].links.length>1)for(let i=1;i<o[n].links.length;i++){for(;o[t].links.length>0;)t++;r.push(o[n].links[i]);const a=o[n].links[i].getOtherPort(o[n]);e.patch.link(e,"trigger "+t,a.op,a.name),t++}for(let e=0;e<r.length;e++)r[e].remove()}g(),l()}l()},Ops.Trigger.Sequence.prototype=new CABLES.Op,CABLES.OPS["a466bc1f-06e9-4595-8849-bffb9fe22f99"]={f:Ops.Trigger.Sequence,objName:"Ops.Trigger.Sequence"},Ops.Gl.TextureEffects.ImageCompose_v3=function(){CABLES.Op.apply(this,arguments);const e=this,t={imgcomp_frag:"IN vec2 texCoord;\nUNI vec4 bgColor;\nUNI sampler2D tex;\n#ifdef USE_UVTEX\nUNI sampler2D UVTex;\n#endif\n\nvoid main()\n{\n\n    #ifndef USE_TEX\n        outColor=bgColor;\n    #endif\n    #ifdef USE_TEX\n        #ifndef USE_UVTEX\n        outColor=texture(tex,texCoord);\n        #else\n        outColor=texture(tex,texture(UVTex,texCoord).xy);\n        #endif\n    #endif\n\n\n\n}\n"},n=e.patch.cgl,r=e.inTrigger("Render"),o=e.inTexture("Base Texture"),i=e.inTexture("UV Texture"),a=e.inSwitch("Size",["Auto","Manual"],"Auto"),s=e.inValueInt("Width",640),l=e.inValueInt("Height",480),g=e.inSwitch("Filter",["nearest","linear","mipmap"],"linear"),c=e.inValueSelect("Wrap",["clamp to edge","repeat","mirrored repeat"],"repeat"),u=e.inDropDown("Pixel Format",CGL.Texture.PIXELFORMATS,CGL.Texture.PFORMATSTR_RGBA8UB),p=e.inValueSlider("R",0),f=e.inValueSlider("G",0),h=e.inValueSlider("B",0),d=e.inValueSlider("A",0),m=e.outTrigger("Next"),C=e.outTexture("texture_out",CGL.Texture.getEmptyTexture(n)),S=e.outNumber("Aspect Ratio"),O=e.outNumber("Texture Width"),x=e.outNumber("Texture Height");e.setPortGroup("Texture Size",[a,s,l]),e.setPortGroup("Texture Parameters",[c,g,u]),p.setUiAttribs({colorPick:!0}),e.setPortGroup("Color",[p,f,h,d]),e.toWorkPortsNeedToBeLinked(r);const b=[0,0,0,0];let E=null,A=null,T=!0,y=!1,L=null,v=null,B=null,w=null;function P(){E&&E.delete(),A&&A.delete(),E=new CGL.TextureEffect(n,{isFloatingPointTexture:CGL.Texture.isPixelFormatFloat(u.get())}),A=new CGL.Texture(n,{name:"image_compose_v2_"+e.id,isFloatingPointTexture:CGL.Texture.isPixelFormatFloat(u.get()),pixelFormat:u.get(),filter:N(),wrap:_(),width:M(),height:V()}),E.setSourceTexture(A),O.set(M()),x.set(V()),S.set(M()/V()),C.set(CGL.Texture.getEmptyTexture(n)),T=!1,U()}function N(){return"nearest"==g.get()?CGL.Texture.FILTER_NEAREST:"linear"==g.get()?CGL.Texture.FILTER_LINEAR:"mipmap"==g.get()?CGL.Texture.FILTER_MIPMAP:void 0}function _(){return"repeat"==c.get()?CGL.Texture.WRAP_REPEAT:"mirrored repeat"==c.get()?CGL.Texture.WRAP_MIRRORED_REPEAT:"clamp to edge"==c.get()?CGL.Texture.WRAP_CLAMP_TO_EDGE:void 0}function M(){return o.get()&&"Auto"==a.get()?o.get().width:"Auto"==a.get()?n.getViewPort()[2]:Math.ceil(s.get())}function V(){return o.get()&&"Auto"==a.get()?o.get().height:"Auto"==a.get()?n.getViewPort()[3]:Math.ceil(l.get())}function G(){T=!0}function F(){M()==A.width&&V()==A.height&&A.isFloatingPoint()==CGL.Texture.isPixelFormatFloat(u.get())&&A.pixelFormat==u.get()&&A.filter==N()&&A.wrap==_()||0===M()||0===V()||(P(),E.setSourceTexture(A),C.set(CGL.Texture.getEmptyTexture(n)),C.set(A),I(),D())}function I(){let t=null;"Manual"==a.get()?t=null:"Auto"==a.get()&&(t=o.get()?"Input Texture":"Canvas Size",t+=": "+M()+" x "+V());let n=!1;n=a.uiAttribs.info!=t,a.setUiAttribs({info:t}),n&&e.refreshParams()}function R(){L&&L.toggleDefine("USE_TEX",o.isLinked()),L&&L.toggleDefine("USE_UVTEX",i.isLinked())}function U(){p.setUiAttribs({greyout:o.isLinked()}),h.setUiAttribs({greyout:o.isLinked()}),f.setUiAttribs({greyout:o.isLinked()}),d.setUiAttribs({greyout:o.isLinked()}),s.setUiAttribs({greyout:"Auto"==a.get()}),l.setUiAttribs({greyout:"Auto"==a.get()}),s.setUiAttribs({hideParam:"Manual"!=a.get()}),l.setUiAttribs({hideParam:"Manual"!=a.get()}),A&&(CGL.Texture.isPixelFormatFloat(u.get())&&N()==CGL.Texture.FILTER_MIPMAP?e.setUiError("fpmipmap","Don't use mipmap and 32bit at the same time, many systems do not support this."):e.setUiError("fpmipmap",null)),I(),R(),D()}function D(){A&&(o.isLinked()&&o.get()&&A.textureType!=o.get().textureType&&(A.textureType!=CGL.Texture.TYPE_FLOAT||o.get().textureType==CGL.Texture.TYPE_FLOAT)?e.setUiError("textypediff","Drawing 32bit texture into an 8 bit can result in data/precision loss",1):e.setUiError("textypediff",null))}function k(){L||(L=new CGL.Shader(n,"copytextureshader"),L.setSource(L.getDefaultVertexShader(),t.imgcomp_frag),v=new CGL.Uniform(L,"t","tex",0),B=new CGL.Uniform(L,"t","UVTex",1),w=new CGL.Uniform(L,"4f","bgColor",p,f,h,d),R()),n.pushShader(L),n.currentTextureEffect.bind(),o.get()&&n.setTexture(0,o.get().tex),i.get()&&n.setTexture(1,i.get().tex),n.currentTextureEffect.finish(),n.popShader()}function z(){E&&!T||P();const e=n.getViewPort();b[0]=e[0],b[1]=e[1],b[2]=e[2],b[3]=e[3],n.pushBlend(!1),F();const t=n.currentTextureEffect;n.currentTextureEffect=E,n.currentTextureEffect.imgCompVer=3,n.currentTextureEffect.width=s.get(),n.currentTextureEffect.height=l.get(),E.setSourceTexture(A),E.startEffect(o.get()||CGL.Texture.getEmptyTexture(n,y),!0),k(),m.trigger(),C.setRef(E.getCurrentSourceTexture()),E.endEffect(),n.setViewPort(b[0],b[1],b[2],b[3]),n.popBlend(!1),n.currentTextureEffect=t}c.onChange=g.onChange=u.onChange=G,o.onLinkChanged=a.onChange=i.onChange=U,r.onTriggered=e.preRender=z,U(),e.preRender=()=>{z()}},Ops.Gl.TextureEffects.ImageCompose_v3.prototype=new CABLES.Op,CABLES.OPS["e890a050-11b7-456e-b09b-d08cd9c1ee41"]={f:Ops.Gl.TextureEffects.ImageCompose_v3,objName:"Ops.Gl.TextureEffects.ImageCompose_v3"},Ops.Gl.TextureEffects.DrawImage_v3=function(){CABLES.Op.apply(this,arguments);const e=this,t={drawimage_frag:"#ifdef HAS_TEXTURES\n    IN vec2 texCoord;\n    UNI sampler2D tex;\n    UNI sampler2D image;\n#endif\n\n#ifdef TEX_TRANSFORM\n    IN mat3 transform;\n#endif\n// UNI float rotate;\n\n{{CGL.BLENDMODES}}\n\n#ifdef HAS_TEXTUREALPHA\n   UNI sampler2D imageAlpha;\n#endif\n\nUNI float amount;\n\n#ifdef ASPECT_RATIO\n    UNI float aspectTex;\n    UNI float aspectPos;\n#endif\n\nvoid main()\n{\n    vec4 blendRGBA=vec4(0.0,0.0,0.0,1.0);\n\n    #ifdef HAS_TEXTURES\n        vec2 tc=texCoord;\n\n        #ifdef TEX_FLIP_X\n            tc.x=1.0-tc.x;\n        #endif\n        #ifdef TEX_FLIP_Y\n            tc.y=1.0-tc.y;\n        #endif\n\n        #ifdef ASPECT_RATIO\n            #ifdef ASPECT_AXIS_X\n                tc.y=(1.0-aspectPos)-(((1.0-aspectPos)-tc.y)*aspectTex);\n            #endif\n            #ifdef ASPECT_AXIS_Y\n                tc.x=(1.0-aspectPos)-(((1.0-aspectPos)-tc.x)/aspectTex);\n            #endif\n        #endif\n\n        #ifdef TEX_TRANSFORM\n            vec3 coordinates=vec3(tc.x, tc.y,1.0);\n            tc=(transform * coordinates ).xy;\n        #endif\n\n        blendRGBA=texture(image,tc);\n\n        vec3 blend=blendRGBA.rgb;\n        vec4 baseRGBA=texture(tex,texCoord);\n        vec3 base=baseRGBA.rgb;\n\n\n        #ifdef PREMUL\n            blend.rgb = (blend.rgb) + (base.rgb * (1.0 - blendRGBA.a));\n        #endif\n\n        vec3 colNew=_blend(base,blend);\n\n\n\n\n        #ifdef REMOVE_ALPHA_SRC\n            blendRGBA.a=1.0;\n        #endif\n\n        #ifdef HAS_TEXTUREALPHA\n            vec4 colImgAlpha=texture(imageAlpha,tc);\n            float colImgAlphaAlpha=colImgAlpha.a;\n\n            #ifdef ALPHA_FROM_LUMINANCE\n                vec3 gray = vec3(dot(vec3(0.2126,0.7152,0.0722), colImgAlpha.rgb ));\n                colImgAlphaAlpha=(gray.r+gray.g+gray.b)/3.0;\n            #endif\n\n            #ifdef ALPHA_FROM_INV_UMINANCE\n                vec3 gray = vec3(dot(vec3(0.2126,0.7152,0.0722), colImgAlpha.rgb ));\n                colImgAlphaAlpha=1.0-(gray.r+gray.g+gray.b)/3.0;\n            #endif\n\n            #ifdef INVERT_ALPHA\n                colImgAlphaAlpha=clamp(colImgAlphaAlpha,0.0,1.0);\n                colImgAlphaAlpha=1.0-colImgAlphaAlpha;\n            #endif\n\n            blendRGBA.a=colImgAlphaAlpha*blendRGBA.a;\n        #endif\n    #endif\n\n    float am=amount;\n\n    #ifdef CLIP_REPEAT\n        if(tc.y>1.0 || tc.y<0.0 || tc.x>1.0 || tc.x<0.0)\n        {\n            // colNew.rgb=vec3(0.0);\n            am=0.0;\n        }\n    #endif\n\n    #ifdef ASPECT_RATIO\n        #ifdef ASPECT_CROP\n            if(tc.y>1.0 || tc.y<0.0 || tc.x>1.0 || tc.x<0.0)\n            {\n                colNew.rgb=base.rgb;\n                am=0.0;\n            }\n\n        #endif\n    #endif\n\n\n\n    #ifndef PREMUL\n        blendRGBA.rgb=mix(colNew,base,1.0-(am*blendRGBA.a));\n        blendRGBA.a=clamp(baseRGBA.a+(blendRGBA.a*am),0.,1.);\n    #endif\n\n    #ifdef PREMUL\n        // premultiply\n        // blendRGBA.rgb = (blendRGBA.rgb) + (baseRGBA.rgb * (1.0 - blendRGBA.a));\n        blendRGBA=vec4(\n            mix(colNew.rgb,base,1.0-(am*blendRGBA.a)),\n            blendRGBA.a*am+baseRGBA.a\n            );\n    #endif\n\n    #ifdef ALPHA_MASK\n    blendRGBA.a=baseRGBA.a;\n    #endif\n\n    outColor=blendRGBA;\n}\n\n\n\n\n\n\n\n",drawimage_vert:"IN vec3 vPosition;\nIN vec2 attrTexCoord;\nIN vec3 attrVertNormal;\n\nUNI mat4 projMatrix;\nUNI mat4 mvMatrix;\n\nOUT vec2 texCoord;\n// OUT vec3 norm;\n\n#ifdef TEX_TRANSFORM\n    UNI float posX;\n    UNI float posY;\n    UNI float scaleX;\n    UNI float scaleY;\n    UNI float rotate;\n    OUT mat3 transform;\n#endif\n\nvoid main()\n{\n   texCoord=attrTexCoord;\n//   norm=attrVertNormal;\n\n   #ifdef TEX_TRANSFORM\n        vec3 coordinates=vec3(attrTexCoord.x, attrTexCoord.y,1.0);\n        float angle = radians( rotate );\n        vec2 scale= vec2(scaleX,scaleY);\n        vec2 translate= vec2(posX,posY);\n\n        transform = mat3(   scale.x * cos( angle ), scale.x * sin( angle ), 0.0,\n            - scale.y * sin( angle ), scale.y * cos( angle ), 0.0,\n            - 0.5 * scale.x * cos( angle ) + 0.5 * scale.y * sin( angle ) - 0.5 * translate.x*2.0 + 0.5,  - 0.5 * scale.x * sin( angle ) - 0.5 * scale.y * cos( angle ) - 0.5 * translate.y*2.0 + 0.5, 1.0);\n   #endif\n\n   gl_Position = projMatrix * mvMatrix * vec4(vPosition,  1.0);\n}\n"},n=e.inTrigger("render"),r=CGL.TextureEffect.AddBlendSelect(e,"blendMode"),o=e.inValueSlider("amount",1),i=e.inTexture("Image"),a=e.inValueBool("Premultiplied",!1),s=e.inValueBool("Alpha Mask",!1),l=e.inValueBool("removeAlphaSrc",!1),g=e.inTexture("Mask"),c=e.inValueSelect("Mask Src",["alpha channel","luminance","luminance inv"],"luminance"),u=e.inValueBool("Invert alpha channel"),p=e.inValueBool("Aspect Ratio",!1),f=e.inValueSelect("Stretch Axis",["X","Y"],"X"),h=e.inValueSlider("Position",0),d=e.inValueBool("Crop",!1),m=e.outTrigger("trigger");r.set("normal");const C=e.patch.cgl,S=new CGL.Shader(C,"drawimage");function O(){g.isLinked()?(l.setUiAttribs({greyout:!0}),c.setUiAttribs({greyout:!1}),u.setUiAttribs({greyout:!1})):(l.setUiAttribs({greyout:!1}),c.setUiAttribs({greyout:!0}),u.setUiAttribs({greyout:!0}))}g.onLinkChanged=O,e.setPortGroup("Mask",[g,c,u]),e.setPortGroup("Aspect Ratio",[p,h,d,f]),e.toWorkPortsNeedToBeLinked(i),S.setSource(t.drawimage_vert,t.drawimage_frag),new CGL.Uniform(S,"t","tex",0),new CGL.Uniform(S,"t","image",1),new CGL.Uniform(S,"t","imageAlpha",2);const x=new CGL.Uniform(S,"f","aspectTex",1);function b(){S.removeDefine("ASPECT_AXIS_X"),S.removeDefine("ASPECT_AXIS_Y"),S.removeDefine("ASPECT_CROP"),h.setUiAttribs({greyout:!p.get()}),d.setUiAttribs({greyout:!p.get()}),f.setUiAttribs({greyout:!p.get()}),p.get()?(S.define("ASPECT_RATIO"),d.get()&&S.define("ASPECT_CROP"),"X"==f.get()&&S.define("ASPECT_AXIS_X"),"Y"==f.get()&&S.define("ASPECT_AXIS_Y")):(S.removeDefine("ASPECT_RATIO"),d.get()&&S.define("ASPECT_CROP"),"X"==f.get()&&S.define("ASPECT_AXIS_X"),"Y"==f.get()&&S.define("ASPECT_AXIS_Y"))}new CGL.Uniform(S,"f","aspectPos",h),p.onChange=d.onChange=f.onChange=b;const E=e.inValueBool("flip x"),A=e.inValueBool("flip y");let T=e.inValueBool("Transform"),y=e.inValueSlider("Scale X",1),L=e.inValueSlider("Scale Y",1),v=e.inValue("Position X",0),B=e.inValue("Position Y",0),w=e.inValue("Rotation",0);const P=e.inValueBool("Clip Repeat",!1);function N(){S.toggleDefine("TEX_TRANSFORM",T.get()),y.setUiAttribs({greyout:!T.get()}),L.setUiAttribs({greyout:!T.get()}),v.setUiAttribs({greyout:!T.get()}),B.setUiAttribs({greyout:!T.get()}),w.setUiAttribs({greyout:!T.get()})}function _(){S.toggleDefine("REMOVE_ALPHA_SRC",l.get()),S.toggleDefine("ALPHA_MASK",s.get()),S.toggleDefine("CLIP_REPEAT",P.get()),S.toggleDefine("HAS_TEXTUREALPHA",g.get()&&g.get().tex),S.toggleDefine("TEX_FLIP_X",E.get()),S.toggleDefine("TEX_FLIP_Y",A.get()),S.toggleDefine("INVERT_ALPHA",u.get()),S.toggleDefine("ALPHA_FROM_LUMINANCE","luminance"==c.get()),S.toggleDefine("ALPHA_FROM_INV_UMINANCE","luminance_inv"==c.get()),S.toggleDefine("PREMUL",a.get())}function M(){if(!CGL.TextureEffect.checkOpInEffect(e))return;const t=i.get();if(t&&t.tex&&o.get()>0){C.pushShader(S),C.currentTextureEffect.bind();const n=C.currentTextureEffect.getCurrentSourceTexture();C.setTexture(0,n.tex),n&&t&&(t.textureType!=n.textureType&&t.textureType==CGL.Texture.TYPE_FLOAT?e.setUiError("textypediff","Drawing 32bit texture into an 8 bit can result in data/precision loss",1):e.setUiError("textypediff",null));const r=1/(C.currentTextureEffect.getWidth()/C.currentTextureEffect.getHeight())*(t.width/t.height);x.setValue(r),C.setTexture(1,t.tex),g.get()&&g.get().tex&&C.setTexture(2,g.get().tex),C.pushBlendMode(CGL.BLEND_NONE,!0),C.currentTextureEffect.finish(),C.popBlendMode(),C.popShader()}m.trigger()}new CGL.Uniform(S,"f","scaleX",y),new CGL.Uniform(S,"f","scaleY",L),new CGL.Uniform(S,"f","posX",v),new CGL.Uniform(S,"f","posY",B),new CGL.Uniform(S,"f","rotate",w),T.onChange=N,CGL.TextureEffect.setupBlending(e,S,r,o),new CGL.Uniform(S,"f","amount",o),n.onTriggered=M,P.onChange=g.onChange=a.onChange=s.onChange=u.onChange=A.onChange=E.onChange=l.onChange=c.onChange=_,N(),O(),b(),_()},Ops.Gl.TextureEffects.DrawImage_v3.prototype=new CABLES.Op,CABLES.OPS["8f6b2f15-fcb0-4597-90c0-e5173f2969fe"]={f:Ops.Gl.TextureEffects.DrawImage_v3,objName:"Ops.Gl.TextureEffects.DrawImage_v3"},Ops.Gl.Meshes.FullscreenRectangle=function(){CABLES.Op.apply(this,arguments);const e=this,t={shader_frag:"UNI sampler2D tex;\nIN vec2 texCoord;\n\nvoid main()\n{\n    outColor= texture(tex,texCoord);\n}\n\n",shader_vert:"{{MODULES_HEAD}}\n\nIN vec3 vPosition;\nUNI mat4 projMatrix;\nUNI mat4 mvMatrix;\n\nOUT vec2 texCoord;\nIN vec2 attrTexCoord;\n\nvoid main()\n{\n   vec4 pos=vec4(vPosition,  1.0);\n\n   texCoord=vec2(attrTexCoord.x,(1.0-attrTexCoord.y));\n\n   gl_Position = projMatrix * mvMatrix * pos;\n}\n"},n=e.inTrigger("render"),r=e.inSwitch("Scale",["Stretch","Fit"],"Fit"),o=e.inValueBool("Flip Y"),i=e.inValueBool("Flip X"),a=e.inTexture("Texture"),s=e.outTrigger("trigger"),l=e.patch.cgl;let g=null,c=new CGL.Geometry("fullscreen rectangle"),u=0,p=0;e.toWorkShouldNotBeChild("Ops.Gl.TextureEffects.ImageCompose",CABLES.OP_PORT_TYPE_FUNCTION),e.toWorkPortsNeedToBeLinked(n),i.onChange=E,o.onChange=E,n.onTriggered=b,a.onLinkChanged=S,r.onChange=x;const f=new CGL.Shader(l,"fullscreenrectangle");f.setModules(["MODULE_VERTEX_POSITION","MODULE_COLOR","MODULE_BEGIN_FRAG"]),f.setSource(t.shader_vert,t.shader_frag),f.fullscreenRectUniform=new CGL.Uniform(f,"t","tex",0),f.aspectUni=new CGL.Uniform(f,"f","aspectTex",0);let h=!1,d=!0,m=!1,C=[];function S(){CABLES.UI&&(o.setUiAttribs({greyout:!a.isLinked()}),i.setUiAttribs({greyout:!a.isLinked()}),r.setUiAttribs({greyout:!a.isLinked()}))}function O(){let e=a.get();h=!!e}function x(){m="Fit"==r.get()}function b(){if(l.getViewPort()[2]==u&&l.getViewPort()[3]==p&&g||A(),d&&O(),l.pushPMatrix(),mat4.identity(l.pMatrix),mat4.ortho(l.pMatrix,0,u,p,0,-10,1e3),l.pushModelMatrix(),mat4.identity(l.mMatrix),l.pushViewMatrix(),mat4.identity(l.vMatrix),m&&a.get()){const e=a.get().width/a.get().height;let t=p,n=p*e;n>u&&(t=1*u/e,n=u),C[0]=l.getViewPort()[0],C[1]=l.getViewPort()[1],C[2]=l.getViewPort()[2],C[3]=l.getViewPort()[3],l.setViewPort((u-n)/2,(p-t)/2,n,t)}h?(a.get()&&l.setTexture(0,a.get().tex),g.render(f)):g.render(l.getShader()),l.gl.clear(l.gl.DEPTH_BUFFER_BIT),l.popPMatrix(),l.popModelMatrix(),l.popViewMatrix(),m&&a.get()&&l.setViewPort(C[0],C[1],C[2],C[3]),s.trigger()}function E(){g=null}function A(){const e=l.getViewPort();if(e[2]==u&&e[3]==p&&g)return;u=e[2],p=e[3],c.vertices=new Float32Array([0+u,0+p,0,0,0+p,0,0+u,0,0,0,0,0]);let t=null;t=o.get()?new Float32Array([1,0,0,0,1,1,0,1]):new Float32Array([1,1,0,1,1,0,0,0]),i.get()&&(t[0]=0,t[2]=1,t[4]=0,t[6]=1),c.setTexCoords(t),c.verticesIndices=new Uint16Array([2,1,0,3,1,2]),c.vertexNormals=new Float32Array([0,0,1,0,0,1,0,0,1,0,0,1]),c.tangents=new Float32Array([-1,0,0,-1,0,0,-1,0,0,-1,0,0]),c.biTangents,new Float32Array([0,-1,0,0,-1,0,0,-1,0,0,-1,0]),g?g.setGeom(c):g=new CGL.Mesh(l,c)}S(),x(),a.onChange=function(){d=!0},e.preRender=function(){O(),f.bind(),g&&g.render(f),b()}},Ops.Gl.Meshes.FullscreenRectangle.prototype=new CABLES.Op,CABLES.OPS["255bd15b-cc91-4a12-9b4e-53c710cbb282"]={f:Ops.Gl.Meshes.FullscreenRectangle,objName:"Ops.Gl.Meshes.FullscreenRectangle"},Ops.Vars.VarGetTexture_v2=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.outTexture("Value");e.varName=e.inValueSelect("Variable",[],"",!0),new CABLES.VarGetOpWrapper(e,"object",e.varName,t)},Ops.Vars.VarGetTexture_v2.prototype=new CABLES.Op,CABLES.OPS["5f8ce5fc-9787-45c9-9a83-0eebd2c6de15"]={f:Ops.Vars.VarGetTexture_v2,objName:"Ops.Vars.VarGetTexture_v2"},Ops.Gl.TextureEffects.ScrollTexture=function(){CABLES.Op.apply(this,arguments);const e=this,t={scroll_frag:"IN vec2 texCoord;\nUNI sampler2D tex;\nUNI float amountX;\nUNI float amountY;\n\n#ifdef HAS_MASK\n    UNI sampler2D texMask;\n#endif\n\nvoid main()\n{\n    float amX=amountX;\n    float amY=amountY;\n\n    #ifdef HAS_MASK\n        vec4 m=texture(texMask,texCoord);\n\n\n        amX*=(m.r-0.5)*2.0;\n        amY*=(m.g-0.5)*2.0;\n    #endif\n\n    vec4 col=vec4(0.0,0.0,0.0,1.0);\n    float x=mod(texCoord.x+amX,1.0);\n    float y=mod(texCoord.y+amY,1.0);\n\n\n    #ifdef NO_REPEAT\n        x=texCoord.x+amX*0.1;\n        y=texCoord.y+amY*0.1;\n    #endif\n\n    col=texture(tex,vec2(x,y));\n\n    #ifdef NO_REPEAT\n        if(x>1.0 || x<0.0 || y>1.0 || y<0.0) col=vec4(0.0,0.0,0.0,0.0);\n    #endif\n    outColor= col;\n}"},n=e.inTrigger("render"),r=e.outTrigger("trigger"),o=e.inValue("amountX"),i=e.inValue("amountY"),a=e.inTexture("Mask"),s=e.inValueBool("Repeat",!0);s.onChange=c;const l=e.patch.cgl,g=new CGL.Shader(l,e.name);function c(){s.get()?g.removeDefine("NO_REPEAT"):g.define("NO_REPEAT")}g.setSource(g.getDefaultVertexShader(),t.scroll_frag),new CGL.Uniform(g,"t","tex",0),new CGL.Uniform(g,"f","amountX",o),new CGL.Uniform(g,"f","amountY",i),new CGL.Uniform(g,"t","texMask",1),c(),a.onChange=function(){a.get()?g.define("MASK"):g.removeDefine("MASK")},n.onTriggered=function(){CGL.TextureEffect.checkOpInEffect(e)&&(l.pushShader(g),l.currentTextureEffect.bind(),l.setTexture(0,l.currentTextureEffect.getCurrentSourceTexture().tex),a.get()&&l.setTexture(1,a.get().tex),l.currentTextureEffect.finish(),l.popShader(),r.trigger())}},Ops.Gl.TextureEffects.ScrollTexture.prototype=new CABLES.Op,CABLES.OPS["9b151d99-7888-4948-81c7-cd23b334e8d4"]={f:Ops.Gl.TextureEffects.ScrollTexture,objName:"Ops.Gl.TextureEffects.ScrollTexture"},Ops.Math.Divide=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inValueFloat("number1",1),n=e.inValueFloat("number2",2),r=e.outNumber("result");function o(){r.set(t.get()/n.get())}e.setTitle("/"),t.onChange=n.onChange=o,o()},Ops.Math.Divide.prototype=new CABLES.Op,CABLES.OPS["86fcfd8c-038d-4b91-9820-a08114f6b7eb"]={f:Ops.Math.Divide,objName:"Ops.Math.Divide"},Ops.Math.Multiply=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inValueFloat("number1",1),n=e.inValueFloat("number2",2),r=e.outNumber("result");function o(){const e=t.get(),o=n.get();r.set(e*o)}e.setTitle("*"),t.onChange=n.onChange=o,o()},Ops.Math.Multiply.prototype=new CABLES.Op,CABLES.OPS["1bbdae06-fbb2-489b-9bcc-36c9d65bd441"]={f:Ops.Math.Multiply,objName:"Ops.Math.Multiply"},Ops.Anim.Smooth=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inTrigger("Update"),n=e.inBool("Separate inc/dec",!1),r=e.inValue("Value"),o=e.outTrigger("Next"),i=e.inValue("Inc factor",4),a=e.inValue("Dec factor",4),s=e.outNumber("Result",0);let l,g,c=0,u=0,p=0,f=0;e.toWorkPortsNeedToBeLinked(t);let h=4,d=!0,m=0;const C=0,S=1;function O(){const e=n.get();m=e?S:C,m==C?(a.setUiAttribs({greyout:!0}),i.setUiAttribs({title:"Inc/Dec factor"})):m==S&&(a.setUiAttribs({greyout:!1}),i.setUiAttribs({title:"Inc factor"})),x(),b()}function x(){m==C?(l=i.get(),g=i.get()):m==S&&(l=i.get(),g=a.get()),(l<=.2||l!=l)&&(l=.2),(g<=.2||g!=g)&&(g=.2)}function b(){let e=1;performance.now()-f>500||0===f?c=r.get()||0:e=(performance.now()-f)/(performance.now()-f),f=performance.now(),c!=c&&(c=0),h<=0&&(h=1e-4);const t=u-c;c+=t>=0?t/(g*e):t/(l*e),Math.abs(t)<1e-5&&(c=u),h!=h&&(c=0),c==c&&c!=-1/0&&c!=1/0||(c=r.get()),p!=c&&(s.set(c),p=c),c!=u||d||(d=!0,s.set(c)),o.trigger()}O(),x(),n.setUiAttribs({hidePort:!0}),i.onChange=a.onChange=x,n.onChange=O,b(),r.onChange=function(){d=!1,u=r.get()},i.onChange=function(){x()},t.onTriggered=function(){b()}},Ops.Anim.Smooth.prototype=new CABLES.Op,CABLES.OPS["5677b5b5-753a-4fbf-9e91-64c81ec68a2f"]={f:Ops.Anim.Smooth,objName:"Ops.Anim.Smooth"},Ops.Math.Round=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inValueFloat("number"),n=e.inInt("Decimal Places",0),r=e.outNumber("result");let o=0;function i(){o=Math.pow(10,n.get()),a()}function a(){r.set(Math.round(t.get()*o)/o)}t.onChange=a,n.onChange=i,i()},Ops.Math.Round.prototype=new CABLES.Op,CABLES.OPS["1a1ef636-6d02-42ba-ae1e-627b917d0d2b"]={f:Ops.Math.Round,objName:"Ops.Math.Round"},Ops.Value.Number=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inValueFloat("value"),n=e.outNumber("result");function r(){n.set(Number(t.get()))}t.onChange=r},Ops.Value.Number.prototype=new CABLES.Op,CABLES.OPS["8fb2bb5d-665a-4d0a-8079-12710ae453be"]={f:Ops.Value.Number,objName:"Ops.Value.Number"},Ops.Value.SwitchNumber=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inValueInt("Index"),n=[],r=e.outNumber("Result");t.onChange=o;for(let t=0;t<16;t++){let r=e.inValue("Value "+t);n.push(r),r.onChange=o}function o(){t.get()>=0&&n[t.get()]&&r.set(n[t.get()].get())}},Ops.Value.SwitchNumber.prototype=new CABLES.Op,CABLES.OPS["fbb89f72-f2e3-4d34-ad01-7d884a1bcdc0"]={f:Ops.Value.SwitchNumber,objName:"Ops.Value.SwitchNumber"},Ops.Array.Array_v3=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inValueInt("Array length",10),n=e.inSwitch("Mode select",["Number","1,2,3,4","0-1"],"Number"),r=e.inValueFloat("Default Value"),o=e.inBool("Reverse",!1),i=e.outArray("Array"),a=e.outNumber("Array length out");let s=[],l=0;const g=0,c=1,u=2;function p(){let t=n.get();"Number"===t?l=g:"1,2,3,4"===t?l=c:"0-1"===t&&(l=u),r.setUiAttribs({greyout:l!==g}),e.setUiAttrib({extendTitle:n.get()}),f()}function f(){s.length=0;let e,n=t.get(),p=r.get();if(l===g)for(e=0;e<n;e++)s[e]=p;else if(l===c)for(e=0;e<n;e++)s[e]=e;else if(l===u)for(e=0;e<n;e++)s[e]=e/(n-1);o.get()&&(s=s.reverse()),i.setRef(s),a.set(s.length)}n.onChange=p,o.onChange=r.onChange=t.onChange=f,p(),f()},Ops.Array.Array_v3.prototype=new CABLES.Op,CABLES.OPS["e4d31a46-bf64-42a8-be34-4cbb2bbc2600"]={f:Ops.Array.Array_v3,objName:"Ops.Array.Array_v3"},Ops.Array.ArrayMultiply=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inArray("In"),n=e.inValue("Value",1),r=e.outArray("Result");let o=[];r.set(o),t.onChange=n.onChange=t.onChange=function(){let e=t.get();if(!e)return;let i=n.get();o.length!=e.length&&(o.length=e.length);for(let t=0;t<e.length;t++)o[t]=e[t]*i;r.setRef(o)},t.onLinkChanged=()=>{t&&t.copyLinkedUiAttrib("stride",r)}},Ops.Array.ArrayMultiply.prototype=new CABLES.Op,CABLES.OPS["a01c344b-4129-4b01-9c8f-36cefe86d7cc"]={f:Ops.Array.ArrayMultiply,objName:"Ops.Array.ArrayMultiply"},Ops.Ui.VizNumber=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inFloat("Number",0),n=e.outNumber("Result");e.setUiAttrib({widthOnlyGrow:!0}),t.onChange=()=>{let r=t.get();if(e.patch.isEditorMode()){let t="";null===r?t="null":void 0===r?t="undefined":(t=""+Math.round(1e4*r)/1e4,"-"!=t[0]&&(t=" "+t)),e.setUiAttribs({extendTitle:t})}n.set(r)}},Ops.Ui.VizNumber.prototype=new CABLES.Op,CABLES.OPS["2b60d12d-2884-4ad0-bda4-0caeb6882f5c"]={f:Ops.Ui.VizNumber,objName:"Ops.Ui.VizNumber"},Ops.Math.MapRange=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inValueFloat("value",0),n=e.inValueFloat("old min",0),r=e.inValueFloat("old max",1),o=e.inValueFloat("new min",-1),i=e.inValueFloat("new max",1),a=e.inValueSelect("Easing",["Linear","Smoothstep","Smootherstep"],"Linear"),s=e.outNumber("result",0);e.setPortGroup("Input Range",[n,r]),e.setPortGroup("Output Range",[o,i]);let l=0,g=0;function c(){const e=o.get(),a=i.get(),c=n.get(),u=r.get();let p=t.get();if(p>=Math.max(u,c))return void s.set(a);if(p<=Math.min(u,c))return void s.set(e);let f=!1;const h=Math.min(c,u),d=Math.max(c,u);h!=c&&(f=!0);let m=!1;const C=Math.min(e,a),S=Math.max(e,a);C!=e&&(m=!0);let O=0;O=f?(d-p)*(S-C)/(d-h):(p-h)*(S-C)/(d-h),g=m?S-O:O+C,0===l?s.set(g):1==l?(p=Math.max(0,Math.min(1,(g-e)/(a-e))),s.set(e+p*p*(3-2*p)*(a-e))):2==l&&(p=Math.max(0,Math.min(1,(g-e)/(a-e))),s.set(e+p*p*p*(p*(6*p-15)+10)*(a-e)))}t.onChange=n.onChange=r.onChange=o.onChange=i.onChange=c,c(),a.onChange=function(){l="Smoothstep"==a.get()?1:"Smootherstep"==a.get()?2:0}},Ops.Math.MapRange.prototype=new CABLES.Op,CABLES.OPS["2617b407-60a0-4ff6-b4a7-18136cfa7817"]={f:Ops.Math.MapRange,objName:"Ops.Math.MapRange"},Ops.Vars.VarGetNumber_v2=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.outNumber("Value");e.varName=e.inValueSelect("Variable",[],"",!0),new CABLES.VarGetOpWrapper(e,"number",e.varName,t)},Ops.Vars.VarGetNumber_v2.prototype=new CABLES.Op,CABLES.OPS["421f5b52-c0fa-47c4-8b7a-012b9e1c864a"]={f:Ops.Vars.VarGetNumber_v2,objName:"Ops.Vars.VarGetNumber_v2"},Ops.Gl.TextureEffects.RepeatTexture_v2=function(){CABLES.Op.apply(this,arguments);const e=this,t={repeat_frag:"IN vec2 texCoord;\nUNI sampler2D tex;\nUNI sampler2D mulTex;\nUNI float amount;\nUNI float amountX;\nUNI float amountY;\n\n{{CGL.BLENDMODES3}}\n\nvoid main()\n{\n    float am=amount;\n\n    float mul=1.0;\n\n    #ifdef HAS_MASK\n        mul=texture(mulTex,texCoord).r;\n    #endif\n\n    vec2 coord = vec2(\n        mod(texCoord.x*amountX*mul,1.0),\n        mod(texCoord.y*amountY*mul,1.0));\n\n    vec4 col=texture(tex,coord);\n    vec4 base=texture(tex,texCoord);\n\n\n    #ifdef CLEAR\n        base.a=0.0;\n    #endif\n\n    outColor=cgl_blendPixel(base,col,am);\n}"},n=e.inTrigger("render"),r=CGL.TextureEffect.AddBlendSelect(e,"Blend Mode","normal"),o=e.inValueSlider("Amount",1),i=e.inValue("x",3),a=e.inValue("y",3),s=e.outTrigger("trigger"),l=e.inBool("Clear",!0),g=e.inTexture("Multiply"),c=e.patch.cgl,u=new CGL.Shader(c,e.name);function p(){u.toggleDefine("CLEAR",l.get()),u.toggleDefine("HAS_MASK",g.get())}u.setSource(u.getDefaultVertexShader(),t.repeat_frag),new CGL.Uniform(u,"t","tex",0),new CGL.Uniform(u,"t","mulTex",2),new CGL.Uniform(u,"f","amount",o),new CGL.Uniform(u,"f","amountX",i),new CGL.Uniform(u,"f","amountY",a),CGL.TextureEffect.setupBlending(e,u,r,o),l.onChange=g.onChange=p,n.onTriggered=function(){CGL.TextureEffect.checkOpInEffect(e,3)&&(c.pushShader(u),c.currentTextureEffect.bind(),c.setTexture(0,c.currentTextureEffect.getCurrentSourceTexture().tex),g.get()&&c.setTexture(2,g.get().tex),c.currentTextureEffect.finish(),c.popShader(),s.trigger())}},Ops.Gl.TextureEffects.RepeatTexture_v2.prototype=new CABLES.Op,CABLES.OPS["ff9aa796-d781-444c-a9d4-a62157f82dd5"]={f:Ops.Gl.TextureEffects.RepeatTexture_v2,objName:"Ops.Gl.TextureEffects.RepeatTexture_v2"},Ops.Gl.Shader.CustomShader_v2=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inTrigger("render"),n=e.inStringEditor("Fragment Code"),r=e.inStringEditor("Vertex Code"),o=e.inValueBool("Use As Material",!0),i=e.outTrigger("trigger"),a=e.outObject("Shader",null,"shader"),s=e.outBool("Has Errors"),l=e.patch.cgl,g=[],c=[],u=[];e.toWorkPortsNeedToBeLinked(t),n.setUiAttribs({editorSyntax:"glsl"}),r.setUiAttribs({editorSyntax:"glsl"});const p=new CGL.Shader(l,e.name);p.setModules(["MODULE_VERTEX_POSITION","MODULE_COLOR","MODULE_BEGIN_FRAG"]),e.setPortGroup("Source Code",[n,r]),e.setPortGroup("Options",[o]),n.set(CGL.Shader.getDefaultFragmentShader()),r.set(CGL.Shader.getDefaultVertexShader()),n.onChange=r.onChange=function(){n.isLinked()&&!n.get()||(f=!0)},t.onTriggered=d;let f=!0;function h(e){A();for(let t=0;t<g.length;t++)for(let n=0;n<e.portsIn.length;n++)g[t]&&g[t].name==e.portsIn[n].name&&(g[t].set(e.portsIn[n].value),g[t].deSerializeSettings(e.portsIn[n]))}function d(){y(),f&&A(),o.get()&&l.pushShader(p),m(),i.trigger(),p.popTextures(),o.get()&&l.popShader()}function m(){for(let e=0;e<c.length;e++)c[e]&&c[e].get()&&c[e].get().tex?p.pushTexture(c[e].uniform,c[e].get().tex):p.pushTexture(c[e],CGL.Texture.getEmptyTexture(l))}function C(){for(let e=0;e<c.length;e++)c[e]&&c[e].get()&&c[e].get().tex&&l.setTexture(0+e+3,c[e].get().tex)}function S(e){for(let t=0;t<g.length;t++)if(g[t]&&g[t].name==e)return!0;for(let t=0;t<c.length;t++)if(c[t]&&c[t].name==e)return!0;return!1}e.onLoadedValueSet=h,e.init=function(){A()},mat4.create();const O=["modelMatrix","viewMatrix","normalMatrix","mvMatrix","projMatrix","inverseViewMatrix","camPos"];let x=0;const b=[];function E(t){const n=t.split("\n"),r=[];for(let t=0;t<n.length;t++){const o=n[t].split(";");for(let t=0;t<o.length;t++){let n=o[t].split(" ");for(let e=0;e<n.length;e++)n[e]=(n[e]+"").trim();if("UNI"===n[0]||"uniform"===n[0]){let t=n[2];if(n.length>4)for(let e=3;e<n.length;e++)t+=n[e];n=n.filter((function(e){return""!==e}));const o=n[1];let i=[t];t.indexOf(",")>-1&&(i=t.split(","));for(let t=0;t<i.length;t++){if(O.indexOf(i[t])>-1)continue;const n=i[t].trim().replace(/\[\d+\]$/,"");if("float"===o){if(b.push(n),!S(n)){const o=i[t].trim().match(/\[\d+\]$/);if(o){const t=parseInt(o[0].trim().slice(1,-1)),i=e.inArray(n,[]);i.uniform=new CGL.Uniform(p,"f[]",n,new Float32Array(t)),g.push(i),r.push(i);const a={name:n,num:t,port:i,uni:i.uniform,changed:!1};i.onChange=function(){this.changed=!0}.bind(a),u.push(a)}else{const t=e.inFloat(n,0);t.uniform=new CGL.Uniform(p,"f",n,t),g.push(t),r.push(t)}}}else if("int"===o){if(b.push(n),!S(n)){const t=e.inInt(n,0);t.uniform=new CGL.Uniform(p,"i",n,t),g.push(t),r.push(t)}}else if("bool"===o){if(b.push(n),!S(n)){const t=e.inBool(n,!1);t.uniform=new CGL.Uniform(p,"b",n,t),g.push(t),r.push(t)}}else if("mat4"===o){if(b.push(n),!S(n)){const t=e.inArray(n,0);t.uniform=new CGL.Uniform(p,"m4",n,t),g.push(t),r.push(t);const o={name:n,num:16,port:t,uni:t.uniform,changed:!1};t.onChange=function(){this.changed=!0}.bind(o),u.push(o)}}else if("sampler2D"===o||"samplerCube"===o){if(b.push(n),!S(n)){const t=e.inObject(n);let i="t";"samplerCube"===o&&(i="tc"),t.uniform=new CGL.Uniform(p,i,n,3+c.length),c.push(t),r.push(t),t.set(CGL.Texture.getTempTexture(l)),t.on("change",((e,t)=>{e||t.set(CGL.Texture.getTempTexture(l))})),x++}}else if("vec3"===o||"vec2"===o||"vec4"===o){let t=2;if("vec4"===o&&(t=4),"vec3"===o&&(t=3),b.push(n+" X"),b.push(n+" Y"),t>2&&b.push(n+" Z"),t>3&&b.push(n+" W"),!S(n+" X")){const r=[],o={name:n,num:t,changed:!1};u.push(o),T(o);const i=e.inFloat(n+" X",0);i.onChange=function(){this.changed=!0}.bind(o),g.push(i),r.push(i),o.x=i;const a=e.inFloat(n+" Y",0);if(a.onChange=function(){this.changed=!0}.bind(o),g.push(a),r.push(a),o.y=a,t>2){const t=e.inFloat(n+" Z",0);t.onChange=function(){this.changed=!0}.bind(o),g.push(t),r.push(t),o.z=t}if(t>3){const t=e.inFloat(n+" W",0);t.onChange=function(){this.changed=!0}.bind(o),g.push(t),r.push(t),o.w=t}e.setPortGroup(n,r)}}}}}}e.setPortGroup("uniforms",r)}function A(){if(p){p.bindTextures=C.bind(this),p.setSource(r.get(),n.get()),1==l.glVersion&&(l.enableExtension("OES_standard_derivatives"),p.enableExtension("GL_OES_standard_derivatives")),x=0,b.length=0,E(r.get()),E(n.get());for(let e=0;e<c.length;e++)for(let t=0;t<b.length;t++)c[e]&&-1==b.indexOf(c[e].name)&&(c[e].remove(),c[e]=null);for(let e=0;e<g.length;e++)for(let t=0;t<b.length;t++)g[e]&&-1==b.indexOf(g[e].name)&&(g[e].remove(),g[e]=null);for(let e=0;e<u.length;e++)T(u[e]),u[e].changed=!0;for(let e=0;e<g.length;e++)g[e]&&g[e].uniform&&(g[e].uniform.needsUpdate=!0);p.compile(),e.refreshParams(),a.set(null),a.set(p),f=!1,p.hasErrors()?e.setUiError("compile","Shader has errors"):e.setUiError("compile",null),s.set(p.hasErrors())}}function T(e){2==e.num?e.uni=new CGL.Uniform(p,"2f",e.name,[0,0]):3==e.num?e.uni=new CGL.Uniform(p,"3f",e.name,[0,0,0]):4==e.num&&(e.uni=new CGL.Uniform(p,"4f",e.name,[0,0,0,0]))}function y(){for(let e=0;e<u.length;e++){const t=u[e];t.changed&&(2===t.num?t.uni.setValue([t.x.get(),t.y.get()]):3===t.num?t.uni.setValue([t.x.get(),t.y.get(),t.z.get()]):4===t.num?t.uni.setValue([t.x.get(),t.y.get(),t.z.get(),t.w.get()]):t.num>4&&t.uni.setValue(t.port.get()),t.changed=!1)}}},Ops.Gl.Shader.CustomShader_v2.prototype=new CABLES.Op,CABLES.OPS["a165fc89-a35b-4d39-8930-7345b098bd9d"]={f:Ops.Gl.Shader.CustomShader_v2,objName:"Ops.Gl.Shader.CustomShader_v2"},Ops.Gl.Shader.ShaderToTexture=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inTrigger("Render"),n=e.inObject("Shader",null,"shader"),r=e.inValueBool("Use Viewport Size",!0),o=e.inValueInt("Width",512),i=e.inValueInt("Height",512),a=e.inValueSelect("filter",["nearest","linear","mipmap"]),s=e.inValueSelect("wrap",["clamp to edge","repeat","mirrored repeat"],"clamp to edge"),l=e.inValueBool("Floating Point",!1),g=e.inSwitch("Num Textures",["1","4"],"1"),c=e.outTrigger("Next"),u=e.outTexture("Texture"),p=e.outTexture("Texture 2"),f=e.outTexture("Texture 3"),h=e.outTexture("Texture 4");e.setPortGroup("Texture Size",[r,o,i]),e.setPortGroup("Texture settings",[a,s,l]);let d=1;const m=e.patch.cgl,C=[0,0,0,0],S=[];let O=null,x=null;o.onChange=i.onChange=l.onChange=a.onChange=g.onChange=s.onChange=L,r.onChange=y;let b=null,E=!0;const A=CGL.MESHES.getSimpleRect(m,"shader2texture rect");function T(){"mipmap"==a.get()&&l.get()?e.setUiError("warning","HDR and mipmap filtering at the same time is not possible"):e.setUiError("warning",null)}function y(){o.setUiAttribs({greyout:r.get()}),i.setUiAttribs({greyout:r.get()}),o.set(m.getViewPort()[2]),i.set(m.getViewPort()[3])}function L(){E=!0,T()}function v(){x&&x.dispose(),O=null,x=null}function B(){E=!1,b&&b.delete();const e=S.length;d=parseInt(g.get()),S.length=0;for(let e=0;e<d;e++)S[e]=!0;e!=S.length&&v(),b=null;let t=o.get(),n=i.get();r.get()&&(t=m.getViewPort()[2],n=m.getViewPort()[3]);let c=CGL.Texture.FILTER_NEAREST;"linear"==a.get()?c=CGL.Texture.FILTER_LINEAR:"mipmap"==a.get()&&(c=CGL.Texture.FILTER_MIPMAP);let u=CGL.Texture.WRAP_CLAMP_TO_EDGE;"repeat"==s.get()&&(u=CGL.Texture.WRAP_REPEAT),"mirrored repeat"==s.get()&&(u=CGL.Texture.WRAP_MIRRORED_REPEAT),b=m.glVersion>=2?new CGL.Framebuffer2(m,t,n,{isFloatingPointTexture:l.get(),multisampling:!1,numRenderBuffers:d,wrap:u,filter:c,depth:!0,multisamplingSamples:0,clear:!0}):new CGL.Framebuffer(m,o.get(),i.get(),{isFloatingPointTexture:l.get(),filter:c,wrap:u})}e.toWorkPortsNeedToBeLinked(n),a.set("nearest"),y(),t.onTriggered=function(){const e=m.getViewPort();b&&!E||B(),r.get()&&b&&(e[2]!=b.getTextureColor().width||e[3]!=b.getTextureColor().height)&&B(),n.get()&&n.get().setDrawBuffers&&(n.get()!=O&&(O=n.get(),x=n.get().copy(),x.setDrawBuffers(S)),x?(C[0]=e[0],C[1]=e[1],C[2]=e[2],C[3]=e[3],b.renderStart(m),m.pushPMatrix(),mat4.identity(m.pMatrix),m.pushViewMatrix(),mat4.identity(m.vMatrix),m.pushModelMatrix(),mat4.identity(m.mMatrix),m.pushShader(n.get()),x.bindTextures&&x.bindTextures(),m.pushBlend(!1),A.render(n.get()),m.popBlend(),m.popPMatrix(),m.popModelMatrix(),m.popViewMatrix(),b.renderEnd(m),d>=2?(u.set(b.getTextureColorNum(0)),p.set(b.getTextureColorNum(1)),f.set(b.getTextureColorNum(2)),h.set(b.getTextureColorNum(3))):u.set(b.getTextureColor()),m.popShader(),m.gl.viewport(C[0],C[1],C[2],C[3]),c.trigger()):u.set(null))}},Ops.Gl.Shader.ShaderToTexture.prototype=new CABLES.Op,CABLES.OPS["a3debb76-7d84-4548-9e7b-24891423dcce"]={f:Ops.Gl.Shader.ShaderToTexture,objName:"Ops.Gl.Shader.ShaderToTexture"},Ops.Ui.VizTexture=function(){CABLES.Op.apply(this,arguments);const e=this,t={viztex_frag:"IN vec2 texCoord;\nUNI sampler2D tex;\nUNI samplerCube cubeMap;\nUNI float width;\nUNI float height;\nUNI float type;\nUNI float time;\n\nfloat LinearizeDepth(float d,float zNear,float zFar)\n{\n    float z_n = 2.0 * d - 1.0;\n    return 2.0 * zNear / (zFar + zNear - z_n * (zFar - zNear));\n}\n\nvoid main()\n{\n    vec4 col=vec4(vec3(0.),0.0);\n\n    vec4 colTex=texture(tex,texCoord);\n\n\n\n    if(type==1.0)\n    {\n        vec4 depth=vec4(0.);\n        vec2 localST=texCoord;\n        localST.y = 1. - localST.y;\n\n        localST.t = mod(localST.t*3.,1.);\n        localST.s = mod(localST.s*4.,1.);\n\n        #ifdef WEBGL2\n            #define texCube texture\n        #endif\n        #ifdef WEBGL1\n            #define texCube textureCube\n        #endif\n\n//         //Due to the way my depth-cubeMap is rendered, objects to the -x,y,z side is projected to the positive x,y,z side\n//         //Inside where top/bottom is to be drawn?\n        if (texCoord.s*4.> 1. && texCoord.s*4.<2.)\n        {\n            //Bottom (-y) quad\n            if (texCoord.t*3. < 1.)\n            {\n                vec3 dir=vec3(localST.s*2.-1.,-1.,-localST.t*2.+1.);//Due to the (arbitrary) way I choose as up in my depth-viewmatrix, i her emultiply the latter coordinate with -1\n                depth = texCube(cubeMap, dir);\n            }\n            //top (+y) quad\n            else if (texCoord.t*3. > 2.)\n            {\n                vec3 dir=vec3(localST.s*2.-1.,1.,localST.t*2.-1.);//Get lower y texture, which is projected to the +y part of my cubeMap\n                depth = texCube(cubeMap, dir);\n            }\n            else//Front (-z) quad\n            {\n                vec3 dir=vec3(localST.s*2.-1.,-localST.t*2.+1.,1.);\n                depth = texCube(cubeMap, dir);\n            }\n        }\n//         //If not, only these ranges should be drawn\n        else if (texCoord.t*3. > 1. && texCoord.t*3. < 2.)\n        {\n            if (texCoord.x*4. < 1.)//left (-x) quad\n            {\n                vec3 dir=vec3(-1.,-localST.t*2.+1.,localST.s*2.-1.);\n                depth = texCube(cubeMap, dir);\n            }\n            else if (texCoord.x*4. < 3.)//right (+x) quad (front was done above)\n            {\n                vec3 dir=vec3(1,-localST.t*2.+1.,-localST.s*2.+1.);\n                depth = texCube(cubeMap, dir);\n            }\n            else //back (+z) quad\n            {\n                vec3 dir=vec3(-localST.s*2.+1.,-localST.t*2.+1.,-1.);\n                depth = texCube(cubeMap, dir);\n            }\n        }\n        // colTex = vec4(vec3(depth),1.);\n        colTex = vec4(depth);\n    }\n\n    if(type==2.0)\n    {\n       float near = 0.1;\n       float far = 50.;\n       float depth = LinearizeDepth(colTex.r, near, far);\n       colTex.rgb = vec3(depth);\n    }\n\n\n    #ifdef ANIM_RANGE\n\n        if(colTex.r>1.0 || colTex.r<0.0)\n            colTex.r=mod(colTex.r,1.0)*0.5+(sin(colTex.r+mod(colTex.r*3.0,1.0)+time*5.0)*0.5+0.5)*0.5;\n        if(colTex.g>1.0 || colTex.g<0.0)\n            colTex.g=mod(colTex.g,1.0)*0.5+(sin(colTex.g+mod(colTex.g*3.0,1.0)+time*5.0)*0.5+0.5)*0.5;\n        if(colTex.b>1.0 || colTex.b<0.0)\n            colTex.b=mod(colTex.b,1.0)*0.5+(sin(colTex.b+mod(colTex.b*3.0,1.0)+time*5.0)*0.5+0.5)*0.5;\n\n    #endif\n\n\n    // #ifdef ANIM_RANGE\n    //     if(colTex.r>1.0 || colTex.r<0.0)\n    //     {\n    //         float r=mod( time+colTex.r,1.0)*0.5+0.5;\n    //         colTex.r=r;\n    //     }\n    //     if(colTex.g>1.0 || colTex.g<0.0)\n    //     {\n    //         float r=mod( time+colTex.g,1.0)*0.5+0.5;\n    //         colTex.g=r;\n    //     }\n    //     if(colTex.b>1.0 || colTex.b<0.0)\n    //     {\n    //         float r=mod( time+colTex.b,1.0)*0.5+0.5;\n    //         colTex.b=r;\n    //     }\n    // #endif\n\n    outColor = mix(col,colTex,colTex.a);\n}\n\n",viztex_vert:"IN vec3 vPosition;\nIN vec2 attrTexCoord;\nOUT vec2 texCoord;\nUNI mat4 projMatrix;\nUNI mat4 modelMatrix;\nUNI mat4 viewMatrix;\n\nvoid main()\n{\n    texCoord=vec2(attrTexCoord.x,1.0-attrTexCoord.y);\n    vec4 pos = vec4( vPosition, 1. );\n    mat4 mvMatrix=viewMatrix * modelMatrix;\n    gl_Position = projMatrix * mvMatrix * pos;\n}"},n=e.inTexture("Texture In"),r=e.inBool("Show Info",!1),o=e.inSwitch("Visualize outside 0-1",["Off","Anim"],"Anim"),i=e.inBool("Show Color",!1),a=e.inFloatSlider("X",.5),s=e.inFloatSlider("Y",.5),l=e.outTexture("Texture Out"),g=e.outString("Info");e.setUiAttrib({height:150,resizable:!0});const c=new CABLES.Timer;c.play();let u=null,p=null,f=null,h="";function d(){a.setUiAttribs({greyout:!i.get()}),s.setUiAttribs({greyout:!i.get()})}function m(){u&&u.toggleDefine("ANIM_RANGE","Anim"==o.get())}o.onChange=m,i.onChange=d,d(),n.onChange=()=>{const t=n.get();l.setRef(t);let r="";n.get()&&n.links[0]&&(r=n.links[0].getOtherPort(n).name),e.setUiAttrib({extendTitle:r})},e.renderVizLayer=(e,o)=>{const l=n,d=CABLES.UI.uiProfiler.start("previewlayer texture"),C=l.op.patch.cgl;if(!o.useGl)return;this._emptyCubemap||(this._emptyCubemap=CGL.Texture.getEmptyCubemapTexture(C)),l.op.patch.cgl.profileData.profileTexPreviews++;const S=l.get()||CGL.Texture.getEmptyTexture(C);if(!this._mesh){const e=new CGL.Geometry("vizTexture rect");e.vertices=[1,1,0,-1,1,0,1,-1,0,-1,-1,0],e.texCoords=[1,1,0,1,1,0,0,0],e.verticesIndices=[0,1,2,3,1,2],this._mesh=new CGL.Mesh(C,e)}this._shader||(this._shader=new CGL.Shader(C,"glpreviewtex"),this._shader.setModules(["MODULE_VERTEX_POSITION","MODULE_COLOR","MODULE_BEGIN_FRAG"]),this._shader.setSource(t.viztex_vert,t.viztex_frag),this._shaderTexUniform=new CGL.Uniform(this._shader,"t","tex",5),this._shaderTexCubemapUniform=new CGL.Uniform(this._shader,"tc","cubeMap",6),u=this._shader,m(),this._shaderTexUniformW=new CGL.Uniform(this._shader,"f","width",S.width),this._shaderTexUniformH=new CGL.Uniform(this._shader,"f","height",S.height),this._shaderTypeUniform=new CGL.Uniform(this._shader,"f","type",0),this._shaderTimeUniform=new CGL.Uniform(this._shader,"f","time",0)),C.pushPMatrix();const O=[S.width,S.height],x=l.op.patch.cgl.canvasWidth>O[0]&&l.op.patch.cgl.canvasHeight>O[1];x?mat4.ortho(C.pMatrix,0,l.op.patch.cgl.canvasWidth,l.op.patch.cgl.canvasHeight,0,.001,11):mat4.ortho(C.pMatrix,-1,1,1,-1,.001,11);const b=C.getTexture(5),E=C.getTexture(6);let A=0;if(!S)return;S.cubemap&&(A=1),S.textureType==CGL.Texture.TYPE_DEPTH&&(A=2),0==A||2==A?(C.setTexture(5,S.tex),C.setTexture(6,this._emptyCubemap.cubemap,C.gl.TEXTURE_CUBE_MAP)):1==A&&C.setTexture(6,S.cubemap,C.gl.TEXTURE_CUBE_MAP),c.update(),this._shaderTimeUniform.setValue(c.get()),this._shaderTypeUniform.setValue(A);let T=[l.op.patch.cgl.canvasWidth,l.op.patch.cgl.canvasHeight];C.gl.clearColor(0,0,0,0),C.gl.clear(C.gl.COLOR_BUFFER_BIT|C.gl.DEPTH_BUFFER_BIT),C.pushModelMatrix(),x&&(T=O,mat4.translate(C.mMatrix,C.mMatrix,[O[0]/2,O[1]/2,0]),mat4.scale(C.mMatrix,C.mMatrix,[O[0]/2,O[1]/2,0])),this._mesh.render(this._shader),C.popModelMatrix(),0==A&&C.setTexture(5,b),1==A&&C.setTexture(6,E),C.popPMatrix(),C.resetViewPort();const y=[o.width,o.height];if(S.width>S.height)y[1]=o.width*O[1]/O[0];else if(y[1]=o.width*(O[1]/O[0]),y[1]>o.height){const e=o.height/y[1];y[0]*=e,y[1]*=e}const L=y[0]>O[0]&&y[1]>O[1];e.imageSmoothingEnabled=!x||!L,e.imageSmoothingEnabled||(e.fillStyle="#ffffff",e.fillRect(o.x,o.y-10,10,10),e.fillStyle="#000000",e.fillRect(o.x,o.y-10,5,5),e.fillRect(o.x+5,o.y-10+5,5,5));let v=10*o.width/o.height,B=o.height/10,w=o.width/v;for(let t=0;t<v;t++)for(let n=0;n<10;n++)e.fillStyle=(t+n)%2==0?"#333333":"#393939",e.fillRect(o.x+w*t,o.y+B*n,w,B);e.fillStyle="#222";const P=(o.width-y[0])/2,N=(o.height-y[1])/2;e.fillRect(o.x,o.y,P,o.height),e.fillRect(o.x+y[0]+P,o.y,P,o.height),e.fillRect(o.x,o.y,o.width,N),e.fillRect(o.x,o.y+y[1]+N,o.width,N),1==O[1]&&e.drawImage(C.canvas,0,0,T[0],T[1],o.x,o.y,o.width,5*o.height),1==O[0]?e.drawImage(C.canvas,0,0,T[0],T[1],o.x,o.y,5*o.width,o.height):e.drawImage(C.canvas,0,0,T[0],T[1],o.x+(o.width-y[0])/2,o.y+(o.height-y[1])/2,y[0],y[1]);let _="unknown";if(l.get()&&l.get().getInfoOneLine&&(_=l.get().getInfoOneLine()),r.get()&&(e.save(),e.scale(o.scale,o.scale),e.font="normal 10px sourceCodePro",e.fillStyle="#000",e.fillText(_,o.x/o.scale+5+.5,(o.y+o.height)/o.scale-5+.5),e.fillStyle="#fff",e.fillText(_,o.x/o.scale+5,(o.y+o.height)/o.scale-5),e.restore()),i.get()&&(e.save(),e.scale(o.scale,o.scale),e.font="normal 10px sourceCodePro",e.fillStyle="#000",e.fillText("RGBA "+h,o.x/o.scale+10+.5,o.y/o.scale+10+.5),e.fillStyle="#fff",e.fillText("RGBA "+h,o.x/o.scale+10,o.y/o.scale+10),e.restore(),e.fillStyle="#000",e.fillRect(o.x+o.width*a.get()-1,o.y+y[1]*s.get()-10+N,3,20),e.fillRect(o.x+o.width*a.get()-10,o.y+y[1]*s.get()-1+N,20,3),e.fillStyle="#fff",e.fillRect(o.x+o.width*a.get()-1,o.y+y[1]*s.get()-10+N,1,20),e.fillRect(o.x+o.width*a.get()-10,o.y+y[1]*s.get()-1+N,20,1)),g.set(_),i.get()){const e=C.gl,t=n.get();if(!t)return void(h="");p||(p=e.createFramebuffer()),f||(f=new CGL.PixelReader),e.bindFramebuffer(e.FRAMEBUFFER,p),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t.tex,0),e.bindFramebuffer(e.FRAMEBUFFER,null),f.read(C,p,t.textureType,a.get()*t.width,t.height-s.get()*t.height,1,1,(e=>{h=t.textureType!=CGL.Texture.TYPE_FLOAT?Math.floor(e[0]/255*100)/100+","+Math.floor(e[1]/255*100)/100+","+Math.floor(e[2]/255*100)/100+","+Math.floor(e[3]/255*100)/100:Math.round(100*e[0])/100+","+Math.round(100*e[1])/100+","+Math.round(100*e[2])/100+","+Math.round(100*e[3])/100}))}C.gl.clearColor(0,0,0,0),C.gl.clear(C.gl.COLOR_BUFFER_BIT|C.gl.DEPTH_BUFFER_BIT),d.finish()}},Ops.Ui.VizTexture.prototype=new CABLES.Op,CABLES.OPS["4ea2d7b0-ca74-45db-962b-4d1965ac20c0"]={f:Ops.Ui.VizTexture,objName:"Ops.Ui.VizTexture"},Ops.Gl.Performance=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inTrigger("exe"),n=e.inValueBool("Visible",!0),r=e.outTrigger("childs"),o=e.inSwitch("Position",["top","bottom"],"top"),i=e.inBool("Open",!1),a=e.inBool("Smooth Graph",!0),s=e.inFloat("Scale",4),l=e.inFloat("Size",128),g=e.outObject("Canvas"),c=e.outNumber("FPS"),u=e.patch.cgl,p=document.createElement("div");let f=null,h=null,d=!1,m=0,C=0,S=0,O=0,x=0;const b=[],E=[],A=[],T=[];let y=0,L=0,v=null,B=0,w=0;const P=["|","/","-","\\"];let N=!0;const _="#007f9c",M="#aaaaaa",V="#222222",G="#003f5c",F="#7a5195",I="#ef5675",R="#ffa600";let U=0,D=0,k=0;e.toWorkPortsNeedToBeLinked(t,r);const z=e.patch.cgl.gl,j=z.getExtension("EXT_disjoint_timer_query_webgl2");t.onLinkChanged=n.onChange=()=>{K(),Y()},o.onChange=X,l.onChange=W,p.id="performance",p.style.position="absolute",p.style.left="0px",p.style.opacity="0.8",p.style.padding="10px",p.style.cursor="pointer",p.style.background="#222",p.style.color="white",p.style["font-family"]="monospace",p.style["font-size"]="12px",p.style["z-index"]="99999",p.innerHTML="&nbsp;",p.addEventListener("click",q);const H=e.patch.cgl.canvas.parentElement;function X(){v.style["pointer-events"]="none","top"==o.get()?(v.style.top=p.style.top="0px",v.style.bottom=p.style.bottom="initial"):(v.style.bottom=p.style.bottom="0px",v.style.top=p.style.top="initial")}function Y(){n.get()&&t.isLinked()?(p.style.display="block",p.style.opacity=1,v.style.display="block"):(p.style.display="none",p.style.opacity=0,v.style.display="none")}function W(){if(!v)return;const e=Math.max(0,parseInt(l.get()));v.width=e,v.height=e,p.style.left=e+"px",b.length=0,E.length=0,A.length=0,T.length=0;for(let t=0;t<e;t++)b[t]=-1,E[t]=-1,A[t]=-1,T[t]=-1}function q(){n.get()&&(p.style.opacity=1,d=!d,K())}function K(){J(),v||$(),d?(v.style.display="block",p.style.left=l.get()+"px",p.style["min-height"]="56px"):(v.style.display="none",p.style.left="0px",p.style["min-height"]="auto")}function Z(){const e=v.height,t=s.get();h.fillStyle=V,h.fillRect(0,0,v.width,e),h.fillStyle=G;let n=0;const r=Math.max(0,parseInt(l.get()));for(n=r;n>=0;n--)b[n]>30&&(h.fillStyle=_),b[n]>60&&(h.fillStyle=M),h.fillRect(r-n,e-b[n]*t,1,b[n]*t),b[n]>30&&(h.fillStyle=G);for(n=r;n>=0;n--){let o=0;h.fillStyle=F,o=E[n],h.fillRect(r-n,e-o*t,1,E[n]*t),h.fillStyle=I,o+=A[n],h.fillRect(r-n,e-o*t,1,A[n]*t),h.fillStyle=R,o+=T[n],h.fillRect(r-n,e-o*t,1,T[n]*t)}}function $(){v=document.createElement("canvas"),v.id="performance_"+e.patch.config.glCanvasId,v.width=l.get(),v.height=l.get(),v.style.display="block",v.style.opacity=.9,v.style.position="absolute",v.style.left="0px",v.style.cursor="pointer",v.style.top="-64px",v.style["z-index"]="99998",H.appendChild(v),h=v.getContext("2d"),v.addEventListener("click",q),W()}function J(){if(!n.get())return;let t="";e.patch.cgl.profileData.profileShaderCompiles>0&&(t+="Shader compile ("+e.patch.cgl.profileData.profileShaderCompileName+") "),e.patch.cgl.profileData.profileShaderGetUniform>0&&(t+="Shader get uni loc! ("+e.patch.cgl.profileData.profileShaderGetUniformName+")"),e.patch.cgl.profileData.profileTextureResize>0&&(t+="Texture resize! "),e.patch.cgl.profileData.profileFrameBuffercreate>0&&(t+="Framebuffer create! "),e.patch.cgl.profileData.profileEffectBuffercreate>0&&(t+="Effectbuffer create! "),e.patch.cgl.profileData.profileTextureDelete>0&&(t+="Texture delete! "),e.patch.cgl.profileData.profileNonTypedAttrib>0&&(t+="Not-Typed Buffer Attrib! "+e.patch.cgl.profileData.profileNonTypedAttribNames),e.patch.cgl.profileData.profileTextureNew>0&&(t+="new texture created! "),e.patch.cgl.profileData.profileGenMipMap>0&&(t+="generating mip maps!"),t.length>0&&(t='| <span style="color:#f80;">WARNING: '+t+"<span>");let r="";if(d?(r+='<span style="color:'+G+'"></span> '+C+" fps ",r+='<span style="color:'+F+'"></span> '+Math.round(100*D)/100+"ms mainloop ",r+='<span style="color:'+I+'"></span> '+Math.round(100*k)/100+"ms onframe ",U&&(r+='<span style="color:'+R+'"></span> '+Math.round(100*U)/100+"ms GPU"),r+=t,p.innerHTML=r):(r+=C+" fps / ",r+="CPU: "+Math.round(100*e.patch.cgl.profileData.profileOnAnimFrameOps)/100+"ms / ",U&&(r+="GPU: "+Math.round(100*U)/100+"ms  "),p.innerHTML=r),1!=e.patch.loading.getProgress()&&(p.innerHTML+="<br/>loading "+Math.round(100*e.patch.loading.getProgress())+"% "+P[++w%P.length]),d){let t=0;y=0,x=0;for(let e=b.length;e>b.length-b.length/3;e--)b[e]>-1&&(y+=b[e],t++),E[e]>-1&&(x+=E[e]);y/=t,x/=t,p.innerHTML+="<br/> "+u.canvasWidth+" x "+u.canvasHeight+" (x"+u.pixelDensity+") ",p.innerHTML+="<br/>frame avg: "+Math.round(100*x)/100+" ms ("+Math.round(x/y*100)+"%) / "+Math.round(100*y)/100+" ms",p.innerHTML+=" (self: "+Math.round(100*L)/100+" ms) ",p.innerHTML+="<br/>shader binds: "+Math.ceil(e.patch.cgl.profileData.profileShaderBinds/C)+" uniforms: "+Math.ceil(e.patch.cgl.profileData.profileUniformCount/C)+" mvp_uni_mat4: "+Math.ceil(e.patch.cgl.profileData.profileMVPMatrixCount/C)+" num glPrimitives: "+Math.ceil(e.patch.cgl.profileData.profileMeshNumElements/C)+" fenced pixelread: "+Math.ceil(e.patch.cgl.profileData.profileFencedPixelRead)+" mesh.setGeom: "+e.patch.cgl.profileData.profileMeshSetGeom+" videos: "+e.patch.cgl.profileData.profileVideosPlaying+" tex preview: "+e.patch.cgl.profileData.profileTexPreviews,p.innerHTML+=" draw meshes: "+Math.ceil(e.patch.cgl.profileData.profileMeshDraw/C)+" framebuffer blit: "+Math.ceil(e.patch.cgl.profileData.profileFramebuffer/C)+" texeffect blit: "+Math.ceil(e.patch.cgl.profileData.profileTextureEffect/C),p.innerHTML+=" all shader compiletime: "+Math.round(100*e.patch.cgl.profileData.shaderCompileTime)/100}e.patch.cgl.profileData.clear()}function Q(e,t,n,r){if(e.usedAvg=e.usedAvg||e.used,!e.ele||N){const n=document.createElement("div");e.ele=n,e.childs&&e.childs.length>0?n.style.height="500px":n.style.height="20px",n.style.overflow="hidden",n.style.display="inline-block",e.isRoot||(n.innerHTML='<div style="min-height:20px;width:100%;overflow:hidden;color:black;position:relative">&nbsp;'+e.name+"</div>",n.style["background-color"]="rgb("+e.colR+","+e.colG+","+e.colB+")",n.style["border-left"]="1px solid black"),t.appendChild(n)}if(e.isRoot?(e.ele.style.width="100%",e.ele.style.clear="both",e.ele.style.float="none"):(performance.now()-e.lastTime>200?(e.ele.style.display="none",e.hidden=!0):e.hidden&&(e.ele.style.display="inline-block",e.hidden=!1),e.ele.style.float="left",e.ele.style.width=Math.floor(e.usedAvg/n*98)+"%"),e&&e.childs&&e.childs.length>0){let t=0;for(var o=0;o<e.childs.length;o++)e.childs[o].usedAvg=.95*(e.childs[o].usedAvg||e.childs[o].used)+.05*e.childs[o].used,t+=e.childs[o].usedAvg;for(o=0;o<e.childs.length;o++)Q(e.childs[o],e.ele,t,r+1)}}function ee(e){for(let t=0;t<e.childs.length;t++)ee(e.childs[t]);e.childs.length=0}function te(){if(!CGL.performanceMeasures)return;f||(e.log("create measure ele"),f=document.createElement("div"),f.style.width="100%",f.style["background-color"]="#444",f.style.bottom="10px",f.style.height="100px",f.style.opacity="1",f.style.position="absolute",f.style["z-index"]="99999",f.innerHTML="",H.appendChild(f));let t=0;const n=CGL.performanceMeasures[0];for(let e=0;e<n.childs.length;e++)t+=n.childs[e].used;Q(CGL.performanceMeasures[0],f,t,0),n.childs.length=0,ee(CGL.performanceMeasures[0]),CGL.performanceMeasures.length=0,N=!1}function ne(){const t=performance.now();m++,j&&n.get()&&(e.patch.cgl.profileData.doProfileGlQuery=!0),0===S&&(S=Date.now()),Date.now()-S>=1e3&&(C=m,m=0,c.set(C),n.get()&&J(),S=Date.now());const o=e.patch.cgl.profileData.glQueryData;if(U=0,o){let e=0;for(let t in o)e++,o[t].time&&(U+=o[t].time)}n.get()&&(te(),d&&!e.patch.cgl.profileData.pause&&(b.push(e.patch.cgl.profileData.profileFrameDelta),b.shift(),E.push(O),E.shift(),A.push(e.patch.cgl.profileData.profileOnAnimFrameOps-e.patch.cgl.profileData.profileMainloopMs),A.shift(),T.push(U),T.shift(),Z())),B=performance.now(),L=performance.now()-t;const i=performance.now();g.setRef(v),r.trigger();const s=performance.now()-i,l=e.patch.cgl.profileData.profileMainloopMs,u=e.patch.cgl.profileData.profileOnAnimFrameOps-e.patch.cgl.profileData.profileMainloopMs;a.get()?(O=.9*O+.1*s,D=.5*D+.5*l,k=.5*k+.5*u):(O=s,D=l,k=u),e.patch.cgl.profileData.clearGlQuery()}H.appendChild(p),W(),K(),X(),Y(),e.onDelete=function(){v&&v.remove(),p&&p.remove()},i.onChange=function(){d=i.get(),K()},t.onTriggered=ne},Ops.Gl.Performance.prototype=new CABLES.Op,CABLES.OPS["9cd2d9de-000f-4a14-bd13-e7d5f057583c"]={f:Ops.Gl.Performance,objName:"Ops.Gl.Performance"},Ops.Anim.LFO=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inValue("Time"),n=e.inValueSelect("Type",["sine","triangle","ramp up","ramp down","block"],"sine"),r=e.inValue("Phase",0),o=e.inValue("Amplitude",1),i=e.outNumber("Result");let a=0;n.onChange=l,l();const s=Math.PI/2;function l(){"sine"==n.get()&&(t.onChange=h),"ramp up"==n.get()&&(t.onChange=u),"ramp down"==n.get()&&(t.onChange=p),"block"==n.get()&&(t.onChange=c),"triangle"==n.get()&&(t.onChange=f)}function g(){return t.get()+r.get()}function c(){let e=g()+.5;a=e%2,a=a<=1?-1:1,a*=o.get(),i.set(a)}function u(){let e=g()+1;e*=.5,a=e%1,a-=.5,a*=2,a*=o.get(),i.set(a)}function p(){let e=g();a=e%1,a-=.5,a*=-2,a*=o.get(),i.set(a)}function f(){let e=g();a=e%2,a>1&&(a=2-a),a-=.5,a*=2,a*=o.get(),i.set(a)}function h(){let e=g()*Math.PI-s;a=Math.sin(e),a*=o.get(),i.set(a)}},Ops.Anim.LFO.prototype=new CABLES.Op,CABLES.OPS["559bb980-78fb-47a7-a199-16f10808b150"]={f:Ops.Anim.LFO,objName:"Ops.Anim.LFO"},Ops.Html.WindowHasFocus=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.outBool("has focus"),n=e.outBool("Tab Visible",!0);function r(){t.set(!0)}function o(){t.set(!1)}function i(e){n.set(!document.hidden)}t.set(document.hasFocus()),window.addEventListener("blur",o),window.addEventListener("focus",r),document.addEventListener("visibilitychange",i),e.onDelete=function(){document.removeEventListener("visibilitychange",i)}},Ops.Html.WindowHasFocus.prototype=new CABLES.Op,CABLES.OPS["6542896e-aa13-4b57-81e0-163597f4149a"]={f:Ops.Html.WindowHasFocus,objName:"Ops.Html.WindowHasFocus"},Ops.Ui.Area=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inString("Title","");function n(){CABLES.UI&&(gui.savedState.setUnSaved("areaOp"),e.uiAttr({comment_title:t.get()||" "}),e.name=t.get())}t.setUiAttribs({hidePort:!0}),e.setUiAttrib({hasArea:!0}),e.init=t.onChange=e.onLoaded=n,n()},Ops.Ui.Area.prototype=new CABLES.Op,CABLES.OPS["38f79614-b0de-4960-8da5-2827e7f43415"]={f:Ops.Ui.Area,objName:"Ops.Ui.Area"},Ops.Html.WindowInfo=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.outNumber("clientWidth"),n=e.outNumber("clientHeight"),r=e.outNumber("body scroll Height"),o=e.outNumber("Device Pixel Ratio",1),i=(e.outBoolNum("Iframe Parent",window.top!=window.self),e.outNumber("Orientation Angle",0)),a=e.outString("Orientation Type","");function s(){t.set(window.innerWidth),n.set(window.innerHeight),o.set(window.devicePixelRatio),r.set(document.documentElement.scrollHeight),window.screen&&window.screen.orientation&&(i.set(window.screen.orientation.angle||0),a.set(window.screen.orientation.type||""))}window.addEventListener("resize",s),s()},Ops.Html.WindowInfo.prototype=new CABLES.Op,CABLES.OPS["9655045c-3539-457d-be65-a1456a58906a"]={f:Ops.Html.WindowInfo,objName:"Ops.Html.WindowInfo"},Ops.Math.Compare.GreaterThan=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inValueFloat("number1"),n=e.inValueFloat("number2"),r=e.outBoolNum("result");function o(){r.set(t.get()>n.get())}e.setTitle(">"),t.onChange=n.onChange=o},Ops.Math.Compare.GreaterThan.prototype=new CABLES.Op,CABLES.OPS["b250d606-f7f8-44d3-b099-c29efff2608a"]={f:Ops.Math.Compare.GreaterThan,objName:"Ops.Math.Compare.GreaterThan"},Ops.Math.Min_v3=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inValue("Value 1",1),n=e.inValue("Value 2",2),r=e.outNumber("result");function o(){let e=Math.min(t.get(),n.get());r.set(e)}t.onChange=n.onChange=o,o()},Ops.Math.Min_v3.prototype=new CABLES.Op,CABLES.OPS["24a9062d-380c-4690-8fe7-6703787fa94c"]={f:Ops.Math.Min_v3,objName:"Ops.Math.Min_v3"},Ops.Math.Max=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inValueFloat("value",1),n=e.inValueFloat("Maximum",1),r=e.outNumber("result");function o(){let e=Math.max(t.get(),n.get());e==e&&r.set(e)}n.onChange=t.onChange=o,o()},Ops.Math.Max.prototype=new CABLES.Op,CABLES.OPS["07f0be49-c226-4029-8039-3b620145dc2a"]={f:Ops.Math.Max,objName:"Ops.Math.Max"},Ops.Ui.PatchInput=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.addOutPort(new CABLES.Port(e,"create port",CABLES.OP_PORT_TYPE_DYNAMIC));function n(){for(let t in e.patch.ops)if(e.patch.ops[t].patchId&&e.patch.ops[t].patchId.get()==e.uiAttribs.subPatch)return e.patch.ops[t]}t.onLinkChanged=()=>{const r=n();if(!t.links.length||!r||!r.addNewInPort)return;const o=t.links[0].getOtherPort(t);t.removeLinks();const i=r.addNewInPort(o);gui.scene().link(o.parent,o.getName(),e,i),r.saveData()}},Ops.Ui.PatchInput.prototype=new CABLES.Op,CABLES.OPS["e3f68bc3-892a-4c78-9974-aca25c27025d"]={f:Ops.Ui.PatchInput,objName:"Ops.Ui.PatchInput"},Ops.Ui.PatchOutput=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.addInPort(new CABLES.Port(e,"create port",CABLES.OP_PORT_TYPE_DYNAMIC));function n(){for(let t in e.patch.ops)if(e.patch.ops[t].patchId&&e.patch.ops[t].patchId.get()==e.uiAttribs.subPatch)return e.patch.ops[t]}t.onLinkChanged=()=>{const r=n();if(!t.links.length)return;const o=t.links[0].getOtherPort(t);t.removeLinks();const i=r.addNewOutPort(o);gui.scene().link(o.parent,o.getName(),e,i),r.saveData()}},Ops.Ui.PatchOutput.prototype=new CABLES.Op,CABLES.OPS["851b44cb-5667-4140-9800-5aeb7031f1d7"]={f:Ops.Ui.PatchOutput,objName:"Ops.Ui.PatchOutput"},Ops.Ui.SubPatch=function(){CABLES.Op.apply(this,arguments);const e=this;e.dyn=e.addInPort(new CABLES.Port(e,"create port",CABLES.OP_PORT_TYPE_DYNAMIC)),e.dynOut=e.addOutPort(new CABLES.Port(e,"create port out",CABLES.OP_PORT_TYPE_DYNAMIC));const t=e.addInPort(new CABLES.Port(e,"dataStr",CABLES.OP_PORT_TYPE_VALUE,{display:"readonly"}));e.patchId=e.addInPort(new CABLES.Port(e,"patchId",CABLES.OP_PORT_TYPE_VALUE,{display:"readonly"})),t.setUiAttribs({hideParam:!0}),e.patchId.setUiAttribs({hideParam:!0});let n={ports:[],portsOut:[]},r=CABLES.generateUUID();e.patchId.set(r),g(),l();let o=!1;function i(){try{t.set(JSON.stringify(n))}catch(t){e.log(t)}}function a(e,t){e.hasSubpatchLstener||(e.hasSubpatchLstener=!0,e.addEventListener("onUiAttrChange",(function(t){if(t.title){let r=0;for(r=0;r<n.portsOut.length;r++)n.portsOut[r].name==e.name&&(n.portsOut[r].title=t.title);for(r=0;r<n.ports.length;r++)n.ports[r].name==e.name&&(n.ports[r].title=t.title);i()}}))),e.direction==CABLES.PORT_DIR_IN&&(e.type==CABLES.OP_PORT_TYPE_FUNCTION?e.onTriggered=function(){t.isLinked()&&t.trigger()}:e.onChange=function(){if(t.set(e.get()),!e.isLinked()){for(let t=0;t<n.ports.length;t++)n.ports[t].name===e.name&&(n.ports[t].value=e.get());i()}})}function s(){if(!e.patchId.get())return;const t=n.ports||[],r=n.portsOut||[];let i=0;for(i=0;i<t.length;i++)if(!e.getPortByName(t[i].name)){const n=e.addInPort(new CABLES.Port(e,t[i].name,t[i].type)),r=g(),o=r.addOutPort(new CABLES.Port(r,t[i].name,t[i].type));n.ignoreValueSerialize=!0,n.setUiAttribs({editableTitle:!0}),t[i].title&&(n.setUiAttribs({title:t[i].title}),o.setUiAttribs({title:t[i].title})),t[i].objType&&(n.setUiAttribs({objType:t[i].objType}),o.setUiAttribs({objType:t[i].objType})),t[i].value&&(n.set(t[i].value),o.set(t[i].value)),a(n,o)}for(i=0;i<r.length;i++)if(!e.getPortByName(r[i].name)){const t=e.addOutPort(new CABLES.Port(e,r[i].name,r[i].type)),n=l(),o=n.addInPort(new CABLES.Port(n,r[i].name,r[i].type));t.ignoreValueSerialize=!0,t.setUiAttribs({editableTitle:!0}),r[i].title&&(t.setUiAttribs({title:r[i].title}),o.setUiAttribs({title:r[i].title})),r[i].objType&&(t.setUiAttribs({objType:r[i].objType}),o.setUiAttribs({objType:r[i].objType})),a(o,t)}o=!0}function l(){let t=e.patch.getSubPatchOp(e.patchId.get(),"Ops.Ui.PatchOutput");return t||(e.patch.addOp("Ops.Ui.PatchOutput",{subPatch:e.patchId.get(),translate:{x:0,y:0}}),t=e.patch.getSubPatchOp(e.patchId.get(),"Ops.Ui.PatchOutput"),t||e.warn("no patchoutput!")),t}function g(){let t=e.patch.getSubPatchOp(e.patchId.get(),"Ops.Ui.PatchInput");return t||(e.patch.addOp("Ops.Ui.PatchInput",{subPatch:e.patchId.get(),translate:{x:0,y:0}}),t=e.patch.getSubPatchOp(e.patchId.get(),"Ops.Ui.PatchInput"),t||e.warn("no patchinput2!")),t}e.saveData=i,e.init=()=>{e.setStorage({subPatchVer:1})},e.patchId.onChange=function(){const t=e.patch.getSubPatchOps(r);if(2===t.length){e.patch.isEditorMode()&&CABLES.UI.DEFAULTOPS.isInBlueprint(e)&&CABLES.UI.undo.pause();for(let n=0;n<t.length;n++)e.patch.deleteOp(t[n].id);e.patch.isEditorMode()&&CABLES.UI.DEFAULTOPS.isInBlueprint(e)&&CABLES.UI.undo.resume()}},e.onLoaded=function(){},e.onLoadedValueSet=function(){n=JSON.parse(t.get()),n||(n={ports:[],portsOut:[]}),s()},t.onChange=function(){o||t.get()},e.addPortListener=a,e.setupPorts=s,e.addNewInPort=function(e,t,r){const o="in"+n.ports.length+" "+e.parent.name+" "+e.name,i={name:o,type:e.type};return e.uiAttribs.objType&&(i.objType=e.uiAttribs.objType),n.ports.push(i),s(),o},e.dyn.onLinkChanged=function(){if(e.dyn.isLinked()){const t=e.dyn.links[0].getOtherPort(e.dyn);e.dyn.removeLinks(),t.removeLinkTo(e.dyn),e.log("dyn link changed!!!");const n=e.addNewInPort(t);gui.scene().link(t.parent,t.getName(),e,n),o=!0,i()}else setTimeout((function(){e.dyn.removeLinks()}),100)},e.addNewOutPort=function(e,t,r){const o="out"+n.portsOut.length+" "+e.parent.name+" "+e.name,i={name:o,type:e.type};return e.uiAttribs.objType&&(i.objType=e.uiAttribs.objType),n.portsOut.push(i),s(),o},e.dynOut.onLinkChanged=function(){if(e.dynOut.isLinked()){const t=e.dynOut.links[0].getOtherPort(e.dynOut);e.dynOut.removeLinks(),t.removeLinkTo(e.dynOut);const n=e.addNewOutPort(t);gui.scene().link(t.parent,t.getName(),e,n),o=!0,i()}else setTimeout((function(){e.dynOut.removeLinks()}),100),e.log("dynOut unlinked...")},e.addSubLink=function(t,r){const o="in"+(n.ports.length-1)+" "+r.parent.name+" "+r.name;if(t.direction==CABLES.PORT_DIR_IN)gui.scene().link(t.parent,t.getName(),g(),o);else{const e=n.portsOut.length;gui.scene().link(t.parent,t.getName(),l(),"out"+(e-1)+" "+r.parent.name+" "+r.name)}const a=gui.patchView.getSubPatchBounds(e.patchId.get());return g().uiAttr({translate:{x:a.minx,y:a.miny-100}}),l().uiAttr({translate:{x:a.minx,y:a.maxy+100}}),i(),o},e.onDelete=function(){for(let t=e.patch.ops.length-1;t>=0;t--)e.patch.ops[t]&&e.patch.ops[t].uiAttribs&&e.patch.ops[t].uiAttribs.subPatch==e.patchId.get()&&e.patch.deleteOp(e.patch.ops[t].id)},e.rebuildListeners=()=>{e.log("rebuild listeners...");const t=l();for(let e=0;e<t.portsIn.length;e++)t.portsIn[e].isLinked()&&a(t.portsIn[e],this.portsOut[e])}},Ops.Ui.SubPatch.prototype=new CABLES.Op,CABLES.OPS["84d9a6f0-ed7a-466d-b386-225ed9e89c60"]={f:Ops.Ui.SubPatch,objName:"Ops.Ui.SubPatch"},Ops.Boolean.OrNumber=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inFloat("Number",0),n=e.inFloat("Or",1),r=e.outNumber("Result");function o(){const e=t.get();e&&e==e?r.set(t.get()):r.set(n.get())}t.onChange=n.onChange=o,o()},Ops.Boolean.OrNumber.prototype=new CABLES.Op,CABLES.OPS["beb3c979-5723-4283-a23a-34f4b5038b49"]={f:Ops.Boolean.OrNumber,objName:"Ops.Boolean.OrNumber"},Ops.Vars.VarSetNumber_v2=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inValueFloat("Value",0);e.varName=e.inDropDown("Variable",[],"",!0),new CABLES.VarSetOpWrapper(e,"number",t,e.varName)},Ops.Vars.VarSetNumber_v2.prototype=new CABLES.Op,CABLES.OPS["b5249226-6095-4828-8a1c-080654e192fa"]={f:Ops.Vars.VarSetNumber_v2,objName:"Ops.Vars.VarSetNumber_v2"},Ops.Math.PowerOfTwoSize=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inValueInt("Width"),n=e.inValueInt("Height"),r=e.inValueSelect("Strategy",["floor","floor/2","ceil"],"floor"),o=e.outNumber("Width Result"),i=e.outNumber("Height Result");r.onChange=l,t.onChange=n.onChange=f;let a=null;function s(e){return 1==e||2==e||4==e||8==e||16==e||32==e||64==e||128==e||256==e||512==e||1024==e||2048==e||4096==e||8192==e||16384==e}function l(){let e=r.get();"floor"==e&&(a=u),"floor/2"==e&&(a=c),"ceil"==e&&(a=g),"nearest"==e&&(a=p),f()}function g(e){return e>2048?4096:e>1024?2048:e>512?1024:e>256?512:e>128?256:e>64?128:e>32?64:e>16?32:e>8?16:e>4?8:e>2?4:void 0}function c(e){return Math.ceil(u(e)/2)}function u(e){return e<2?1:e<4?2:e<8?4:e<16?8:e<32?16:e<64?32:e<128?64:e<256?128:e<512?256:e<1024?512:e<2048?1024:e<4096?2048:e<8192?4096:void 0}function p(e){return e>3072?4096:e>1536?2048:e>768?1024:e>320?512:e>191?256:e>95?128:e>47?64:e>23?32:e>11?16:e>5?8:e>3?4:2}function f(){let e=t.get(),r=n.get();s(e)||(e=a(e)),s(r)||(r=a(r)),o.set(e),i.set(r)}l()},Ops.Math.PowerOfTwoSize.prototype=new CABLES.Op,CABLES.OPS["58e01e34-0f42-4861-ad9a-ed96e08f8565"]={f:Ops.Math.PowerOfTwoSize,objName:"Ops.Math.PowerOfTwoSize"},Ops.Trigger.TriggerCounter=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inTriggerButton("exe"),n=e.inTriggerButton("reset"),r=e.outTrigger("trigger"),o=e.outNumber("timesTriggered");e.toWorkPortsNeedToBeLinked(t);let i=0;function a(){i=0,e.setUiAttrib({extendTitle:i}),o.set(i)}n.onTriggered=e.onLoaded=a,t.onTriggered=function(){i++,o.set(i),e.setUiAttrib({extendTitle:i}),r.trigger()}},Ops.Trigger.TriggerCounter.prototype=new CABLES.Op,CABLES.OPS["e640619f-235c-4543-bbf8-b358e0283180"]={f:Ops.Trigger.TriggerCounter,objName:"Ops.Trigger.TriggerCounter"},Ops.Trigger.TriggerReceive=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.outTrigger("Triggered");e.varName=e.inValueSelect("Named Trigger",[],"",!0),o(),e.patch.addEventListener("namedTriggersChanged",o);let n=null;function r(){t.trigger()}function o(){if(CABLES.UI){let t=[],n=e.patch.namedTriggers;for(let e in n)t.push(e);e.varName.uiAttribs.values=t}}function i(){e.varName.get()?e.setUiError("unknowntrigger",null):e.setUiError("unknowntrigger","unknown trigger")}e.varName.onChange=function(){if(n){let t=e.patch.namedTriggers[n],o=t.indexOf(r);-1!=o&&t.splice(o,1)}e.setTitle(">"+e.varName.get()),e.patch.namedTriggers[e.varName.get()]=e.patch.namedTriggers[e.varName.get()]||[],e.patch.namedTriggers[e.varName.get()].push(r),n=e.varName.get(),i(),e.patch.emitEvent("opTriggerNameChanged",e,e.varName.get())},e.on("uiParamPanel",i)},Ops.Trigger.TriggerReceive.prototype=new CABLES.Op,CABLES.OPS["0816c999-f2db-466b-9777-2814573574c5"]={f:Ops.Trigger.TriggerReceive,objName:"Ops.Trigger.TriggerReceive"},Ops.Html.CSS_v2=function(){CABLES.Op.apply(this,arguments);const e=this,t={},n=e.inStringEditor("css code");n.setUiAttribs({editorSyntax:"css",ignoreBigPort:!0});let r=null;const o="css_"+CABLES.uuid();function i(){let t=n.get();if(t){let n=null;e.storage&&e.storage.blueprint&&e.storage.blueprint.patchId&&(n=e.storage.blueprint.patchId),t=t.replace(new RegExp("{{ASSETPATH}}","g"),e.patch.getAssetPath(n))}return t}function a(){r=document.getElementById(o),r?r.textContent=i():(r=document.createElement("style"),r.type="text/css",r.id=o,r.textContent=t.css_spinner,document.getElementsByTagName("body")[0].appendChild(r))}n.onChange=a,a(),e.onDelete=function(){r=document.getElementById(o),r&&r.remove()}},Ops.Html.CSS_v2.prototype=new CABLES.Op,CABLES.OPS["a56d3edd-06ad-44ed-9810-dbf714600c67"]={f:Ops.Html.CSS_v2,objName:"Ops.Html.CSS_v2"},Ops.Gl.TextureEffects.Alpha=function(){CABLES.Op.apply(this,arguments);const e=this,t={clearAlpha_frag:"\n// void main()\n// {\n//     outColor.a=0.0;\n// }\n\nIN vec2 texCoord;\nUNI sampler2D tex;\nUNI float amount;\n\n\nvoid main()\n{\n    vec4 base=texture(tex,texCoord);\n\n    outColor=base;\n\n    #ifdef METH_NORM\n        outColor.a=amount;\n    #endif\n    #ifdef METH_ADD\n        outColor.a+=amount;\n    #endif\n    #ifdef METH_SUB\n        outColor.a-=amount;\n    #endif\n    #ifdef METH_MUL\n        outColor.a*=amount;\n    #endif\n\n    #ifdef DO_CLAMP\n    outColor.a=clamp(0.0,1.0,outColor.a);\n    #endif\n\n}\n"},n=e.inTrigger("Render"),r=e.inValueSlider("Amount",1),o=e.inSwitch("Method",["Set","Add","Sub","Mul"],"Set"),i=e.inBool("Clamp",!0),a=e.outTrigger("Next"),s=e.patch.cgl,l=new CGL.Shader(s,"Alpha"),g=0;function c(){l.toggleDefine("METH_NORM","Set"==o.get()),l.toggleDefine("METH_ADD","Add"==o.get()),l.toggleDefine("METH_SUB","Sub"==o.get()),l.toggleDefine("METH_MUL","Mul"==o.get()),l.toggleDefine("DO_CLAMP",i.get())}l.setSource(l.getDefaultVertexShader(),t.clearAlpha_frag||""),new CGL.Uniform(l,"f","amount",r),new CGL.Uniform(l,"t","tex",g),i.onChange=o.onChange=c,c(),n.onTriggered=function(){CGL.TextureEffect.checkOpInEffect(e)&&(s.pushShader(l),s.currentTextureEffect.bind(),s.setTexture(g,s.currentTextureEffect.getCurrentSourceTexture().tex),s.currentTextureEffect.finish(),s.popShader(),a.trigger())}},Ops.Gl.TextureEffects.Alpha.prototype=new CABLES.Op,CABLES.OPS["131687e0-77f5-4fd7-be57-864aa6559418"]={f:Ops.Gl.TextureEffects.Alpha,objName:"Ops.Gl.TextureEffects.Alpha"},Ops.Patch.Pw01AEC.GetScaleFitFillv3=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inInt("Image Width"),n=e.inInt("Image Height"),r=e.inInt("Canvas Width"),o=e.inInt("Canvas Height"),i=e.inValueBool("Enable Fit/Fill",!0),a=e.inValueSelect("Fit/Fill",["Fit","Fill"],"Fit"),s=e.inFloat("Manual Scalar",1),l=e.outNumber("Adaptation Scale"),g=e.outNumber("Scale X"),c=e.outNumber("Scale Y"),u=e.outNumber("Mults X"),p=e.outNumber("Mults Y");function f(){let e=1;i.get()&&(e=h(r.get(),o.get(),t.get(),n.get(),a.get())),e*=s.get();let f=t.get()/r.get(),d=n.get()/o.get();f*=e,d*=e,l.set(e),g.set(f),c.set(d),u.set(1/f),p.set(1/d)}function h(e,t,n,r,o){var i=e/t,a=n/r;switch(o){case"Fill":return i>=a?e/n:t/r;case"Fit":return i<=a?e/n:t/r;default:return 1}}t.onChange=f,n.onChange=f,r.onChange=f,o.onChange=f,i.onChange=f,a.onChange=f,s.onChange=f},Ops.Patch.Pw01AEC.GetScaleFitFillv3.prototype=new CABLES.Op,CABLES.OPS["ea8e66a7-512c-4270-b750-9a57e49d0075"]={f:Ops.Patch.Pw01AEC.GetScaleFitFillv3,objName:"Ops.Patch.Pw01AEC.GetScaleFitFillv3"},Ops.Gl.Textures.TextureInfo=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inObject("Texture"),n=e.outNumber("Name"),r=e.outString("PixelFormat"),o=e.outNumber("Width"),i=e.outNumber("Height"),a=e.outNumber("Ratio"),s=e.outNumber("Filter"),l=e.outNumber("Wrap"),g=e.outBoolNum("Flipped"),c=e.outBoolNum("HDR"),u=e.outBoolNum("Is Empty Default Texture",!1),p=e.outBoolNum("Is Default Texture",!1),f=e.outBoolNum("Is Cubemap"),h=e.outNumber("Id");c.setUiAttribs({title:"Float"});const d=CGL.Texture.getEmptyTexture(e.patch.cgl),m=CGL.Texture.getTempTexture(e.patch.cgl);t.onChange=function(){if(t.get()){n.set(t.get().name),o.set(t.get().width),i.set(t.get().height),a.set(t.get().width/t.get().height);let e="unknown";t.get().filter==CGL.Texture.FILTER_NEAREST?e="nearest":t.get().filter==CGL.Texture.FILTER_LINEAR?e="linear":t.get().filter==CGL.Texture.FILTER_MIPMAP&&(e="mipmap"),s.set(t.get().filter+" "+e);let u="unknown";t.get().wrap==CGL.Texture.WRAP_CLAMP_TO_EDGE?u="clamp to edge":t.get().wrap==CGL.Texture.WRAP_REPEAT?u="repeat":t.get().wrap==CGL.Texture.WRAP_MIRRORED_REPEAT&&(u="mirrored repeat"),l.set(t.get().wrap+" "+u),r.set(t.get().pixelFormat),h.set(t.get().id),g.set(t.get().flipped),c.set(t.get().textureType==CGL.Texture.TYPE_FLOAT),f.set(t.get().cubemap)}else n.set("no texture"),o.set(0),i.set(0),a.set(0),s.set(null),l.set(null),h.set(null),g.set(!1),c.set(!1),f.set(!1);u.set(t.get()==d),p.set(t.get()==m)}},Ops.Gl.Textures.TextureInfo.prototype=new CABLES.Op,CABLES.OPS["71e5ee4c-3455-4c09-abb2-67abf382f35b"]={f:Ops.Gl.Textures.TextureInfo,objName:"Ops.Gl.Textures.TextureInfo"},Ops.Math.RoundEven=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inValueFloat("Number"),n=e.inSwitch("Mode",["Ceil","Floor"],"Ceil"),r=e.outNumber("Result");n.onChange=t.onChange=function(){let e=0;e="Floor"===n.get()?2*Math.floor(t.get()/2):2*Math.round(t.get()/2),r.set(e)}},Ops.Math.RoundEven.prototype=new CABLES.Op,CABLES.OPS["b4c116ba-ab64-4903-80bb-35c8d65819a1"]={f:Ops.Math.RoundEven,objName:"Ops.Math.RoundEven"},Ops.Math.Sum=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inValueFloat("number1",1),n=e.inValueFloat("number2",1),r=e.outNumber("result");function o(){const e=t.get()+n.get();isNaN(e)||r.set(e)}e.setTitle("+"),t.onChange=n.onChange=o,o()},Ops.Math.Sum.prototype=new CABLES.Op,CABLES.OPS["c8fb181e-0b03-4b41-9e55-06b6267bc634"]={f:Ops.Math.Sum,objName:"Ops.Math.Sum"},Ops.Trigger.TriggerExtender=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inTriggerButton("Execute"),n=e.outTrigger("Next");t.onTriggered=function(){n.trigger()}},Ops.Trigger.TriggerExtender.prototype=new CABLES.Op,CABLES.OPS["7ef594f3-4907-47b0-a2d3-9854eda1679d"]={f:Ops.Trigger.TriggerExtender,objName:"Ops.Trigger.TriggerExtender"},Ops.Html.FullscreenMode=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inTriggerButton("Request Fullscreen"),n=e.inTriggerButton("Exit Fullscreen"),r=e.inSwitch("Element",["Canvas","Document"],"Canvas"),o=e.outBoolNum("Is Fullscreen");n.onTriggered=l,t.onTriggered=s;let i=0;function a(){const e=!window.screenTop&&!window.screenY;o.set(e)}function s(){i++,i>30&&(t.onTriggered=null,e.setUiAttrib({error:"Fullscreen Request shound not triggered that often: op disabled"}),l());let n=null;n="Canvas"==r?e.patch.cgl.canvas.parentElement:document.documentElement,n.requestFullScreen?n.requestFullScreen():n.mozRequestFullScreen?n.mozRequestFullScreen():n.webkitRequestFullScreen?n.webkitRequestFullScreen():n.msRequestFullScreen&&n.msRequestFullScreen(),setTimeout(a,100),setTimeout(a,500),setTimeout(a,1e3)}function l(){i--,document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen(),setTimeout(a,100),setTimeout(a,500),setTimeout(a,1e3)}},Ops.Html.FullscreenMode.prototype=new CABLES.Op,CABLES.OPS["fe933b35-696d-4738-be03-c0c011ed67a0"]={f:Ops.Html.FullscreenMode,objName:"Ops.Html.FullscreenMode"},Ops.Trigger.IfEqualsThen=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inTrigger("exe");let n=e.inValue("Value 1",0),r=e.inValue("Value 2",0),o=e.addOutPort(new CABLES.Port(e,"then",CABLES.OP_PORT_TYPE_FUNCTION)),i=e.addOutPort(new CABLES.Port(e,"else",CABLES.OP_PORT_TYPE_FUNCTION));function a(){n.get()==r.get()?o.trigger():i.trigger()}t.onTriggered=a},Ops.Trigger.IfEqualsThen.prototype=new CABLES.Op,CABLES.OPS["e8196d70-d0a6-470a-9448-a7ac0c0e956e"]={f:Ops.Trigger.IfEqualsThen,objName:"Ops.Trigger.IfEqualsThen"},Ops.Gl.ValidTexture=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inTexture("Texture"),n=e.inSwitch("Default",["Empty","Stripes"],"Empty"),r=e.outTexture("Result");let o=CGL.Texture.getEmptyTexture(e.patch.cgl);n.onChange=function(){o="Empty"==n.get()?CGL.Texture.getEmptyTexture(e.patch.cgl):CGL.Texture.getTempTexture(e.patch.cgl)},t.onChange=function(){let e=t.get();e||(e=o),r.set(e)}},Ops.Gl.ValidTexture.prototype=new CABLES.Op,CABLES.OPS["51c24850-aa8b-41e4-936e-68ba718b5e39"]={f:Ops.Gl.ValidTexture,objName:"Ops.Gl.ValidTexture"},Ops.Devices.Keyboard.KeyPressLearn=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inValueInt("key code"),n=e.inValueBool("canvas only",!0),r=e.inValueSelect("Mod Key",["none","alt"],"none"),o=e.inValueBool("Enabled",!0),i=e.inValueBool("Prevent Default"),a=e.inTriggerButton("learn"),s=e.outTrigger("on press"),l=e.outTrigger("on release"),g=e.outBoolNum("Pressed",!1),c=e.outString("Key"),u=e.patch.cgl;let p=!1;function f(n){p?(t.set(n.keyCode),CABLES.UI&&e.refreshParams(),p=!1,m(),d(),CABLES.UI&&gui.emitEvent("portValueEdited",e,t,t.get())):n.keyCode==t.get()&&("alt"==r.get()?!0===n.altKey&&(s.trigger(),g.set(!0),i.get()&&n.preventDefault()):(s.trigger(),g.set(!0),i.get()&&n.preventDefault()))}function h(e){if(e.keyCode==t.get()){let t=!0;"alt"==r.get()&&1!=e.altKey&&(t=!1),t&&(l.trigger(),g.set(!1))}}function d(){n.get()?C():S()}function m(){document.removeEventListener("keydown",f,!1),document.removeEventListener("keyup",h,!1),u.canvas.removeEventListener("keydown",f,!1),u.canvas.removeEventListener("keyup",h,!1),g.set(!1)}function C(){CABLES.UTILS.isNumeric(u.canvas.getAttribute("tabindex"))||u.canvas.setAttribute("tabindex",1),u.canvas.addEventListener("keydown",f,!1),u.canvas.addEventListener("keyup",h,!1)}function S(){document.addEventListener("keydown",f,!1),document.addEventListener("keyup",h,!1)}function O(){let n=CABLES.keyCodeToName(t.get());const o=r.get();o&&"none"!==o&&(n=o.charAt(0).toUpperCase()+o.slice(1)+"-"+n),e.setUiAttribs({extendTitle:n}),c.set(n)}r.onChange=t.onChange=O,e.onDelete=function(){u.canvas.removeEventListener("keyup",h,!1),u.canvas.removeEventListener("keydown",f,!1),document.removeEventListener("keyup",h,!1),document.removeEventListener("keydown",f,!1)},a.onTriggered=function(){p=!0,S(),setTimeout((function(){p=!1,m(),d()}),3e3)},o.onChange=function(){o.get()?d():m()},n.onChange=function(){m(),d()},C()},Ops.Devices.Keyboard.KeyPressLearn.prototype=new CABLES.Op,CABLES.OPS["f069c0db-4051-4eae-989e-6ef7953787fd"]={f:Ops.Devices.Keyboard.KeyPressLearn,objName:"Ops.Devices.Keyboard.KeyPressLearn"},Ops.Boolean.Not=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inValueBool("Boolean"),n=e.outBoolNum("Result");t.changeAlways=!0,t.onChange=function(){n.set(!t.get())}},Ops.Boolean.Not.prototype=new CABLES.Op,CABLES.OPS["6d123c9f-7485-4fd9-a5c2-76e59dcbeb34"]={f:Ops.Boolean.Not,objName:"Ops.Boolean.Not"},Ops.Boolean.ToggleBool_v2=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inTriggerButton("trigger"),n=e.inTriggerButton("reset"),r=e.inBool("Default",!1),o=e.outBoolNum("result");let i=!1;e.onLoadedValueSet=()=>{o.set(r.get())},t.onTriggered=function(){i=!i,o.set(i)},n.onTriggered=function(){i=r.get(),o.set(i)}},Ops.Boolean.ToggleBool_v2.prototype=new CABLES.Op,CABLES.OPS["4313d9bb-96b6-43bc-9190-6068cfb2593c"]={f:Ops.Boolean.ToggleBool_v2,objName:"Ops.Boolean.ToggleBool_v2"},Ops.Json.AjaxRequest_v2=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inUrl("file"),n=e.inValueBool("JsonP",!1),r=e.inObject("headers",{}),o=e.inStringEditor("body",""),i=e.inDropDown("HTTP Method",["GET","POST","PUT","DELETE","PATCH","HEAD","CONNECT","OPTIONS","TRACE"],"GET"),a=e.inString("Content-Type","application/json"),s=e.inBool("parse json",!0),l=e.inBool("Auto request",!0),g=e.inTriggerButton("reload"),c=e.outObject("data"),u=e.outString("response"),p=e.outNumber("Duration MS",0),f=e.outNumber("Status Code",0),h=e.outBoolNum("Is Loading",!1),d=e.outTrigger("Loaded");t.setUiAttribs({title:"URL"}),g.setUiAttribs({buttonTitle:"trigger request"}),c.ignoreValueSerialize=!0,u.ignoreValueSerialize=!0,l.onChange=t.onChange=n.onChange=r.onChange=i.onChange=s.onChange=function(){C(!1)},g.onTriggered=function(){C(!0)};let m=0;function C(e=!1){clearTimeout(m),m=setTimeout((function(){S(null,e)}),100)}function S(g,m=!1){if(!l.get()&&!m)return;if(!t.get())return;const C=e.patch.loading.start("jsonFile",""+t.get(),e);h.set(!0),e.setUiAttrib({extendTitle:CABLES.basename(t.get())}),e.setUiError("jsonerr",null);let S=CABLES.ajax;n.get()&&(S=CABLES.jsonp);let O=e.patch.getFilePath(t.get());g&&(O+="?rnd="+CABLES.generateUUID()),e.patch.loading.addAssetLoadingTask((()=>{const t=o.get(),n=performance.now();S(O,((t,r,o)=>{p.set(Math.round(performance.now()-n)),c.set(null),u.set(null),f.set(o.status);try{let t=r;"string"==typeof t&&s.get()&&(t=JSON.parse(r),c.set(t)),u.set(r),e.uiAttr({error:null}),e.patch.loading.finished(C),d.trigger(),h.set(!1)}catch(t){e.logError(t),e.setUiError("jsonerr","Problem while loading json:<br/>"+t),e.patch.loading.finished(C),h.set(!1)}}),i.get(),t&&t.length>0?t:null,a.get(),null,r.get()||{})}))}e.onFileChanged=function(e){t.get()&&t.get().indexOf(e)>-1&&S(!0)}},Ops.Json.AjaxRequest_v2.prototype=new CABLES.Op,CABLES.OPS["e0879058-5505-4dc4-b9ff-47a3d3c8a71a"]={f:Ops.Json.AjaxRequest_v2,objName:"Ops.Json.AjaxRequest_v2"},Ops.Json.ObjectGetArrayValuesByPath=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inObject("Object"),n=e.inString("Path"),r=e.outArray("Output"),o=e.outBool("Found");function i(){const i=t.get();let s=[];const l=n.get();if(e.setUiError("path",null),i&&l)if("object"!=typeof i)o.set(!1),e.setUiError("notiterable","input object of type "+typeof i+" is not travesable by path");else if(Array.isArray(i))o.set(!1),e.setUiError("notiterable","input of type "+typeof i+" is not an object");else{e.setUiError("notiterable",null);const t=l.split(".");o.set(!1);let g="",c="",u="",p=null;for(let e=0;e<t.length;e++){if(g+=t[e],p=a(g,i),Array.isArray(p)){c=g,u=t.splice(e+2,t.length-(e+2)).join(".");break}g+="."}if(p){if(t.length>1)for(let e=0;e<p.length;e++){let t=c+"."+e;u&&""!==u&&(t+="."+u);const n=a(t,i);void 0!==n&&o.set(!0),s.push(n)}else s=Array.isArray(p)?p:[p],o.set(!0);const r=n.get().split("."),l=r[r.length-1]+"";e.setUiAttrib({extendTitle:l})}o.get()?r.setRef(s):(e.setUiError("path","given path seems to be invalid!",1),r.setRef([]))}else o.set(!1)}function a(e,t=self,n="."){return(Array.isArray(e)?e:e.split(n)).reduce(((e,t)=>e&&e[t]),t)}t.onChange=i,n.onChange=i},Ops.Json.ObjectGetArrayValuesByPath.prototype=new CABLES.Op,CABLES.OPS["609a645e-5e24-4a5e-a379-804c5b64f5d5"]={f:Ops.Json.ObjectGetArrayValuesByPath,objName:"Ops.Json.ObjectGetArrayValuesByPath"},Ops.Gl.TextureArrayLoaderFromArray_v2=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inArray("urls"),n=e.inDropDown("filter",["nearest","linear","mipmap"],"linear"),r=e.inDropDown("wrap",["repeat","mirrored repeat","clamp to edge"],"repeat"),o=e.inBool("Flip",!1),i=e.inBool("unpackPreMultipliedAlpha",!1),a=e.inBool("Caching",!1),s=e.inBool("Asset in patch",!1),l=e.outArray("TextureArray"),g=e.outNumber("width"),c=e.outNumber("height"),u=e.outBoolNum("loading"),p=e.outNumber("Aspect Ratio");e.toWorkPortsNeedToBeLinked(t);const f=e.patch.cgl,h=[];let d=CGL.Texture.FILTER_LINEAR,m=CGL.Texture.WRAP_MIRRORED_REPEAT,C=null,S=0;function O(e){t.isLinked()?(clearTimeout(S),S=setTimeout((function(){b(e)}),30)):l.setRef(null)}function x(t,n,r,u){let C=n;const S=t;if(!C)return;if(s.get()){let t=null;e.storage&&e.storage.blueprint&&e.storage.blueprint.patchId&&(t=e.storage.blueprint.patchId),C=e.patch.getAssetPath(t)+C}C=e.patch.getFilePath(C),a.get()||r&&(C+="?rnd="+CABLES.generateUUID());let O=CGL.Texture.load(f,C,(function(t){if(t){const t='could not load texture "'+C+'"';return e.uiAttr({error:t}),e.warn("[TextureArrayLoader] "+t),void(u&&u())}e.uiAttr({error:null}),g.set(O.width),c.set(O.height),p.set(O.width/O.height),h[S]=O,l.setRef(h),u&&u()}),{wrap:m,flip:o.get(),unpackAlpha:i.get(),filter:d})}function b(n){const r=t.get();if(r&&0!=r.length){C&&f.patch.loading.finished(C),C=f.patch.loading.start("texturearray",CABLES.uuid(),e),u.set(!0);for(let e=0;e<r.length;e++){h[e]=CGL.Texture.getEmptyTexture(f);let t=null;e==r.length-1&&(t=()=>{u.set(!1),f.patch.loading.finished(C)}),r[e]?x(e,r[e],n,t):t&&t()}}}function E(){"nearest"==n.get()&&(d=CGL.Texture.FILTER_NEAREST),"linear"==n.get()&&(d=CGL.Texture.FILTER_LINEAR),"mipmap"==n.get()&&(d=CGL.Texture.FILTER_MIPMAP),O()}function A(){"repeat"==r.get()&&(m=CGL.Texture.WRAP_REPEAT),"mirrored repeat"==r.get()&&(m=CGL.Texture.WRAP_MIRRORED_REPEAT),"clamp to edge"==r.get()&&(m=CGL.Texture.WRAP_CLAMP_TO_EDGE),O()}l.set(h),s.onChange=o.onChange=i.onChange=t.onChange=O,n.onChange=E,r.onChange=A,e.onFileChanged=function(e){}},Ops.Gl.TextureArrayLoaderFromArray_v2.prototype=new CABLES.Op,CABLES.OPS["f994015c-72ab-42f4-9ef7-a6409a9efb9b"]={f:Ops.Gl.TextureArrayLoaderFromArray_v2,objName:"Ops.Gl.TextureArrayLoaderFromArray_v2"},Ops.Trigger.TriggerSend=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inTriggerButton("Trigger");function n(){if(CABLES.UI){const t=[],n=e.patch.namedTriggers;t.push("+ create new one");for(const e in n)t.push(e);e.varName.uiAttribs.values=t}}function r(){if(CABLES.UI){if("+ create new one"==e.varName.get())return void new CABLES.UI.ModalDialog({prompt:!0,title:"New Trigger",text:"Enter a name for the new trigger",promptValue:"",promptOk:t=>{e.varName.set(t),e.patch.namedTriggers[t]=e.patch.namedTriggers[t]||[],n()}});e.refreshParams()}e.patch.namedTriggers[e.varName.get()]||(e.patch.namedTriggers[e.varName.get()]=e.patch.namedTriggers[e.varName.get()]||[],e.patch.emitEvent("namedTriggersChanged")),e.setTitle(">"+e.varName.get()),e.refreshParams(),e.patch.emitEvent("opTriggerNameChanged",e,e.varName.get())}function o(){const t=e.patch.namedTriggers[e.varName.get()];if(e.patch.emitEvent("namedTriggerSent",e.varName.get()),t){e.setUiError("unknowntrigger",null);for(let e=0;e<t.length;e++)t[e]()}else e.setUiError("unknowntrigger","unknown trigger")}e.varName=e.inValueSelect("Named Trigger",[],"",!0),e.varName.onChange=r,t.onTriggered=o,e.patch.addEventListener("namedTriggersChanged",n),n()},Ops.Trigger.TriggerSend.prototype=new CABLES.Op,CABLES.OPS["ce1eaf2b-943b-4dc0-ab5e-ee11b63c9ed0"]={f:Ops.Trigger.TriggerSend,objName:"Ops.Trigger.TriggerSend"},Ops.Trigger.TriggerOnChangeTexture=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inTexture("Texture"),n=e.inBool("Ignore empty/default Texture",!1),r=e.outTrigger("Changed"),o=e.outTexture("Result",CGL.Texture.getEmptyTexture(e.patch.cgl));t.onLinkChanged=t.onChange=function(){const i=t.get();(!n.get()||i!=CGL.Texture.getEmptyTexture(e.patch.cgl)&&null!=i)&&(o.set(i||CGL.Texture.getEmptyTexture(e.patch.cgl)),r.trigger())}},Ops.Trigger.TriggerOnChangeTexture.prototype=new CABLES.Op,CABLES.OPS["d7260ecb-d862-496a-8a26-f8165ab49dd2"]={f:Ops.Trigger.TriggerOnChangeTexture,objName:"Ops.Trigger.TriggerOnChangeTexture"},Ops.Trigger.TriggerOnce=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inTriggerButton("Exec"),n=e.inTriggerButton("Reset"),r=e.outTrigger("Next"),o=e.outBoolNum("Was Triggered");let i=!1;e.toWorkPortsNeedToBeLinked(t),n.onTriggered=function(){i=!1,o.set(i)},t.onTriggered=function(){i||(i=!0,r.trigger(),o.set(i))}},Ops.Trigger.TriggerOnce.prototype=new CABLES.Op,CABLES.OPS["cf3544e4-e392-432b-89fd-fcfb5c974388"]={f:Ops.Trigger.TriggerOnce,objName:"Ops.Trigger.TriggerOnce"},Ops.Vars.VarSetTexture_v2=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inTexture("Value",null);e.varName=e.inDropDown("Variable",[],"",!0),new CABLES.VarSetOpWrapper(e,"object",t,e.varName)},Ops.Vars.VarSetTexture_v2.prototype=new CABLES.Op,CABLES.OPS["4fbfc71e-1429-439f-8591-ad35961252ed"]={f:Ops.Vars.VarSetTexture_v2,objName:"Ops.Vars.VarSetTexture_v2"},Ops.Boolean.And=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inValueBool("bool 1"),n=e.inValueBool("bool 2"),r=e.outBoolNum("result");function o(){r.set(n.get()&&t.get())}t.onChange=n.onChange=o},Ops.Boolean.And.prototype=new CABLES.Op,CABLES.OPS["c26e6ce0-8047-44bb-9bc8-5a4f911ed8ad"]={f:Ops.Boolean.And,objName:"Ops.Boolean.And"},Ops.Array.ArrayRandomSelection=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inArray("Array"),n=e.inValueInt("Elements",10),r=e.inValue("Seed",1),o=e.outArray("Result"),i=e.outNumber("Array length");let a=[];function s(){if(Math.floor(n.get())<0||!t.get())return o.set(null),void i.set(0);let e=t.get();a.length=Math.floor(n.get());let s=[];for(var l=0;l<Math.max(a.length,e.length);l++)s[l]=l%e.length;for(s=CABLES.shuffleArray(s),Math.randomSeed=r.get(),l=0;l<n.get();l++){let t=s[l];a[l]=e[t]}o.set(null),o.set(a),i.set(a.length)}r.onChange=t.onChange=n.onChange=s},Ops.Array.ArrayRandomSelection.prototype=new CABLES.Op,CABLES.OPS["3dc059c8-bcb3-4d63-b806-ce81215da3b5"]={f:Ops.Array.ArrayRandomSelection,objName:"Ops.Array.ArrayRandomSelection"},Ops.Array.ArrayLength=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inArray("array"),n=e.outNumber("length");function r(){let e=0;e=t.get()?t.get().length:-1,n.set(e)}n.ignoreValueSerialize=!0,t.onChange=r},Ops.Array.ArrayLength.prototype=new CABLES.Op,CABLES.OPS["ea508405-833d-411a-86b4-1a012c135c8a"]={f:Ops.Array.ArrayLength,objName:"Ops.Array.ArrayLength"},Ops.Ui.VizArrayTable=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inArray("Array"),n=e.inInt("Start Row",0);function r(e){let t="";if("string"==typeof e)t='"'+e+'"';else if(CABLES.UTILS.isNumeric(e))t=String(Math.round(1e4*e)/1e4);else if(Array.isArray(e)){let n="...";0==e.length&&(n=""),t="["+n+"] ("+e.length+")"}else if("object"==typeof e)try{t=JSON.stringify(e,!0,1)}catch(e){t="{???}"}else t+=String(e);return t}e.setUiAttrib({height:200,width:400,resizable:!0}),e.renderVizLayer=(o,i)=>{o.fillStyle="#222",o.fillRect(i.x,i.y,i.width,i.height),o.save(),o.scale(i.scale,i.scale),o.font="normal 10px sourceCodePro",o.fillStyle="#ccc";const a=t.get()||[];let s=1;null===t.get()?e.setUiAttrib({extendTitle:"null"}):void 0===t.get()?e.setUiAttrib({extendTitle:"undefined"}):e.setUiAttrib({extendTitle:"length: "+a.length}),t.links.length>0&&t.links[0].getOtherPort(t)&&(s=t.links[0].getOtherPort(t).uiAttribs.stride||1);let l=Math.floor(i.height/i.scale/10-1),g=n.get()*s,c=[];for(let e=0;e<s;e++)c[e]=0;for(let e=g;e<g+l*s;e+=s)for(let t=0;t<s;t++){const n=a[e+t];c[t]=Math.max(c[t],r(n).length)}let u=[],p=30;for(let e=0;e<s;e++)u[e]=p,p+=7*(c[e]+1);for(let e=g;e<g+l*s;e+=s){if(e<0)continue;if(e+s>a.length)continue;o.fillStyle="#666";const t=e/s;t>=0&&o.fillText(t,i.x/i.scale+4,i.y/i.scale+10+(e-g)/s*10+4);for(let t=0;t<s;t++){const n=a[e+t];let l=r(n);o.fillStyle="#ccc","string"==typeof n||(CABLES.UTILS.isNumeric(n)?l=String(Math.round(1e4*n)/1e4):Array.isArray(n)||"object"==typeof n||n==n&&void 0!==n||(o.fillStyle="#f00")),o.fillText(l,i.x/i.scale+u[t],i.y/i.scale+10+(e-g)/s*10+4)}}null===t.get()?o.fillText("null",i.x/i.scale+10,i.y/i.scale+10+4):void 0===t.get()&&o.fillText("undefined",i.x/i.scale+10,i.y/i.scale+10+4);const f=30;if(!(i.scale<=0)){if(g>0){const e=o.createLinearGradient(0,i.y/i.scale+5,0,i.y/i.scale+f);e.addColorStop(0,"#222"),e.addColorStop(1,"rgba(34,34,34,0.0)"),o.fillStyle=e,o.fillRect(i.x/i.scale,i.y/i.scale,2e5,f)}if(g+l*s<a.length){const e=o.createLinearGradient(0,i.y/i.scale+i.height/i.scale-f+5,0,i.y/i.scale+i.height/i.scale-f+f);e.addColorStop(1,"#222"),e.addColorStop(0,"rgba(34,34,34,0.0)"),o.fillStyle=e,o.fillRect(i.x/i.scale,i.y/i.scale+i.height/i.scale-f,2e5,f)}o.restore()}}},Ops.Ui.VizArrayTable.prototype=new CABLES.Op,CABLES.OPS["af2eeaaf-ff86-4bfb-9a27-42f05160a5d8"]={f:Ops.Ui.VizArrayTable,objName:"Ops.Ui.VizArrayTable"},Ops.Devices.Mobile.Pinch=function(){CABLES.Op.apply(this,arguments);const e=this,t="glcanvas",n=1,r=e.inValueBool("Enabled",!0),o=e.inValue("Min Scale",0),i=e.inValue("Max Scale",4),a=e.inTriggerButton("Reset Scale"),s=e.inBool("Limit",!0);let l=n,g=n,c=!1;const u=document.getElementById(t),p=new Hammer(u);p.get("pinch").set({enable:!0});const f=e.outNumber("Scale",1),h=(e.outObject("Event Details"),e.outNumber("Delta"));function d(e){let t=e;return s.get()&&(e<o.get()?t=o.get():e>i.get()&&(t=i.get())),t}function m(){l=n,f.set(l)}window.addEventListener("gesturestart",(e=>e.preventDefault())),window.addEventListener("gesturechange",(e=>e.preventDefault())),window.addEventListener("gestureend",(e=>e.preventDefault())),p.on("pinch",(function(t){if(e.log(t.additionalEvent),t.preventDefault(),!r.get())return;g=t.scale,c=!0;const o=l;h.set(0),t.isFinal?(l*=g,l=d(l),f.set(l),c=!1,e.log("Final Pinch detected, resetting"),g=n):f.set(d(l*g));let i=o-f.get();i<0?i=-1:i>0&&(i=1),h.set(i)})),u.addEventListener("touchend",(function(t){e.log("touchend"),c&&(e.log("touchend, setting manually"),t.preventDefault(),t.stopPropagation(),c=!1,l*=g,l=d(l),g=n,f.set(l))})),a.onTriggered=m},Ops.Devices.Mobile.Pinch.prototype=new CABLES.Op,CABLES.OPS["98e19e37-88ca-4c07-bed7-a050dac31e3a"]={f:Ops.Devices.Mobile.Pinch,objName:"Ops.Devices.Mobile.Pinch"},Ops.Anim.Snap=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inValue("Delta"),n=e.inArray("Snap at Values"),r=e.inValue("Snap Distance"),o=e.inValue("Snap Distance Release"),i=e.inValue("Slowdown",.4),a=e.inValue("Block Input after snap"),s=e.inTriggerButton("Reset"),l=e.inValue("Min",0),g=e.inValue("Max",0),c=e.inValue("Value Mul",1),u=e.inValueBool("Enabled",!0),p=e.outNumber("Result"),f=e.outNumber("Distance"),h=e.outBoolNum("Snapped"),d=e.outBoolNum("was snapped");t.onChange=T,t.changeAlways=!0;let m=!1,C=0,S=!1,O=0,x=!1,b=-1,E=[];function A(){let t=n.get();if(!t||0==t.length)return e.setUiError("snapsnull","needs array containing snap points"),void(S=!0);S&&(e.setUiError("snapsnull",null),S=!1,setTimeout(T,500)),E=[];for(let e=0;e<n.length;e++)E[e]=!1}function T(){if(x)return;let e=n.get(),s=999999999,S=0,A=-1;for(let t=0;t<e.length;t++){let n=Math.abs(C-e[t])+.01;n<s&&(s=n,S=e[t],A=t),C>e[t]&&!E[t]&&(C=e[t],s=0,A=t)}if(0===s)return;if(0===t.get())return;if(s<o.get()){let e=t.get()*Math.abs(s/o.get()*i.get())*c.get();C+=e,clearTimeout(O),O=setTimeout((function(){C=S,p.set(C)}),250)}else clearTimeout(O),C+=t.get();u.get()||(p.set(C),b=C),t.set(0),s=Math.abs(C-S),f.set(s);let T=!1;s>r.get()&&(m=!1,T=!1),m||(s<r.get()?(C=S,a.get()>0&&(x=!0,setTimeout((function(){x=!1}),1e3*a.get())),E[A]=!0,m=!0,T=!0):m=!1),h.set(m),d.set(T),g.get()!=l.get()!=0&&(C>g.get()?C=g.get():C<l.get()&&(C=l.get())),p.set(C),b=C}n.onChange=A,s.onTriggered=function(){C=0,p.set(C)}},Ops.Anim.Snap.prototype=new CABLES.Op,CABLES.OPS["7319d30d-bce2-4e66-8143-e4c0ff5a37a2"]={f:Ops.Anim.Snap,objName:"Ops.Anim.Snap"},Ops.Array.StringToArray_v2=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inStringEditor("text","1,2,3"),n=e.inString("separator",","),r=e.inValueBool("Numbers",!0),o=e.inValueBool("Trim",!0),i=e.inBool("Split Lines",!1),a=e.outTrigger("Parsed"),s=e.outArray("array"),l=e.outNumber("length");function g(){if(!t.get())return s.set(null),s.set([]),void l.set(0);let g,c=t.get();o.get()&&c&&(c=c.replace(/^\s+|\s+$/g,""),c=c.trim());let u=n.get();if("\\n"===n.get()&&(u="\n"),g=i.get()?c.split("\n"):c.split(u),""===g[g.length-1]&&(g.length-=1),l.set(g.length),o.get())for(let e=0;e<g.length;e++)g[e]=g[e].replace(/^\s+|\s+$/g,""),g[e]=g[e].trim();if(e.setUiError("notnum",null),r.get()){let t=!1;for(let e=0;e<g.length;e++)g[e]=Number(g[e]),CABLES.UTILS.isNumeric(g[e])||(t=!0);t&&e.setUiError("notnum","Parse Error / Not all values numerical!")}s.setRef(g),a.trigger()}t.setUiAttribs({ignoreBigPort:!0}),t.onChange=n.onChange=r.onChange=o.onChange=g,i.onChange=()=>{n.setUiAttribs({greyout:i.get()}),g()},g()},Ops.Array.StringToArray_v2.prototype=new CABLES.Op,CABLES.OPS["c974de41-4ce4-4432-b94d-724741109c71"]={f:Ops.Array.StringToArray_v2,objName:"Ops.Array.StringToArray_v2"},Ops.Devices.Mouse.MouseWheel_v2=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inValue("Speed",1),n=e.inValueBool("prevent scroll",!0),r=e.inValueBool("Flip Direction"),o=e.inBool("Simple Delta",!0),i=e.inSwitch("Area",["Canvas","Document","Parent"],"Document"),a=e.inValueBool("active",!0),s=e.outNumber("delta",0),l=e.outNumber("delta X",0),g=e.outNumber("browser event delta",0),c=e.outTrigger("Wheel Action"),u=e.patch.cgl;CABLES.now();let p=1,f=null;i.onChange=O,x(),window.chrome;const h=window.navigator;function d(e){let t=0;return"detail"in e&&(t=e.detail),"deltaY"in e&&(t=e.deltaY,e.deltaY>20?t=20:e.deltaY<-20&&(t=-20)),t*p}function m(e){let t=0;return"deltaX"in e&&(t=e.deltaX,e.deltaX>20?t=20:e.deltaX<-20&&(t=-20)),t}h.vendor,h.userAgent.indexOf("OPR"),h.userAgent.indexOf("Edge"),h.userAgent.match("CriOS"),window.navigator.userAgent.indexOf("Windows"),window.navigator.userAgent.indexOf("Linux"),window.navigator.userAgent.indexOf("Mac"),navigator.userAgent.search("Firefox"),r.onChange=function(){p=r.get()?-1:1};let C=0;function S(e){if(!(Date.now()-C<10)){if(C=Date.now(),g.set(e.wheelDelta||e.deltaY),e.deltaY){let n=d(e);o.get()?n=n>0?t.get():-t.get():n*=.01*t.get(),s.set(0),s.set(n)}if(e.deltaX){let n=m(e);n*=.01*t.get(),l.set(0),l.set(n)}n.get()&&e.preventDefault(),c.trigger()}}function O(){b(),"Document"==i.get()&&(f=document),f="Parent"==i.get()?u.canvas.parentElement:u.canvas,a.get()&&x()}function x(){f||O(),f.addEventListener("wheel",S,{passive:!1})}function b(){f&&f.removeEventListener("wheel",S)}a.onChange=function(){O()}},Ops.Devices.Mouse.MouseWheel_v2.prototype=new CABLES.Op,CABLES.OPS["7b9626db-536b-4bb4-85c3-95401bc60d1b"]={f:Ops.Devices.Mouse.MouseWheel_v2,objName:"Ops.Devices.Mouse.MouseWheel_v2"},Ops.Ui.Comment_v2=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inString("title","New comment"),n=e.inTextarea("text");function r(){CABLES.UI&&(e.uiAttr({comment_title:t.get(),comment_text:n.get()}),e.name=t.get())}t.setUiAttribs({hidePort:!0}),n.setUiAttribs({hidePort:!0}),e.init=t.onChange=n.onChange=e.onLoaded=r,r()},Ops.Ui.Comment_v2.prototype=new CABLES.Op,CABLES.OPS["93492eeb-bf35-4a62-98f7-d85b0b79bfe5"]={f:Ops.Ui.Comment_v2,objName:"Ops.Ui.Comment_v2"},Ops.Value.GateNumber=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inValue("Value In",0),n=e.inValueBool("Pass Through"),r=e.outNumber("Value Out");function o(){n.get()&&r.set(t.get())}t.onChange=o,n.onChange=o,t.changeAlways=!0,r.changeAlways=!0},Ops.Value.GateNumber.prototype=new CABLES.Op,CABLES.OPS["594105c8-1fdb-4f3c-bbd5-29b9ad6b33e0"]={f:Ops.Value.GateNumber,objName:"Ops.Value.GateNumber"},Ops.Extension.FxHash.FxHash=function(){CABLES.Op.apply(this,arguments);const e=this;(!CABLES.fakefxhash&&!window.fxhash||CABLES.fakefxhash)&&(CABLES.fakefxhash=!0);const t=!CABLES.fakefxhash,n="123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ",r=e.inString("Hash",""),o=e.inTriggerButton("Randomize Hash"),i=e.outString("fxhash"),a=e.outNumber("fxrand 1"),s=e.outNumber("fxrand 2"),l=e.outNumber("fxrand 3"),g=e.outNumber("fxrand 4"),c=e.outArray("Random Numbers");e.outBoolNum("fxhash environment",t),r.onChange=f;let u=!1;function p(){let e="";const t=n.length-1;for(let r=0;r<51;r++)e+=n[Math.round(Math.random()*t)];return e}function f(){if(t&&u)return;if(!t){window.fxhash=r.get()||p();let e=e=>[...e].reduce(((e,t)=>e*n.length+n.indexOf(t)|0),0),t=fxhash.slice(2),o=new RegExp(".{"+(fxhash.length/4|0)+"}","g"),i=t.match(o).map((t=>e(t))),a=(e,t,n,r)=>()=>{let o=((e|=0)+(t|=0)|0)+(r|=0)|0;return r=r+1|0,e=t^t>>>9,t=(n|=0)+(n<<3)|0,n=(n=n<<21|n>>>11)+o|0,(o>>>0)/4294967296};window.fxrand=a(...i)}u=!0,i.set(window.fxhash),a.set(0),s.set(0),l.set(0),g.set(0),a.set(fxrand()),s.set(fxrand()),l.set(fxrand()),g.set(fxrand());const e=[];for(let t=0;t<1e3;t++)e.push(fxrand());c.set(e)}f(),o.onTriggered=()=>{r.set(p()),e.refreshParams()}},Ops.Extension.FxHash.FxHash.prototype=new CABLES.Op,CABLES.OPS["090355fe-6ad9-457c-8192-9e306a9fe1eb"]={f:Ops.Extension.FxHash.FxHash,objName:"Ops.Extension.FxHash.FxHash"},Ops.String.StringCompose_v3=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inString("Format","hello $a, $b $c und $d"),n=e.inString("String A","world"),r=e.inString("String B",1),o=e.inString("String C",2),i=e.inString("String D",3),a=e.inString("String E"),s=e.inString("String F"),l=e.outString("Result");function g(){var e=t.get()||"";"string"!=typeof e&&(e=""),e=(e=(e=(e=(e=(e=e.replace(/\$a/g,n.get())).replace(/\$b/g,r.get())).replace(/\$c/g,o.get())).replace(/\$d/g,i.get())).replace(/\$e/g,a.get())).replace(/\$f/g,s.get()),l.set(e)}t.onChange=n.onChange=r.onChange=o.onChange=i.onChange=a.onChange=s.onChange=g,g()},Ops.String.StringCompose_v3.prototype=new CABLES.Op,CABLES.OPS["6afea9f4-728d-4f3c-9e75-62ddc1448bf0"]={f:Ops.String.StringCompose_v3,objName:"Ops.String.StringCompose_v3"},Ops.Vars.VarSetString_v2=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inString("Value","New String");e.varName=e.inDropDown("Variable",[],"",!0),new CABLES.VarSetOpWrapper(e,"string",t,e.varName)},Ops.Vars.VarSetString_v2.prototype=new CABLES.Op,CABLES.OPS["0b4d9229-8024-4a30-9cc0-f6653942c2e4"]={f:Ops.Vars.VarSetString_v2,objName:"Ops.Vars.VarSetString_v2"},Ops.Array.ArrayGetTexture=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inArray("array"),n=e.inValueInt("index"),r=e.outTexture("value");let o=null;t.ignoreValueSerialize=!0,r.ignoreValueSerialize=!0,n.onChange=a,t.onChange=a,e.toWorkPortsNeedToBeLinked(t,r);const i=CGL.Texture.getEmptyTexture(e.patch.cgl);function a(){if(n.get()<0)return void r.set(i);let e=t.get();if(!e)return void r.set(i);let a=n.get();a>=e.length?r.set(i):e[a]&&(r.set(i),r.set(e[a]),o=e[a])}},Ops.Array.ArrayGetTexture.prototype=new CABLES.Op,CABLES.OPS["afea522b-ab72-4574-b721-5d37f5abaf77"]={f:Ops.Array.ArrayGetTexture,objName:"Ops.Array.ArrayGetTexture"},Ops.Vars.VarSetArray_v2=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inArray("Value",null);e.varName=e.inDropDown("Variable",[],"",!0),new CABLES.VarSetOpWrapper(e,"array",t,e.varName)},Ops.Vars.VarSetArray_v2.prototype=new CABLES.Op,CABLES.OPS["8088290f-45d4-4312-b4ca-184d34ca4667"]={f:Ops.Vars.VarSetArray_v2,objName:"Ops.Vars.VarSetArray_v2"},Ops.Math.Floor=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inValue("Number"),n=e.outNumber("Result");function r(){n.set(Math.floor(t.get()))}t.onChange=r},Ops.Math.Floor.prototype=new CABLES.Op,CABLES.OPS["0c77617c-b688-4b55-addf-2cbcaabf98af"]={f:Ops.Math.Floor,objName:"Ops.Math.Floor"},Ops.Vars.VarGetArray_v2=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.outArray("Value");e.varName=e.inValueSelect("Variable",[],"",!0),new CABLES.VarGetOpWrapper(e,"array",e.varName,t)},Ops.Vars.VarGetArray_v2.prototype=new CABLES.Op,CABLES.OPS["afa79294-aa9c-43bc-a49a-cade000a1de5"]={f:Ops.Vars.VarGetArray_v2,objName:"Ops.Vars.VarGetArray_v2"},Ops.Array.ArrayGetNumber=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inArray("array"),n=e.inValueInt("index"),r=e.outNumber("value");function o(){if(t.get()){let e=t.get()[n.get()];if(isNaN(e))return void r.set(0);r.set(parseFloat(e))}}t.ignoreValueSerialize=!0,n.onChange=t.onChange=o},Ops.Array.ArrayGetNumber.prototype=new CABLES.Op,CABLES.OPS["d1189078-70cf-437d-9a37-b2ebe89acdaf"]={f:Ops.Array.ArrayGetNumber,objName:"Ops.Array.ArrayGetNumber"},Ops.String.StringEditor=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inStringEditor("value",""),n=e.inValueSelect("Syntax",["text","glsl","css","html","xml","json","javascript","inline-css","sql"],"text"),r=e.outString("Result");function o(){let e=n.get();"javascript"==e&&(e="js"),t.setUiAttribs({editorSyntax:e})}n.onChange=o,t.onChange=function(){r.set(t.get())}},Ops.String.StringEditor.prototype=new CABLES.Op,CABLES.OPS["6468b7c1-f63e-4db4-b809-4b203d27ead3"]={f:Ops.String.StringEditor,objName:"Ops.String.StringEditor"},Ops.Array.ArraySumPrevious=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inArray("Array"),n=e.inFloat("Padding",0),r=e.outArray("Result"),o=[];n.onChange=t.onChange=()=>{r.set(null);let e=t.get();if(e&&!(e.length<1)){o.length=e.length,o[0]=e[0];for(let t=1;t<e.length;t++)o[t]=o[t-1]+e[t]+n.get();r.set(o)}}},Ops.Array.ArraySumPrevious.prototype=new CABLES.Op,CABLES.OPS["71494407-e618-425f-890b-dcf6c3d46cf1"]={f:Ops.Array.ArraySumPrevious,objName:"Ops.Array.ArraySumPrevious"},Ops.Array.MapRangeArray=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inArray("array"),n=e.inValueFloat("old min"),r=e.inValueFloat("old max"),o=e.inValueFloat("new min"),i=e.inValueFloat("new max"),a=e.inValueSelect("Easing",["Linear","Smoothstep","Smootherstep"],"Linear"),s=e.outArray("result");e.setPortGroup("Input Range",[n,r]),e.setPortGroup("Output Range",[o,i]);let l=0,g=0;a.onChange=function(){l="Smoothstep"===a.get()?1:"Smootherstep"===a.get()?2:0,u()};let c=Array(1);function u(){const e=t.get();if(e&&0!==e.length){c.length=e.length;for(let t=0;t<e.length;t++){let a=e[t];if(a>=Math.max(r.get(),n.get()))c[t]=i.get();else if(a<=Math.min(r.get(),n.get()))c[t]=o.get();else{const e=o.get(),s=i.get(),u=n.get(),p=r.get();let f=!1;const h=Math.min(u,p),d=Math.max(u,p);h!==u&&(f=!0);let m=!1;const C=Math.min(e,s),S=Math.max(e,s);C!==e&&(m=!0);let O=0;O=f?(d-a)*(S-C)/(d-h):(a-h)*(S-C)/(d-h),g=m?S-O:O+C,0===l?c[t]=g:1===l?(a=Math.max(0,Math.min(1,(g-e)/(s-e))),c[t]=e+a*a*(3-2*a)*(s-e)):2===l&&(a=Math.max(0,Math.min(1,(g-e)/(s-e))),c[t]=e+a*a*a*(a*(6*a-15)+10)*(s-e))}}s.setRef(c)}else s.set([])}t.set(null),n.set(0),r.set(1),o.set(-1),i.set(1),t.onChange=u,n.onChange=u,r.onChange=u,o.onChange=u,i.onChange=u,s.set(null),u()},Ops.Array.MapRangeArray.prototype=new CABLES.Op,CABLES.OPS["20f921bf-adc2-45fb-b387-834af4f5e19b"]={f:Ops.Array.MapRangeArray,objName:"Ops.Array.MapRangeArray"},Ops.Math.Subtract=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inValue("number1",1),n=e.inValue("number2",1),r=e.outNumber("result");function o(){let e=t.get()-n.get();isNaN(e)||r.set(e)}e.setTitle("-"),t.onChange=n.onChange=o,o()},Ops.Math.Subtract.prototype=new CABLES.Op,CABLES.OPS["a4ffe852-d200-4b96-9347-68feb01122ca"]={f:Ops.Math.Subtract,objName:"Ops.Math.Subtract"},Ops.Array.ArrayIndexBetween=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inArray("Array"),n=e.inFloat("Value",0),r=e.outNumber("Index");function o(){const e=t.get();if(!e)return void r.set(-1);const o=n.get();if(o<e[0])return r.set(0);for(let t=0;t<e.length-1;t++)if(o>e[t]&&o<e[t+1])return void r.set(t+1)}t.onChange=n.onChange=o},Ops.Array.ArrayIndexBetween.prototype=new CABLES.Op,CABLES.OPS["69faf293-140d-4a2c-ab2e-7e5577ab113d"]={f:Ops.Array.ArrayIndexBetween,objName:"Ops.Array.ArrayIndexBetween"},Ops.Math.Modulo=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inValueFloat("number1",1),n=e.inValueFloat("number2",2),r=e.inValueBool("pingpong"),o=e.outNumber("result");let i=s;function a(){let e=n.get(),r=t.get();o.set(i(r,e))}function s(e,t){let n=(e%t+t)%t;return n!=n&&(n=0),n}function l(e,t){let n=2*t;return(e%=n)>=t?n-e:e}function g(){i=r.get()?l:s}t.onChange=n.onChange=a,r.onChange=g,a()},Ops.Math.Modulo.prototype=new CABLES.Op,CABLES.OPS["ebc13b25-3705-4265-8f06-5f985b6a7bb1"]={f:Ops.Math.Modulo,objName:"Ops.Math.Modulo"},Ops.Value.ValueChangedTrigger=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inFloat("Value",0),n=e.inTrigger("Execute"),r=e.outTrigger("trigger");let o=!1;n.onTriggered=function(){o&&(o=!1,r.trigger())},t.onChange=function(){o=!0}},Ops.Value.ValueChangedTrigger.prototype=new CABLES.Op,CABLES.OPS["9f353fcc-da0b-4af8-ae5c-4edd256fc9e3"]={f:Ops.Value.ValueChangedTrigger,objName:"Ops.Value.ValueChangedTrigger"},Ops.Array.RotateArray=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inArray("Array in"),n=e.inValueInt("Rotate amount",0),r=e.outArray("ArrayOut");let o=[];function i(e,t,n){let r,o;return t=null===t||n?1:t,t%=e.length,o=e.slice(t)||[],o&&o.concat?(r=e.slice(0,t)||[],o.concat(r)):[]}r.set(o),n.onChange=t.onChange=function(){if(!t.get())return;let e=-n.get();o=i(t.get(),e,0),r.set(null),r.set(o)}},Ops.Array.RotateArray.prototype=new CABLES.Op,CABLES.OPS["e435d07b-8545-4469-befb-868510adcb76"]={f:Ops.Array.RotateArray,objName:"Ops.Array.RotateArray"},Ops.Array.ArraySum=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inArray("In"),n=e.inValue("Value",1),r=e.outArray("Result");let o=[];r.set(o),n.onChange=t.onChange=function(){let e=t.get();if(!e)return;let i=n.get();o.length!=e.length&&(o.length=e.length);for(let t=0;t<e.length;t++)o[t]=e[t]+i;r.setRef(o)}},Ops.Array.ArraySum.prototype=new CABLES.Op,CABLES.OPS["c6b5bf63-0be8-4eea-acc0-9d32973e665a"]={f:Ops.Array.ArraySum,objName:"Ops.Array.ArraySum"},Ops.Math.Clamp=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inValueFloat("val",.5),n=e.inValueFloat("min",0),r=e.inValueFloat("max",1),o=e.inValueBool("ignore outside values"),i=e.outNumber("result");function a(){if(o.get()){if(t.get()>r.get())return;if(t.get()<n.get())return}i.set(Math.min(Math.max(t.get(),n.get()),r.get()))}t.onChange=n.onChange=r.onChange=a},Ops.Math.Clamp.prototype=new CABLES.Op,CABLES.OPS["cda1a98e-5e16-40bd-9b18-a67e9eaad5a1"]={f:Ops.Math.Clamp,objName:"Ops.Math.Clamp"},Ops.Math.Compare.LessThan=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inValue("number1"),n=e.inValue("number2"),r=e.outBoolNum("result");function o(){r.set(t.get()<n.get())}e.setTitle("<"),t.onChange=o,n.onChange=o,o()},Ops.Math.Compare.LessThan.prototype=new CABLES.Op,CABLES.OPS["04fd113f-ade1-43fb-99fa-f8825f8814c0"]={f:Ops.Math.Compare.LessThan,objName:"Ops.Math.Compare.LessThan"},Ops.Trigger.GateTrigger=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inTrigger("Execute"),n=e.inValueBool("Pass Through",!0),r=e.outTrigger("Trigger out");t.onTriggered=function(){n.get()&&r.trigger()}},Ops.Trigger.GateTrigger.prototype=new CABLES.Op,CABLES.OPS["65e8b8a2-ba13-485f-883a-2bcf377989da"]={f:Ops.Trigger.GateTrigger,objName:"Ops.Trigger.GateTrigger"},Ops.Math.OneMinus=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inValue("Value"),n=e.outNumber("Result");function r(){n.set(1-t.get())}t.onChange=r,r()},Ops.Math.OneMinus.prototype=new CABLES.Op,CABLES.OPS["f34d019d-59ae-40d6-a55d-a7691bbc40e0"]={f:Ops.Math.OneMinus,objName:"Ops.Math.OneMinus"},Ops.Math.Pow=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inValueFloat("Base"),n=e.inValueFloat("Exponent"),r=e.outNumber("Result");function o(){let e=Math.pow(t.get(),n.get());isNaN(e)&&(e=0),r.set(e)}n.set(2),t.onChange=o,n.onChange=o},Ops.Math.Pow.prototype=new CABLES.Op,CABLES.OPS["3bb3f98f-27d6-44c4-b4e5-186e10f0809d"]={f:Ops.Math.Pow,objName:"Ops.Math.Pow"},Ops.Math.Compare.Equals=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inValue("number1",1),n=e.inValue("number2",1),r=e.outBoolNum("result");function o(){r.set(t.get()==n.get())}t.onChange=n.onChange=o,o()},Ops.Math.Compare.Equals.prototype=new CABLES.Op,CABLES.OPS["4dd3cc55-eebc-4187-9d4e-2e053a956fab"]={f:Ops.Math.Compare.Equals,objName:"Ops.Math.Compare.Equals"},Ops.Trigger.TriggerIfDecreased=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inValue("Value"),n=e.outTrigger("Trigger");let r=-Number.MAX_VALUE;t.onChange=function(){const e=t.get();e<r&&n.trigger(),r=e}},Ops.Trigger.TriggerIfDecreased.prototype=new CABLES.Op,CABLES.OPS["16ec4069-3682-461e-95ff-1d86e3f44512"]={f:Ops.Trigger.TriggerIfDecreased,objName:"Ops.Trigger.TriggerIfDecreased"},Ops.Array.ArrayIndexMinMax=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inArray("Array"),n=e.outNumber("Max"),r=e.outNumber("Index Max"),o=e.outNumber("Min"),i=e.outNumber("Index Min");t.onChange=n.onChange=r.onChange=o.onChange=i.onChange=()=>{const e=t.get();if(!e)return n.set(0),void o.set(0);let a=Number.MAX_VALUE,s=-Number.MAX_VALUE,l=-1,g=-1;for(let t=0;t<e.length;t++)e[t]<a&&(l=t,a=e[t]),e[t]>s&&(g=t,s=e[t]);n.set(s),r.set(g),o.set(a),i.set(l)}},Ops.Array.ArrayIndexMinMax.prototype=new CABLES.Op,CABLES.OPS["240172a6-7dde-4dcc-b862-bbe764aec3f3"]={f:Ops.Array.ArrayIndexMinMax,objName:"Ops.Array.ArrayIndexMinMax"},Ops.Math.MathExpression=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inFloat("A",0),n=e.inFloat("B",1),r=e.inFloat("C",2),o=e.inFloat("D",3);e.setPortGroup("Parameters",[t,n,r,o]);const i=e.inString("Expression","a*(b+c+d)");e.setPortGroup("Expression",[i]);const a=e.outNumber("Result"),s=e.outBool("Expression Valid");let l=i.get(),g=!1;const c=()=>{try{l=new Function("m","a","b","c","d",`with(m) { return ${i.get()} }`),g=!0,u(),s.set(g)}catch(e){if(g=!1,s.set(g),e instanceof ReferenceError||e instanceof SyntaxError)return}},u=()=>{g&&(a.set(l(Math,t.get(),n.get(),r.get(),o.get())),i.get()||a.set(0)),s.set(g)};t.onChange=n.onChange=r.onChange=o.onChange=u,i.onChange=c,c()},Ops.Math.MathExpression.prototype=new CABLES.Op,CABLES.OPS["d2343a1e-64ea-45b2-99ed-46e167bbdcd3"]={f:Ops.Math.MathExpression,objName:"Ops.Math.MathExpression"},Ops.Gl.Textures.CopyTexture_v2=function(){CABLES.Op.apply(this,arguments);const e=this,t={copytexture_frag:"UNI float a;\nUNI sampler2D tex;\n\n#ifdef TEX_MASK\nUNI sampler2D texMask;\n#endif\n\nIN vec2 texCoord;\n\nvoid main()\n{\n    vec4 col=texture(tex,texCoord);\n\n    #ifdef TEX_MASK\n        col.a=texture(texMask,texCoord).r;\n    #endif\n\n\n    #ifdef GREY_R\n        col.rgb=vec3(col.r);\n    #endif\n\n    #ifdef GREY_G\n        col.rgb=vec3(col.g);\n    #endif\n\n    #ifdef GREY_B\n        col.rgb=vec3(col.b);\n    #endif\n\n    #ifdef GREY_A\n        col.rgb=vec3(col.a);\n    #endif\n\n    #ifdef GREY_LUMI\n        col.rgb=vec3( dot(vec3(0.2126,0.7152,0.0722), col.rgb) );\n    #endif\n\n\n    #ifdef INVERT_A\n        col.a=1.0-col.a;\n    #endif\n\n    #ifdef INVERT_R\n        col.r=1.0-col.r;\n    #endif\n\n    #ifdef INVERT_G\n        col.g=1.0-col.g;\n    #endif\n\n    #ifdef INVERT_B\n        col.b=1.0-col.b;\n    #endif\n\n    #ifdef ALPHA_1\n        col.a=1.0;\n    #endif\n\n\n\n\n    outColor= col;\n}"},n=e.inTriggerButton("render"),r=e.inTexture("Texture"),o=e.inTexture("Alpha Mask"),i=e.inValueBool("use original size",!0),a=e.inValueInt("width",640),s=e.inValueInt("height",360),l=e.inSwitch("filter",["nearest","linear","mipmap"],"linear"),g=e.inValueSelect("wrap",["clamp to edge","repeat","mirrored repeat"],"clamp to edge"),c=e.inValueBool("HDR"),u=e.inSwitch("Alpha Mask Source",["A","1"],"A"),p=e.inSwitch("Convert Greyscale",["Off","R","G","B","A","Luminance"],"Off"),f=e.inBool("Invert R",!1),h=e.inBool("Invert G",!1),d=e.inBool("Invert B",!1),m=e.inBool("Invert A",!1),C=e.outTrigger("trigger"),S=e.outTexture("texture_out",null),O=e.outNumber("Aspect Ratio");u.setUiAttribs({hidePort:!0}),p.setUiAttribs({hidePort:!0}),f.setUiAttribs({hidePort:!0}),h.setUiAttribs({hidePort:!0}),d.setUiAttribs({hidePort:!0});const x=e.patch.cgl;let b=null,E=null,A=null,T=!0,y=null,L=2,v=2;const B=[0,0,0,0];let w=!0;e.toWorkPortsNeedToBeLinked(n,r),e.setPortGroup("Size",[i,a,s]);const P=new CGL.Shader(x,"copytexture");P.setSource(P.getDefaultVertexShader(),t.copytexture_frag),new CGL.Uniform(P,"t","tex",0),new CGL.Uniform(P,"t","texMask",1);let N=CGL.Texture.FILTER_LINEAR,_=CGL.Texture.WRAP_CLAMP_TO_EDGE;function M(){E&&E.delete(),A&&(A.delete(),A=null),E=new CGL.TextureEffect(x,{isFloatingPointTexture:c.get(),clear:!1}),A&&A.width==Math.floor(a.get())&&A.height==Math.floor(s.get())&&A.wrap==_&&A.isFloatingPoint()==c.get()||(A&&A.delete(),A=new CGL.Texture(x,{name:"copytexture_"+e.id,isFloatingPointTexture:c.get(),filter:N,wrap:_,width:Math.floor(a.get()),height:Math.floor(s.get())})),E.setSourceTexture(A),w=!1}function V(){U(),w=!0,n.isLinked()&&r.isLinked()||S.set(CGL.Texture.getEmptyTexture(x))}function G(){r.get()&&r.get()!=CGL.Texture.getEmptyTexture(x)&&(E||M(),i.get()?(L=r.get().width,v=r.get().height):(L=Math.floor(a.get()),v=Math.floor(s.get())),L==A.width&&v==A.height||0===L||0===v||(s.set(v),a.set(L),A.filter=N,A.setSize(L,v),O.set(L/v),E.setSourceTexture(A)),T=!1)}function F(){a.setUiAttribs({greyout:i.get()}),s.setUiAttribs({greyout:i.get()})}function I(){T=!0,V()}function R(){if(r.get()&&r.get()!=CGL.Texture.getEmptyTexture(x)||S.set(CGL.Texture.getEmptyTexture(x)),!r.get()||r.get()==CGL.Texture.getEmptyTexture(x))return b=null,void C.trigger();E&&!w&&b==r.get()||M();const e=x.getViewPort();B[0]=e[0],B[1]=e[1],B[2]=e[2],B[3]=e[3],G(),b=r.get();const t=x.currentTextureEffect;x.currentTextureEffect=E,E.setSourceTexture(A),E.startEffect(),x.pushShader(P),x.currentTextureEffect.bind(),x.setTexture(0,r.get().tex),o.get()&&x.setTexture(1,o.get().tex),x.pushBlend(!1),x.currentTextureEffect.finish(),x.popShader(),x.popBlend(),S.set(E.getCurrentSourceTexture()),E.endEffect(),x.setViewPort(B[0],B[1],B[2],B[3]),x.currentTextureEffect=t,x.setTexture(0,CGL.Texture.getEmptyTexture(x).tex),C.trigger()}function U(){P.toggleDefine("TEX_MASK",o.get()),P.toggleDefine("GREY_R","R"===p.get()),P.toggleDefine("GREY_G","G"===p.get()),P.toggleDefine("GREY_B","B"===p.get()),P.toggleDefine("GREY_A","A"===p.get()),P.toggleDefine("GREY_LUMI","Luminance"===p.get()),P.toggleDefine("ALPHA_1","1"===u.get()),P.toggleDefine("ALPHA_A","A"===u.get()),P.toggleDefine("INVERT_R",f.get()),P.toggleDefine("INVERT_G",h.get()),P.toggleDefine("INVERT_B",d.get()),P.toggleDefine("INVERT_A",m.get()),"repeat"==g.get()?_=CGL.Texture.WRAP_REPEAT:"mirrored repeat"==g.get()?_=CGL.Texture.WRAP_MIRRORED_REPEAT:"clamp to edge"==g.get()&&(_=CGL.Texture.WRAP_CLAMP_TO_EDGE),"nearest"==l.get()?N=CGL.Texture.FILTER_NEAREST:"linear"==l.get()?N=CGL.Texture.FILTER_LINEAR:"mipmap"==l.get()&&(N=CGL.Texture.FILTER_MIPMAP),P.needsRecompile()&&(w=!0),!A||A.width==Math.floor(a.get())&&A.height==Math.floor(s.get())&&A.wrap==_&&A.isFloatingPoint()==c.get()||(w=!0)}u.onChange=()=>{V()},p.onChange=()=>{V()},f.onChange=()=>{V()},h.onChange=()=>{V()},d.onChange=()=>{V()},g.onChange=()=>{V()},l.onChange=()=>{V()},c.onChange=()=>{V()},n.onLinkChanged=()=>{V()},r.onLinkChanged=()=>{V()},r.onChange=()=>{y!=r.get()&&(V(),console.log("redo reason: inTexture")),y=r.get()},o.onChange=()=>{V()},n.onTriggered=R,F(),i.onChange=function(){F(),i.get()?(a.onChange=null,s.onChange=null):(a.onChange=I,s.onChange=I),G()}},Ops.Gl.Textures.CopyTexture_v2.prototype=new CABLES.Op,CABLES.OPS["7a86fd19-571a-48ab-9e37-dd84e9f428e7"]={f:Ops.Gl.Textures.CopyTexture_v2,objName:"Ops.Gl.Textures.CopyTexture_v2"},Ops.Cables.LoadingStatusTask=function(){CABLES.Op.apply(this,arguments);const e=this;let t=[],n=CABLES.uuid(),r=e.inTriggerButton("Start Task"),o=e.inTriggerButton("End Task");function i(){let r=n+" ("+(t.length+1)+")",o=e.patch.loading.start("task",r);CABLES.UI&&gui.jobs().start({id:o,title:"loading task "+r}),t.push(o)}function a(){let n=t.pop();e.patch.loading.finished(n),CABLES.UI&&gui.jobs().finish(n)}r.onTriggered=i,o.onTriggered=a},Ops.Cables.LoadingStatusTask.prototype=new CABLES.Op,CABLES.OPS["38d0f6ba-a4d8-4093-9cab-17e1b5dd52ae"]={f:Ops.Cables.LoadingStatusTask,objName:"Ops.Cables.LoadingStatusTask"},Ops.Cables.LoadingStatus_v2=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inTrigger("exe"),n=e.inValueBool("PreRender Ops"),r=e.inBool("Play Timeline",!0),o=e.outTrigger("Next"),i=e.outBoolNum("Finished Initial Loading",!1),a=e.outBoolNum("Loading"),s=e.outNumber("Progress"),l=e.outArray("Jobs"),g=e.outTrigger("Trigger Loading Finished "),c=e.patch.cgl,u=e.patch;let p=!1,f=!0;document.body.classList.add("cables-loading");let h=c.patch.loading.start("loadingStatusInit","loadingStatusInit",e);t.onTriggered=()=>{const t=e.patch.loading.getListJobs();s.set(u.loading.getProgress());let d=0===t.length;const m=!d;m&&l.set(e.patch.loading.getListJobs()),m?(f&&(n.get()&&e.patch.preRenderOps(),e.patch.timer.setTime(0),r.get()?e.patch.timer.play():e.patch.timer.pause()),f=!1,document.body.classList.remove("cables-loading"),document.body.classList.add("cables-loaded")):(p=!0,l.set(e.patch.loading.getListJobs()),u.loading.getProgress()<1&&(e.patch.timer.setTime(0),e.patch.timer.pause())),i.set(p),a.get()&&d&&g.trigger(),a.set(m),e.setUiAttribs({loading:m}),o.trigger(),h&&(c.patch.loading.finished(h),h=null)}},Ops.Cables.LoadingStatus_v2.prototype=new CABLES.Op,CABLES.OPS["e62f7f4c-7436-437e-8451-6bc3c28545f7"]={f:Ops.Cables.LoadingStatus_v2,objName:"Ops.Cables.LoadingStatus_v2"},Ops.Html.LoadingIndicator=function(){CABLES.Op.apply(this,arguments);const e=this,t={css_ellipsis_css:".lds-ellipsis {\n\n}\n.lds-ellipsis div {\n  position: absolute;\n  /*top: 33px;*/\n  margin-top:-12px;\n  margin-left:-13px;\n  width: 13px;\n  height: 13px;\n  border-radius: 50%;\n  background: #fff;\n  animation-timing-function: cubic-bezier(0, 1, 1, 0);\n}\n.lds-ellipsis div:nth-child(1) {\n  left: 8px;\n  animation: lds-ellipsis1 0.6s infinite;\n}\n.lds-ellipsis div:nth-child(2) {\n  left: 8px;\n  animation: lds-ellipsis2 0.6s infinite;\n}\n.lds-ellipsis div:nth-child(3) {\n  left: 32px;\n  animation: lds-ellipsis2 0.6s infinite;\n}\n.lds-ellipsis div:nth-child(4) {\n  left: 56px;\n  animation: lds-ellipsis3 0.6s infinite;\n}\n@keyframes lds-ellipsis1 {\n  0% {\n    transform: scale(0);\n  }\n  100% {\n    transform: scale(1);\n  }\n}\n@keyframes lds-ellipsis3 {\n  0% {\n    transform: scale(1);\n  }\n  100% {\n    transform: scale(0);\n  }\n}\n@keyframes lds-ellipsis2 {\n  0% {\n    transform: translate(0, 0);\n  }\n  100% {\n    transform: translate(24px, 0);\n  }\n}\n",css_ring_css:".lds-ring {\n}\n.lds-ring div {\n  box-sizing: border-box;\n  display: block;\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  margin: 0;\n  border: 3px solid #fff;\n  border-radius: 50%;\n  animation: lds-ring 1.2s cubic-bezier(0.5, 0, 0.5, 1) infinite;\n  border-color: #fff transparent transparent transparent;\n}\n.lds-ring div:nth-child(1) {\n  animation-delay: -0.45s;\n}\n.lds-ring div:nth-child(2) {\n  animation-delay: -0.3s;\n}\n.lds-ring div:nth-child(3) {\n  animation-delay: -0.15s;\n}\n@keyframes lds-ring {\n  0% {\n    transform: rotate(0deg);\n  }\n  100% {\n    transform: rotate(360deg);\n  }\n}\n",css_spinner_css:"._cables_spinner {\n  /*width: 40px;*/\n  /*height: 40px;*/\n  /*margin: 100px auto;*/\n  background-color: #777;\n\n  border-radius: 100%;\n  -webkit-animation: sk-scaleout 1.0s infinite ease-in-out;\n  animation: sk-scaleout 1.0s infinite ease-in-out;\n}\n\n@-webkit-keyframes sk-scaleout {\n  0% { -webkit-transform: scale(0) }\n  100% {\n    -webkit-transform: scale(1.0);\n    opacity: 0;\n  }\n}\n\n@keyframes sk-scaleout {\n  0% {\n    -webkit-transform: scale(0);\n    transform: scale(0);\n  } 100% {\n    -webkit-transform: scale(1.0);\n    transform: scale(1.0);\n    opacity: 0;\n  }\n}"},n=e.inBool("Visible",!0),r=e.inSwitch("Style",["Spinner","Ring","Ellipsis"],"Ring"),o=document.createElement("div");o.dataset.op=e.id;const i=e.patch.cgl.canvas.parentElement;r.onChange=c,o.appendChild(document.createElement("div")),o.appendChild(document.createElement("div")),o.appendChild(document.createElement("div"));const a=50;o.style.width=a+"px",o.style.height=a+"px",o.style.top="50%",o.style.left="50%",o.style["margin-left"]="-"+a/2+"px",o.style["margin-top"]="-"+a/2+"px",o.style.position="absolute",o.style["z-index"]="9999999",n.onChange=p;let s="css_loadingicon_"+CABLES.uuid();const l=document.createElement("style");l.type="text/css",l.id=s;let g=document.getElementsByTagName("body")[0];function c(){const e=r.get();"Spinner"==e?(o.classList.add("_cables_spinner"),l.textContent=t.css_spinner_css):o.classList.remove("_cables_spinner"),"Ring"==e?(o.classList.add("lds-ring"),l.textContent=t.css_ring_css):o.classList.remove("lds-ring"),"Ellipsis"==e?(o.classList.add("lds-ellipsis"),l.textContent=t.css_ellipsis_css):o.classList.remove("lds-ellipsis")}function u(){o.remove()}function p(){u(),n.get()&&i.appendChild(o)}g.appendChild(l),e.onDelete=()=>{u(),l&&l.remove()},c()},Ops.Html.LoadingIndicator.prototype=new CABLES.Op,CABLES.OPS["e102834c-6dcf-459c-9e22-44ebccfc0d3b"]={f:Ops.Html.LoadingIndicator,objName:"Ops.Html.LoadingIndicator"},Ops.Gl.CanvasInfo=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.outNumber("width"),n=e.outNumber("height"),r=e.inSwitch("Pixel Unit",["Display","CSS"],"Display"),o=e.outNumber("Pixel Ratio"),i=e.outNumber("Aspect Ratio"),a=e.outBool("Landscape"),s=e.outObject("Canvas","element"),l=e.outObject("Canvas Parent","element");let g=e.patch.cgl;function c(){let s=1;"CSS"==r.get()&&(s=e.patch.cgl.pixelDensity),n.set(g.canvasHeight/s),t.set(g.canvasWidth/s),o.set(e.patch.cgl.pixelDensity),i.set(g.canvasWidth/g.canvasHeight),a.set(g.canvasWidth>g.canvasHeight?1:0)}s.set(e.patch.cgl.canvas),l.set(e.patch.cgl.canvas.parentElement),g.on("resize",c),r.onChange=c,c()},Ops.Gl.CanvasInfo.prototype=new CABLES.Op,CABLES.OPS["94e499e5-b4ee-4861-ab48-6ab5098b2cc3"]={f:Ops.Gl.CanvasInfo,objName:"Ops.Gl.CanvasInfo"},Ops.Html.ElementCssTransform=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inObject("Element",null,"element"),n=e.inBool("Translate Active",!0),r=e.inFloat("Translate X",0),o=e.inFloat("Translate Y",0),i=e.inSwitch("Unit",["px","%"],"px"),a=e.inBool("Scale Active",!0),s=e.inFloat("Scale",1),l=e.inBool("Rotate Active",!0),g=e.inFloat("Rot Z",0),c=e.inBool("Set Origin",!0),u=e.inSwitch("Origin X",["left","center","right"],"center"),p=e.inSwitch("Origin Y",["top","center","bottom"],"center");e.setPortGroup("Element",[t]),e.setPortGroup("Translation",[n,o,r,i]),e.setPortGroup("Scaling",[s,a]),e.setPortGroup("Rotation",[l,g]),e.setPortGroup("Origin",[c,u,p]),i.onChange=a.onChange=c.onChange=u.onChange=p.onChange=l.onChange=n.onChange=l.onChange=r.onChange=o.onChange=s.onChange=g.onChange=h;let f=null;function h(){if(f=t.get(),f&&f.style){let t="";n.get()&&(o.get()||r.get())&&(t+="translate("+r.get()+i.get()+" , "+o.get()+i.get()+") "),a.get()&&1!=s.get()&&(t+="scale("+s.get()+") "),l.get()&&0!=g.get()&&(t+="rotateZ("+g.get()+"deg) ");try{f.style.transform=t,c.get()?f.style["transform-origin"]=p.get()+" "+u.get():f.style["transform-origin"]="initial"}catch(t){e.logError(t)}}else setTimeout(h,50)}t.onChange=t.onLinkChanged=function(){f&&f.style&&(f.style.transform="initial"),h()}},Ops.Html.ElementCssTransform.prototype=new CABLES.Op,CABLES.OPS["777d00c6-5605-43c5-9b6a-b20d465bd3ba"]={f:Ops.Html.ElementCssTransform,objName:"Ops.Html.ElementCssTransform"},Ops.Boolean.TriggerChangedTrue=function(){CABLES.Op.apply(this,arguments);const e=this;let t=e.inValueBool("Value",!1),n=e.outTrigger("Next"),r=0;t.onChange=function(){let e=t.get();!r&&e?(r=!0,n.trigger()):r=!1}},Ops.Boolean.TriggerChangedTrue.prototype=new CABLES.Op,CABLES.OPS["385197e1-8b34-4d1c-897f-d1386d99e3b3"]={f:Ops.Boolean.TriggerChangedTrue,objName:"Ops.Boolean.TriggerChangedTrue"},Ops.TimeLine.TimeLineTogglePlay=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inBool("Play",!1);t.onChange=function(){t.get()?e.patch.timer.play():e.patch.timer.pause()}},Ops.TimeLine.TimeLineTogglePlay.prototype=new CABLES.Op,CABLES.OPS["930c6f38-9271-4021-a58b-14dcfc5763b2"]={f:Ops.TimeLine.TimeLineTogglePlay,objName:"Ops.TimeLine.TimeLineTogglePlay"},Ops.Html.CSSFilter=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inObject("Element"),n=e.inValueSelect("method",["-","blur","brightness","contrast","grayscale","hue-rotate","invert","opacity","saturate","sepia"]),r=e.inValue("Value");let o="",i="";r.onChange=l,t.onChange=l;let a=null;function s(){return n.get()+"("+r.get()+o+")"}function l(){const e=t.get();let r="";if(e&&e.style){e!=a&&(a=e);let t=!1,o=e.style.filter;if(o&&o.length>0){let e=o.split(" ");for(let r=0;r<e.length;r++)0==e[r].indexOf(n.get())&&(t=!0,e[r]=s());r=e.join(" ")}t||(r+=" "+s()),e.style.filter=r}}t.onLinkChanged=function(){if(t.isLinked())return;const e=a;if(e&&e.style){let t=e.style.filter;var r="";if(t&&t.length>0){r="";let e=t.split(" ");for(let t=0;t<e.length;t++)0==e[t].indexOf(n.get())&&(e[t]="");r=e.join(" ")}e.style.filter=r}},n.onChange=function(){let e=n.get();i=n.get()+":","blur"==e&&(o="px"),"brightness"==e&&(o=""),"contrast"==e&&(o="%"),"grayscale"==e&&(o="%"),"hue-rotate"==e&&(o="deg"),"invert"==e&&(o="%"),"opacity"==e&&(o="%"),"saturate"==e&&(o=""),"sepia"==e&&(o="%"),l()}},Ops.Html.CSSFilter.prototype=new CABLES.Op,CABLES.OPS["33befabf-7eef-45f6-869f-30e0e4f44739"]={f:Ops.Html.CSSFilter,objName:"Ops.Html.CSSFilter"},Ops.Website.UrlQueryParams_v2=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inString("parameter"),n=e.inString("Default"),r=e.outString("result");n.onChange=s,t.onChange=a;const o={},i=window.location.search.substr(1).split("&");s();for(let e=0;e<i.length;e++){const t=i[e].split("=");o[decodeURIComponent(t[0])]=decodeURIComponent(t[1]||"")}function a(){e.setUiAttrib({extendTitle:t.get()}),s()}function s(){if(o.hasOwnProperty(t.get())){let e=o[t.get()];"true"===e?e=!0:"false"===e&&(e=!1),r.set(e)}else{const e=n.get()||null;r.set(e)}}},Ops.Website.UrlQueryParams_v2.prototype=new CABLES.Op,CABLES.OPS["2e1b645c-c463-465d-abec-bf06ee4b970c"]={f:Ops.Website.UrlQueryParams_v2,objName:"Ops.Website.UrlQueryParams_v2"},Ops.Html.ElementSize=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inTrigger("Update"),n=e.inSwitch("Position",["Relative","Absolute"],"Relative"),r=e.inObject("Element"),o=e.outNumber("x"),i=e.outNumber("y"),a=e.outNumber("Width"),s=e.outNumber("Height");function l(){"Relative"==n.get()?(r.onChange=c,t.onTriggered=c):(r.onChange=g,t.onTriggered=g)}function g(){const e=r.get();if(!e)return;const t=e.getBoundingClientRect();o.set(t.x),i.set(t.y),a.set(t.width),s.set(t.height)}function c(){const t=r.get();if(!t)return;const n=e.patch.cgl.canvas.getBoundingClientRect(),l=t.getBoundingClientRect();o.set(l.x-n.x),i.set(l.y-n.y),a.set(l.width),s.set(l.height)}n.onChange=l,l()},Ops.Html.ElementSize.prototype=new CABLES.Op,CABLES.OPS["fb23c251-a43e-4677-9d03-ccd512fee82e"]={f:Ops.Html.ElementSize,objName:"Ops.Html.ElementSize"},Ops.Value.SwitchNumberOnTrigger=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.outNumber("Value"),n=e.outNumber("Last Value"),r=e.outTrigger("Triggered");let o=[];function i(){n.set(t.get()),t.set(o[this.slot].get()),r.trigger()}let a=8;for(let t=0;t<a;t++){let n=e.addInPort(new CABLES.Port(e,"Trigger "+t,CABLES.OP_PORT_TYPE_FUNCTION));n.slot=t,n.onTriggered=i.bind(n);let r=e.addInPort(new CABLES.Port(e,"Value "+t,CABLES.OP_PORT_TYPE_VALUE));o.push(r)}let s=e.inValueString("Default Value");t.set(s.get()),n.set(s.get()),s.onChange=function(){n.set(t.get()),t.set(s.get())}},Ops.Value.SwitchNumberOnTrigger.prototype=new CABLES.Op,CABLES.OPS["338032c5-bf47-454b-8ae1-cd91f17e5c5b"]={f:Ops.Value.SwitchNumberOnTrigger,objName:"Ops.Value.SwitchNumberOnTrigger"},Ops.Trigger.TriggerNumber=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inTriggerButton("Set"),n=e.inValueFloat("Number"),r=e.outTrigger("Next"),o=e.outNumber("Out Value");o.changeAlways=!0,t.onTriggered=function(){o.set(n.get()),r.trigger()}},Ops.Trigger.TriggerNumber.prototype=new CABLES.Op,CABLES.OPS["9989b1c0-1073-4d5f-bfa0-36dd98b66e27"]={f:Ops.Trigger.TriggerNumber,objName:"Ops.Trigger.TriggerNumber"},Ops.Math.Difference=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inValue("Number A"),n=e.inValue("Number B"),r=e.outNumber("Result");function o(){let e=t.get()-n.get();e=Math.abs(e),r.set(e)}t.onChange=n.onChange=o},Ops.Math.Difference.prototype=new CABLES.Op,CABLES.OPS["5431b943-18aa-46e4-bd32-a7eee30d4e51"]={f:Ops.Math.Difference,objName:"Ops.Math.Difference"},Ops.Html.ToggleClass=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inObject("HTML Element"),n=e.inString("Classname"),r=e.inValueBool("Active",!0);r.onChange=n.onChange=t.onChange=s,e.onDelete=a;let o=null,i=null;function a(e){e&&e.classList&&e.classList.remove(i)}function s(){let e=t.get(),s=n.get();t.isLinked()||a(o),s&&e&&e.classList&&(o&&e!=o&&o.classList.remove(s),a(e),r.get()?e.classList.add(s):e.classList.remove(s),i=s,o=e)}},Ops.Html.ToggleClass.prototype=new CABLES.Op,CABLES.OPS["6dd90fb9-7f28-427f-acd8-589f21a906bb"]={f:Ops.Html.ToggleClass,objName:"Ops.Html.ToggleClass"},Ops.Cables.UIMode=function(){CABLES.Op.apply(this,arguments);const e=this,t=(e.outBoolNum("UI",e.patch.isEditorMode()),e.outBoolNum("Remote Viewer",!!window.gui&&window.gui.isRemoteClient),e.outNumber("Canvas Mode")),n=e.outBoolNum("Patch Field Visible");CABLES.UI&&gui.on("canvasModeChange",(()=>{t.set(gui.getCanvasMode()),n.set(gui.patchView.element.classList.contains("hidden"))}))},Ops.Cables.UIMode.prototype=new CABLES.Op,CABLES.OPS["7c110d60-829f-4b06-b3e4-0af911550570"]={f:Ops.Cables.UIMode,objName:"Ops.Cables.UIMode"},Ops.Value.DelayedValue=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inTrigger("Update"),n=e.inValue("Value",0),r=e.inValue("Delay",.5),o=e.outNumber("Result",0),i=e.inValueBool("Clear on Change",!1),a=new CABLES.Anim;a.createPort(e,"easing",(function(){})).set("absolute"),t.onTriggered=function(){o.set(a.getValue(e.patch.freeTimer.get())||0)},n.onChange=function(){a.getValue(e.patch.freeTimer.get());const t=e.patch.freeTimer.get();i.get()&&a.clear(t),a.setValue(t+r.get(),n.get());let o=0;for(let e=0;e<a.keys.length;e++)a.keys[e]&&a.keys[e].time<t&&(o=e);o>2&&a.keys.splice(0,o)}},Ops.Value.DelayedValue.prototype=new CABLES.Op,CABLES.OPS["8e7741e0-0b1b-40f3-a62c-ac8a8828dffb"]={f:Ops.Value.DelayedValue,objName:"Ops.Value.DelayedValue"},Ops.Value.TriggerOnChangeNumber=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inFloat("Value"),n=e.outTrigger("Next"),r=e.outNumber("Number");t.onChange=function(){r.set(t.get()),n.trigger()}},Ops.Value.TriggerOnChangeNumber.prototype=new CABLES.Op,CABLES.OPS["f5c8c433-ce13-49c4-9a33-74e98f110ed0"]={f:Ops.Value.TriggerOnChangeNumber,objName:"Ops.Value.TriggerOnChangeNumber"},Ops.Vars.VarTriggerNumber=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inTriggerButton("Trigger"),n=e.inValueFloat("Value",0),r=e.outTrigger("Next");e.varName=e.inDropDown("Variable",[],"",!0),new CABLES.VarSetOpWrapper(e,"number",n,e.varName,t,r)},Ops.Vars.VarTriggerNumber.prototype=new CABLES.Op,CABLES.OPS["2c29baf0-2af2-486d-9218-4299594ee9c1"]={f:Ops.Vars.VarTriggerNumber,objName:"Ops.Vars.VarTriggerNumber"},Ops.Html.DivElement_v3=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inString("Text","Hello Div"),n=e.inString("Id"),r=e.inString("Class"),o=e.inStringEditor("Style","position:absolute;\nz-index:100;","inline-css"),i=e.inValueBool("Interactive",!1),a=e.inValueBool("Visible",!0),s=e.inValueBool("Convert Line Breaks",!1),l=e.inValueBool("Propagate Click-Events",!0),g=e.outObject("DOM Element",null,"element"),c=e.outBoolNum("Hover"),u=e.outTrigger("Clicked");let p=null,f=null,h="block",d=null;const m=e.patch.cgl.canvas.parentElement;function C(){d=document.createElement("div"),d.dataset.op=e.id,d.classList.add("cablesEle"),n.get()&&(d.id=n.get()),m.appendChild(d),g.set(d)}function S(){d&&T(),d&&d.parentNode&&d.parentNode.removeChild(d),f=null,d=null}function O(e){e?("none"==h&&(h="block"),d.style.visibility="visible",d.style.display=h):(d.style.visibility="hidden",h=d.style.display||"block",d.style.display="none")}function x(){O(a.get())}function b(){let e=t.get();f!==e&&(f=e,e&&s.get()&&(e=e.replace(/(?:\r\n|\r|\n)/g,"<br>")),d.innerHTML!=e&&(d.innerHTML=e),g.set(null),g.set(d))}function E(){d&&(d.setAttribute("style",o.get()),x(),g.set(null),g.set(d),d.parentElement||m.appendChild(d),_())}C(),r.onChange=y,s.onChange=t.onChange=b,o.onChange=E,i.onChange=w,a.onChange=x,b(),E(),_(),w(),e.onDelete=S,g.onLinkChanged=E;let A="";function T(){if(!d)return;const e=(r.get()||"").split(" ");for(let t=0;t<e.length;t++)e[t]&&d.classList.remove(e[t]);A=""}function y(){const e=(r.get()||"").split(" "),t=(A||"").split(" ");let n=!1;for(let r=0;r<t.length;r++)t[r]&&-1==e.indexOf(t[r].trim())&&(n=!0,d.classList.remove(t[r]));for(let t=0;t<e.length;t++)e[t]&&d.classList.add(e[t].trim());A=r.get(),_()}function L(e){c.set(!0)}function v(e){c.set(!1)}function B(e){l.get()||e.stopPropagation(),u.trigger()}function w(){P(),i.get()&&N()}function P(){p&&(p.removeEventListener("pointerdown",B),p.removeEventListener("pointerleave",v),p.removeEventListener("pointerenter",L),p=null)}function N(){p&&P(),p=d,p&&(p.addEventListener("pointerdown",B),p.addEventListener("pointerleave",v),p.addEventListener("pointerenter",L))}function _(){r.get()&&o.get()?e.setUiError("error","Element uses external and inline CSS",1):e.setUiError("error",null)}n.onChange=function(){d.id=n.get()},e.addEventListener("onEnabledChange",(function(e){S(),e&&(C(),E(),y(),b(),w())}))},Ops.Html.DivElement_v3.prototype=new CABLES.Op,CABLES.OPS["d55d398c-e68e-486b-b0ce-d9c4bdf7df05"]={f:Ops.Html.DivElement_v3,objName:"Ops.Html.DivElement_v3"},Ops.String.NumberToString_v2=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inValue("Number"),n=e.outString("Result");function r(){n.set(String(t.get()||0))}t.onChange=r,r()},Ops.String.NumberToString_v2.prototype=new CABLES.Op,CABLES.OPS["5c6d375a-82db-4366-8013-93f56b4061a9"]={f:Ops.String.NumberToString_v2,objName:"Ops.String.NumberToString_v2"},Ops.Html.CSSProperty_v2=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inObject("Element"),n=e.inString("Property"),r=e.inFloat("Value"),o=e.inString("Value Suffix","px"),i=e.outObject("HTML Element");e.setPortGroup("Element",[t]),e.setPortGroup("Attributes",[n,r,o]),n.onChange=s,r.onChange=l,o.onChange=l;let a=null;function s(){l(),e.setUiAttrib({extendTitle:n.get()+""})}function l(){if(a=t.get(),a&&a.style){const t=r.get()+o.get();try{a.style[n.get()]!=t&&(a.style[n.get()]=t)}catch(t){e.logError(t)}}else setTimeout(l,50);i.set(t.get())}t.onChange=t.onLinkChanged=function(){a&&a.style&&(a.style[n.get()]="initial"),l()}},Ops.Html.CSSProperty_v2.prototype=new CABLES.Op,CABLES.OPS["c179aa0e-b558-4130-8c2d-2deab2919a07"]={f:Ops.Html.CSSProperty_v2,objName:"Ops.Html.CSSProperty_v2"},Ops.String.Concat_v2=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inString("string1","ABC"),n=e.inString("string2","XYZ"),r=e.inValueBool("New Line",!1),o=e.inBool("Active",!0),i=e.outString("result");function a(){if(!o.get())return i.set(t.get());let e=t.get(),a=n.get();if(!e&&!a)return void i.set("");e||(e=""),a||(a="");let s="";e&&a&&r.get()&&(s="\n"),i.set(String(e)+s+String(a))}r.onChange=n.onChange=t.onChange=o.onChange=a,a()},Ops.String.Concat_v2.prototype=new CABLES.Op,CABLES.OPS["a52722aa-0ca9-402c-a844-b7e98a6c6e60"]={f:Ops.String.Concat_v2,objName:"Ops.String.Concat_v2"},Ops.String.SwitchString=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inValueInt("Index"),n=e.outString("Result"),r=[];t.onChange=a;for(var o=0;o<10;o++){var i=e.inString("String "+o);r.push(i),i.onChange=a}function a(){t.get()>=0&&r[t.get()]&&n.set(r[t.get()].get())}},Ops.String.SwitchString.prototype=new CABLES.Op,CABLES.OPS["2a7a0c68-f7c9-4249-b19a-d2de5cb4862c"]={f:Ops.String.SwitchString,objName:"Ops.String.SwitchString"},Ops.String.String_v2=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inString("value",""),n=e.outString("String");t.onChange=function(){n.set(t.get())}},Ops.String.String_v2.prototype=new CABLES.Op,CABLES.OPS["d697ff82-74fd-4f31-8f54-295bc64e713d"]={f:Ops.String.String_v2,objName:"Ops.String.String_v2"},Ops.Time.DelayedTrigger=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inTrigger("exe"),n=e.inValueFloat("delay",1),r=e.inTriggerButton("Cancel"),o=e.outTrigger("next"),i=e.outBool("Delaying");let a=null;r.onTriggered=function(){a&&clearTimeout(a),a=null},t.onTriggered=function(){i.set(!0),a&&clearTimeout(a),a=setTimeout((function(){i.set(!1),a=null,o.trigger()}),1e3*n.get())}},Ops.Time.DelayedTrigger.prototype=new CABLES.Op,CABLES.OPS["f4ff66b0-8500-46f7-9117-832aea0c2750"]={f:Ops.Time.DelayedTrigger,objName:"Ops.Time.DelayedTrigger"},Ops.Math.GaussianRandomArray=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inValueInt("Num",100),n=e.outArray("Array"),r=e.inValue("Deviation",1),o=e.inValueFloat("Random Seed");let i,a=[],s=1,l=!1;function g(e,t){let n,r,o,a;if(l)n=i,l=!1;else{do{r=2*Math.seededRandom()-1,o=2*Math.seededRandom()-1,a=r*r+o*o}while(a>=1);a=Math.sqrt(-2*Math.log(a)/a),n=r*a,i=o*a,l=!0}return n*(t||1)+(e||0)}function c(){s=r.get(),Math.randomSeed=o.get(),a.length=Math.floor(t.get())||0;for(let e=0;e<a.length;e++)a[e]=g(0,s);n.set(null),n.set(a)}o.onChange=r.onChange=t.onChange=c,c()},Ops.Math.GaussianRandomArray.prototype=new CABLES.Op,CABLES.OPS["1a8c3535-6fce-4cba-8601-ddb7a5dd7656"]={f:Ops.Math.GaussianRandomArray,objName:"Ops.Math.GaussianRandomArray"},Ops.Patch.Pw01AEC.AccumulatorPlain=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inTrigger("Trigger in"),n=e.inValueFloat("Add to number",0),r=e.inValueFloat("Multiplier to add number",1),o=e.inValueFloat("Default Value",1),i=e.inTriggerButton("Set Default Value"),a=e.outNumber("Current value");let s=0,l=!0;function g(){s=o.get(),a.set(s),l=!0}i.onTriggered=g,t.onTriggered=function(){l||(s+=n.get()*r.get(),a.set(s)),l=!1}},Ops.Patch.Pw01AEC.AccumulatorPlain.prototype=new CABLES.Op,CABLES.OPS["7a2656ad-a91e-48ab-a140-0753e7186476"]={f:Ops.Patch.Pw01AEC.AccumulatorPlain,objName:"Ops.Patch.Pw01AEC.AccumulatorPlain"},Ops.Math.Cosine=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inValue("Value"),n=e.inValue("Phase",0),r=e.inValue("Frequency",1),o=e.inValue("Amplitude",1),i=e.inValueBool("asine",!1),a=e.outNumber("Result");let s=Math.cos;t.onChange=function(){a.set(o.get()*s(t.get()*r.get()+n.get()))},i.onChange=function(){s=i.get()?Math.acos:Math.cos}},Ops.Math.Cosine.prototype=new CABLES.Op,CABLES.OPS["b51166c4-e0a8-441a-b724-1531effdc52f"]={f:Ops.Math.Cosine,objName:"Ops.Math.Cosine"},Ops.Math.Pi=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inValueFloat("Multiply amount",1),n=e.outNumber("Pi",Math.PI);t.onChange=function(){n.setValue(Math.PI*t.get())}},Ops.Math.Pi.prototype=new CABLES.Op,CABLES.OPS["311e8179-9a7c-43de-9eb2-84577d702974"]={f:Ops.Math.Pi,objName:"Ops.Math.Pi"},Ops.Math.Abs=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inValue("number"),n=e.outNumber("result");t.onChange=function(){n.set(Math.abs(t.get()))}},Ops.Math.Abs.prototype=new CABLES.Op,CABLES.OPS["6b5af21d-065f-44d2-9442-8b7a254753f6"]={f:Ops.Math.Abs,objName:"Ops.Math.Abs"},Ops.Math.RandomNumbers_v3=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inValueFloat("Seed",1),n=e.inValueFloat("Min",0),r=e.inValueFloat("Max",1),o=e.outNumber("X"),i=e.outNumber("Y"),a=e.outNumber("Z"),s=e.outNumber("W");function l(){const e=n.get(),l=r.get();Math.randomSeed=571.1*Math.abs(t.get()||0)+1,o.set(Math.seededRandom()*(l-e)+e),i.set(Math.seededRandom()*(l-e)+e),a.set(Math.seededRandom()*(l-e)+e),s.set(Math.seededRandom()*(l-e)+e)}t.onChange=n.onChange=r.onChange=l,l()},Ops.Math.RandomNumbers_v3.prototype=new CABLES.Op,CABLES.OPS["d2b970e1-9406-4459-995c-5a594acd88e3"]={f:Ops.Math.RandomNumbers_v3,objName:"Ops.Math.RandomNumbers_v3"},Ops.Gl.TextureEffects.Noise.PerlinNoise_v2=function(){CABLES.Op.apply(this,arguments);const e=this,t={perlinnoise3d_frag:'UNI float z;\nUNI float x;\nUNI float y;\nUNI float scale;\nUNI float rangeMul;\nUNI float harmonics;\nUNI float aspect;\n\nIN vec2 texCoord;\nUNI sampler2D tex;\n\n#ifdef HAS_TEX_OFFSETMAP\n    UNI sampler2D texOffsetZ;\n    UNI float offMul;\n#endif\n\n#ifdef HAS_TEX_MASK\n    UNI sampler2D texMask;\n#endif\n\nUNI float amount;\n\n{{CGL.BLENDMODES3}}\n\n\nfloat Interpolation_C2( float x ) { return x * x * x * (x * (x * 6.0 - 15.0) + 10.0); }   //  6x^5-15x^4+10x^3\t( Quintic Curve.  As used by Perlin in Improved Noise.  http://mrl.nyu.edu/~perlin/paper445.pdf )\nvec2 Interpolation_C2( vec2 x ) { return x * x * x * (x * (x * 6.0 - 15.0) + 10.0); }\nvec3 Interpolation_C2( vec3 x ) { return x * x * x * (x * (x * 6.0 - 15.0) + 10.0); }\nvec4 Interpolation_C2( vec4 x ) { return x * x * x * (x * (x * 6.0 - 15.0) + 10.0); }\nvec4 Interpolation_C2_InterpAndDeriv( vec2 x ) { return x.xyxy * x.xyxy * ( x.xyxy * ( x.xyxy * ( x.xyxy * vec2( 6.0, 0.0 ).xxyy + vec2( -15.0, 30.0 ).xxyy ) + vec2( 10.0, -60.0 ).xxyy ) + vec2( 0.0, 30.0 ).xxyy ); }\nvec3 Interpolation_C2_Deriv( vec3 x ) { return x * x * (x * (x * 30.0 - 60.0) + 30.0); }\n\n\nvoid FAST32_hash_3D( vec3 gridcell, out vec4 lowz_hash, out vec4 highz_hash )\t//\tgenerates a random number for each of the 8 cell corners\n{\n    //    gridcell is assumed to be an integer coordinate\n\n    //\tTODO: \tthese constants need tweaked to find the best possible noise.\n    //\t\t\tprobably requires some kind of brute force computational searching or something....\n    const vec2 OFFSET = vec2( 50.0, 161.0 );\n    const float DOMAIN = 69.0;\n    const float SOMELARGEFLOAT = 635.298681;\n    const float ZINC = 48.500388;\n\n    //\ttruncate the domain\n    gridcell.xyz = gridcell.xyz - floor(gridcell.xyz * ( 1.0 / DOMAIN )) * DOMAIN;\n    vec3 gridcell_inc1 = step( gridcell, vec3( DOMAIN - 1.5 ) ) * ( gridcell + 1.0 );\n\n    //\tcalculate the noise\n    vec4 P = vec4( gridcell.xy, gridcell_inc1.xy ) + OFFSET.xyxy;\n    P *= P;\n    P = P.xzxz * P.yyww;\n    highz_hash.xy = vec2( 1.0 / ( SOMELARGEFLOAT + vec2( gridcell.z, gridcell_inc1.z ) * ZINC ) );\n    lowz_hash = fract( P * highz_hash.xxxx );\n    highz_hash = fract( P * highz_hash.yyyy );\n}\n\n\n\n\nvoid FAST32_hash_3D( \tvec3 gridcell,\n                        out vec4 lowz_hash_0,\n                        out vec4 lowz_hash_1,\n                        out vec4 lowz_hash_2,\n                        out vec4 highz_hash_0,\n                        out vec4 highz_hash_1,\n                        out vec4 highz_hash_2\t)\t\t//\tgenerates 3 random numbers for each of the 8 cell corners\n{\n    //    gridcell is assumed to be an integer coordinate\n\n    //\tTODO: \tthese constants need tweaked to find the best possible noise.\n    //\t\t\tprobably requires some kind of brute force computational searching or something....\n    const vec2 OFFSET = vec2( 50.0, 161.0 );\n    const float DOMAIN = 69.0;\n    const vec3 SOMELARGEFLOATS = vec3( 635.298681, 682.357502, 668.926525 );\n    const vec3 ZINC = vec3( 48.500388, 65.294118, 63.934599 );\n\n    //\ttruncate the domain\n    gridcell.xyz = gridcell.xyz - floor(gridcell.xyz * ( 1.0 / DOMAIN )) * DOMAIN;\n    vec3 gridcell_inc1 = step( gridcell, vec3( DOMAIN - 1.5 ) ) * ( gridcell + 1.0 );\n\n    //\tcalculate the noise\n    vec4 P = vec4( gridcell.xy, gridcell_inc1.xy ) + OFFSET.xyxy;\n    P *= P;\n    P = P.xzxz * P.yyww;\n    vec3 lowz_mod = vec3( 1.0 / ( SOMELARGEFLOATS.xyz + gridcell.zzz * ZINC.xyz ) );\n    vec3 highz_mod = vec3( 1.0 / ( SOMELARGEFLOATS.xyz + gridcell_inc1.zzz * ZINC.xyz ) );\n    lowz_hash_0 = fract( P * lowz_mod.xxxx );\n    highz_hash_0 = fract( P * highz_mod.xxxx );\n    lowz_hash_1 = fract( P * lowz_mod.yyyy );\n    highz_hash_1 = fract( P * highz_mod.yyyy );\n    lowz_hash_2 = fract( P * lowz_mod.zzzz );\n    highz_hash_2 = fract( P * highz_mod.zzzz );\n}\nfloat Falloff_Xsq_C1( float xsq ) { xsq = 1.0 - xsq; return xsq*xsq; }\t// ( 1.0 - x*x )^2   ( Used by Humus for lighting falloff in Just Cause 2.  GPUPro 1 )\nfloat Falloff_Xsq_C2( float xsq ) { xsq = 1.0 - xsq; return xsq*xsq*xsq; }\t// ( 1.0 - x*x )^3.   NOTE: 2nd derivative is 0.0 at x=1.0, but non-zero at x=0.0\nvec4 Falloff_Xsq_C2( vec4 xsq ) { xsq = 1.0 - xsq; return xsq*xsq*xsq; }\n\n\n//\n//\tPerlin Noise 3D  ( gradient noise )\n//\tReturn value range of -1.0->1.0\n//\thttp://briansharpe.files.wordpress.com/2011/11/perlinsample.jpg\n//\nfloat Perlin3D( vec3 P )\n{\n    //\testablish our grid cell and unit position\n    vec3 Pi = floor(P);\n    vec3 Pf = P - Pi;\n    vec3 Pf_min1 = Pf - 1.0;\n\n#if 1\n    //\n    //\tclassic noise.\n    //\trequires 3 random values per point.  with an efficent hash function will run faster than improved noise\n    //\n\n    //\tcalculate the hash.\n    //\t( various hashing methods listed in order of speed )\n    vec4 hashx0, hashy0, hashz0, hashx1, hashy1, hashz1;\n    FAST32_hash_3D( Pi, hashx0, hashy0, hashz0, hashx1, hashy1, hashz1 );\n    //SGPP_hash_3D( Pi, hashx0, hashy0, hashz0, hashx1, hashy1, hashz1 );\n\n    //\tcalculate the gradients\n    vec4 grad_x0 = hashx0 - 0.49999;\n    vec4 grad_y0 = hashy0 - 0.49999;\n    vec4 grad_z0 = hashz0 - 0.49999;\n    vec4 grad_x1 = hashx1 - 0.49999;\n    vec4 grad_y1 = hashy1 - 0.49999;\n    vec4 grad_z1 = hashz1 - 0.49999;\n    vec4 grad_results_0 = inversesqrt( grad_x0 * grad_x0 + grad_y0 * grad_y0 + grad_z0 * grad_z0 ) * ( vec2( Pf.x, Pf_min1.x ).xyxy * grad_x0 + vec2( Pf.y, Pf_min1.y ).xxyy * grad_y0 + Pf.zzzz * grad_z0 );\n    vec4 grad_results_1 = inversesqrt( grad_x1 * grad_x1 + grad_y1 * grad_y1 + grad_z1 * grad_z1 ) * ( vec2( Pf.x, Pf_min1.x ).xyxy * grad_x1 + vec2( Pf.y, Pf_min1.y ).xxyy * grad_y1 + Pf_min1.zzzz * grad_z1 );\n\n#if 1\n    //\tClassic Perlin Interpolation\n    vec3 blend = Interpolation_C2( Pf );\n    vec4 res0 = mix( grad_results_0, grad_results_1, blend.z );\n    vec4 blend2 = vec4( blend.xy, vec2( 1.0 - blend.xy ) );\n    float final = dot( res0, blend2.zxzx * blend2.wwyy );\n    final *= 1.1547005383792515290182975610039;\t\t//\t(optionally) scale things to a strict -1.0->1.0 range    *= 1.0/sqrt(0.75)\n    return final;\n#else\n    //\tClassic Perlin Surflet\n    //\thttp://briansharpe.wordpress.com/2012/03/09/modifications-to-classic-perlin-noise/\n    Pf *= Pf;\n    Pf_min1 *= Pf_min1;\n    vec4 vecs_len_sq = vec4( Pf.x, Pf_min1.x, Pf.x, Pf_min1.x ) + vec4( Pf.yy, Pf_min1.yy );\n    float final = dot( Falloff_Xsq_C2( min( vec4( 1.0 ), vecs_len_sq + Pf.zzzz ) ), grad_results_0 ) + dot( Falloff_Xsq_C2( min( vec4( 1.0 ), vecs_len_sq + Pf_min1.zzzz ) ), grad_results_1 );\n    final *= 2.3703703703703703703703703703704;\t\t//\t(optionally) scale things to a strict -1.0->1.0 range    *= 1.0/cube(0.75)\n    return final;\n#endif\n\n#else\n    //\n    //\timproved noise.\n    //\trequires 1 random value per point.  Will run faster than classic noise if a slow hashing function is used\n    //\n\n    //\tcalculate the hash.\n    //\t( various hashing methods listed in order of speed )\n    vec4 hash_lowz, hash_highz;\n    FAST32_hash_3D( Pi, hash_lowz, hash_highz );\n    //BBS_hash_3D( Pi, hash_lowz, hash_highz );\n    //SGPP_hash_3D( Pi, hash_lowz, hash_highz );\n\n    //\n    //\t"improved" noise using 8 corner gradients.  Faster than the 12 mid-edge point method.\n    //\tKen mentions using diagonals like this can cause "clumping", but we\'ll live with that.\n    //\t[1,1,1]  [-1,1,1]  [1,-1,1]  [-1,-1,1]\n    //\t[1,1,-1] [-1,1,-1] [1,-1,-1] [-1,-1,-1]\n    //\n    hash_lowz -= 0.5;\n    vec4 grad_results_0_0 = vec2( Pf.x, Pf_min1.x ).xyxy * sign( hash_lowz );\n    hash_lowz = abs( hash_lowz ) - 0.25;\n    vec4 grad_results_0_1 = vec2( Pf.y, Pf_min1.y ).xxyy * sign( hash_lowz );\n    vec4 grad_results_0_2 = Pf.zzzz * sign( abs( hash_lowz ) - 0.125 );\n    vec4 grad_results_0 = grad_results_0_0 + grad_results_0_1 + grad_results_0_2;\n\n    hash_highz -= 0.5;\n    vec4 grad_results_1_0 = vec2( Pf.x, Pf_min1.x ).xyxy * sign( hash_highz );\n    hash_highz = abs( hash_highz ) - 0.25;\n    vec4 grad_results_1_1 = vec2( Pf.y, Pf_min1.y ).xxyy * sign( hash_highz );\n    vec4 grad_results_1_2 = Pf_min1.zzzz * sign( abs( hash_highz ) - 0.125 );\n    vec4 grad_results_1 = grad_results_1_0 + grad_results_1_1 + grad_results_1_2;\n\n    //\tblend the gradients and return\n    vec3 blend = Interpolation_C2( Pf );\n    vec4 res0 = mix( grad_results_0, grad_results_1, blend.z );\n    vec4 blend2 = vec4( blend.xy, vec2( 1.0 - blend.xy ) );\n    return dot( res0, blend2.zxzx * blend2.wwyy ) * (2.0 / 3.0);\t//\t(optionally) mult by (2.0/3.0) to scale to a strict -1.0->1.0 range\n#endif\n}\n\nvoid main()\n{\n    vec4 base=texture(tex,texCoord);\n    vec2 p=vec2(texCoord.x-0.5,texCoord.y-0.5);\n\n    p=p*scale;\n    p=vec2(p.x+0.5-x,p.y+0.5-y);\n\n\n\n    vec3 offset;\n    #ifdef HAS_TEX_OFFSETMAP\n        vec4 offMap=texture(texOffsetZ,texCoord);\n\n        #ifdef OFFSET_X_R\n            offset.x=offMap.r;\n        #endif\n        #ifdef OFFSET_X_G\n            offset.x=offMap.g;\n        #endif\n        #ifdef OFFSET_X_B\n            offset.x=offMap.b;\n        #endif\n\n        #ifdef OFFSET_Y_R\n            offset.y=offMap.r;\n        #endif\n        #ifdef OFFSET_Y_G\n            offset.y=offMap.g;\n        #endif\n        #ifdef OFFSET_Y_B\n            offset.y=offMap.b;\n        #endif\n\n        #ifdef OFFSET_Z_R\n            offset.z=offMap.r;\n        #endif\n        #ifdef OFFSET_Z_G\n            offset.z=offMap.g;\n        #endif\n        #ifdef OFFSET_Z_B\n            offset.z=offMap.b;\n        #endif\n        offset*=offMul;\n    #endif\n\n    float aa=texture(tex,texCoord).r;\n\n    float v = 0.0;\n    p.x*=aspect;\n\n    v+=Perlin3D(vec3(p.x,p.y,z)+offset);\n\n    #ifdef HARMONICS\n        if (harmonics >= 2.0) v += Perlin3D(vec3(p.x,p.y,z)*2.2+offset) * 0.5;\n        if (harmonics >= 3.0) v += Perlin3D(vec3(p.x,p.y,z)*4.3+offset) * 0.25;\n        if (harmonics >= 4.0) v += Perlin3D(vec3(p.x,p.y,z)*8.4+offset) * 0.125;\n        if (harmonics >= 5.0) v += Perlin3D(vec3(p.x,p.y,z)*16.5+offset) * 0.0625;\n    #endif\n\n\n    v*=rangeMul;\n    v=v*0.5+0.5;\n    float v2=v;\n    float v3=v;\n\n    #ifdef RGB\n        v2=Perlin3D(vec3(p.x+2.0,p.y+2.0,z))*0.5+0.5;\n\n        #ifdef HARMONICS\n            if (harmonics >= 2.0) v2 += Perlin3D(vec3(p.x,p.y,z)*2.2+offset) * 0.5;\n            if (harmonics >= 3.0) v2 += Perlin3D(vec3(p.x,p.y,z)*4.3+offset) * 0.25;\n            if (harmonics >= 4.0) v2 += Perlin3D(vec3(p.x,p.y,z)*8.4+offset) * 0.125;\n            if (harmonics >= 5.0) v2 += Perlin3D(vec3(p.x,p.y,z)*16.5+offset) * 0.0625;\n        #endif\n\n        v3=Perlin3D(vec3(p.x+3.0,p.y+3.0,z))*0.5+0.5;\n\n        #ifdef HARMONICS\n            if (harmonics >= 2.0) v3 += Perlin3D(vec3(p.x,p.y,z)*2.2+offset) * 0.5;\n            if (harmonics >= 3.0) v3 += Perlin3D(vec3(p.x,p.y,z)*4.3+offset) * 0.25;\n            if (harmonics >= 4.0) v3 += Perlin3D(vec3(p.x,p.y,z)*8.4+offset) * 0.125;\n            if (harmonics >= 5.0) v3 += Perlin3D(vec3(p.x,p.y,z)*16.5+offset) * 0.0625;\n        #endif\n\n    #endif\n\n    vec4 col=vec4(v,v2,v3,1.0);\n\n    float str=1.0;\n    #ifdef HAS_TEX_MASK\n        str=texture(texMask,texCoord).r;\n    #endif\n\n    #ifdef RANGE_MIN1\n        col=col*2.0-1.0;\n    #endif\n\n    col=cgl_blendPixel(base,col,amount*str);\n\n\n    #ifdef NO_CHANNEL_R\n        col.r=base.r;\n    #endif\n    #ifdef NO_CHANNEL_G\n        col.g=base.g;\n    #endif\n    #ifdef NO_CHANNEL_B\n        col.b=base.b;\n    #endif\n\n\n\n    outColor=col;\n}\n'},n=e.inTrigger("render"),r=e.inTexture("Mask"),o=CGL.TextureEffect.AddBlendSelect(e),i=CGL.TextureEffect.AddBlendAlphaMask(e),a=e.inValueSlider("Amount",1),s=e.inSwitch("Color",["Mono","RGB","R","G","B"],"Mono"),l=e.inValue("Scale",8),g=e.inValue("Multiply",1),c=e.inSwitch("Value",["0-1","-1-1"],"0-1"),u=e.inSwitch("Harmonics",["1","2","3","4","5"],"1"),p=e.inValue("X",0),f=e.inValue("Y",0),h=e.inValue("Z",0),d=e.outTrigger("trigger"),m=e.patch.cgl,C=new CGL.Shader(m,"perlinnoise");e.setPortGroup("Position",[p,f,h]),C.setSource(C.getDefaultVertexShader(),t.perlinnoise3d_frag),new CGL.Uniform(C,"t","tex",0),new CGL.Uniform(C,"t","texOffsetZ",1),new CGL.Uniform(C,"t","texMask",2),new CGL.Uniform(C,"f","z",h),new CGL.Uniform(C,"f","x",p),new CGL.Uniform(C,"f","y",f),new CGL.Uniform(C,"f","scale",l),new CGL.Uniform(C,"f","amount",a),new CGL.Uniform(C,"f","rangeMul",g),CGL.TextureEffect.setupBlending(e,C,o,a,i);const S=e.inTexture("Offset"),O=e.inFloat("Offset Multiply",1),x=e.inSwitch("Offset X",["None","R","G","B"],"None"),b=e.inSwitch("Offset Y",["None","R","G","B"],"None"),E=e.inSwitch("Offset Z",["None","R","G","B"],"R");e.setPortGroup("Offset Map",[S,E,b,x,O]),new CGL.Uniform(C,"f","offMul",O);const A=new CGL.Uniform(C,"f","aspect",1),T=new CGL.Uniform(C,"f","harmonics",0);function y(){C.toggleDefine("NO_CHANNEL_R","G"==s.get()||"B"==s.get()),C.toggleDefine("NO_CHANNEL_G","R"==s.get()||"B"==s.get()),C.toggleDefine("NO_CHANNEL_B","R"==s.get()||"G"==s.get()),C.toggleDefine("HAS_TEX_OFFSETMAP",S.get()),C.toggleDefine("HAS_TEX_MASK",r.get()),C.toggleDefine("OFFSET_X_R","R"==x.get()),C.toggleDefine("OFFSET_X_G","G"==x.get()),C.toggleDefine("OFFSET_X_B","B"==x.get()),C.toggleDefine("OFFSET_Y_R","R"==b.get()),C.toggleDefine("OFFSET_Y_G","G"==b.get()),C.toggleDefine("OFFSET_Y_B","B"==b.get()),C.toggleDefine("OFFSET_Z_R","R"==E.get()),C.toggleDefine("OFFSET_Z_G","G"==E.get()),C.toggleDefine("OFFSET_Z_B","B"==E.get()),C.toggleDefine("RANGE_MIN1","-1-1"==c.get()),x.setUiAttribs({greyout:!S.isLinked()}),b.setUiAttribs({greyout:!S.isLinked()}),E.setUiAttribs({greyout:!S.isLinked()}),O.setUiAttribs({greyout:!S.isLinked()}),C.toggleDefine("RGB","RGB"==s.get())}u.onChange=()=>{T.setValue(parseFloat(u.get())),C.toggleDefine("HARMONICS",u.get()>1)},c.onChange=x.onChange=b.onChange=E.onChange=r.onChange=s.onChange=S.onChange=y,y(),n.onTriggered=function(){CGL.TextureEffect.checkOpInEffect(e,3)&&(m.pushShader(C),m.currentTextureEffect.bind(),A.setValue(m.currentTextureEffect.aspectRatio),m.setTexture(0,m.currentTextureEffect.getCurrentSourceTexture().tex),S.get()&&m.setTexture(1,S.get().tex),r.get()&&m.setTexture(2,r.get().tex),m.currentTextureEffect.finish(),m.popShader(),d.trigger())}},Ops.Gl.TextureEffects.Noise.PerlinNoise_v2.prototype=new CABLES.Op,CABLES.OPS["b4b238d3-db68-4206-8dc7-4b52433fc932"]={f:Ops.Gl.TextureEffects.Noise.PerlinNoise_v2,objName:"Ops.Gl.TextureEffects.Noise.PerlinNoise_v2"},Ops.Gl.TriggerOnCanvasResize=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.outTrigger("Resized");let n=e.patch.cgl.on("resize",r);function r(){t.trigger()}e.onDelete=()=>{e.patch.cgl.off(n)}},Ops.Gl.TriggerOnCanvasResize.prototype=new CABLES.Op,CABLES.OPS["856de8cf-b8d1-4668-b8ff-80c68bc73ddd"]={f:Ops.Gl.TriggerOnCanvasResize,objName:"Ops.Gl.TriggerOnCanvasResize"},Ops.Gl.TextureEffects.EdgeDetection_v4=function(){CABLES.Op.apply(this,arguments);const e=this,t={edgedetect_frag:"IN vec2 texCoord;\nUNI sampler2D tex;\nUNI float amount;\nUNI float width;\nUNI float strength;\nUNI float texWidth;\nUNI float texHeight;\nUNI float mulColor;\n\nconst vec4 lumcoeff = vec4(0.299,0.587,0.114, 0.);\n\nvec3 desaturate(vec3 color)\n{\n    return vec3(dot(vec3(0.2126,0.7152,0.0722), color));\n}\n\n{{CGL.BLENDMODES3}}\n\nvoid main()\n{\n    // vec4 col=vec4(1.0,0.0,0.0,1.0);\n\n    // float pixelX=0.27/texWidth;\n    // float pixelY=0.27/texHeight;\n    float pixelX=(width+0.01)*4.0/texWidth;\n    float pixelY=(width+0.01)*4.0/texHeight;\n\nvec2 tc=texCoord;\n// #ifdef OFFSETPIXEL\n    tc.x+=1.0/texWidth*0.5;\n    tc.y+=1.0/texHeight*0.5;\n// #endif\n    // col=texture(tex,texCoord);\n\n    float count=1.0;\n    vec4 base=texture(tex,texCoord);\n\n\tvec4 horizEdge = vec4( 0.0 );\n\thorizEdge -= texture( tex, vec2( tc.x - pixelX, tc.y - pixelY ) ) * 1.0;\n\thorizEdge -= texture( tex, vec2( tc.x - pixelX, tc.y     ) ) * 2.0;\n\thorizEdge -= texture( tex, vec2( tc.x - pixelX, tc.y + pixelY ) ) * 1.0;\n\thorizEdge += texture( tex, vec2( tc.x + pixelX, tc.y - pixelY ) ) * 1.0;\n\thorizEdge += texture( tex, vec2( tc.x + pixelX, tc.y     ) ) * 2.0;\n\thorizEdge += texture( tex, vec2( tc.x + pixelX, tc.y + pixelY ) ) * 1.0;\n\tvec4 vertEdge = vec4( 0.0 );\n\tvertEdge -= texture( tex, vec2( tc.x - pixelX, tc.y - pixelY ) ) * 1.0;\n\tvertEdge -= texture( tex, vec2( tc.x    , tc.y - pixelY ) ) * 2.0;\n\tvertEdge -= texture( tex, vec2( tc.x + pixelX, tc.y - pixelY ) ) * 1.0;\n\tvertEdge += texture( tex, vec2( tc.x - pixelX, tc.y + pixelY ) ) * 1.0;\n\tvertEdge += texture( tex, vec2( tc.x    , tc.y + pixelY ) ) * 2.0;\n\tvertEdge += texture( tex, vec2( tc.x + pixelX, tc.y + pixelY ) ) * 1.0;\n\n\thorizEdge*=base.a;\n\tvertEdge*=base.a;\n\n\n\tvec3 edge = sqrt((horizEdge.rgb/count * horizEdge.rgb/count) + (vertEdge.rgb/count * vertEdge.rgb/count));\n\n    edge=desaturate(edge);\n    edge*=strength;\n\n    if(mulColor>0.0) edge*=texture( tex, texCoord ).rgb*mulColor*4.0;\n    edge=max(min(edge,1.0),0.0);\n\n    //blend section\n    vec4 col=vec4(edge,base.a);\n\n    outColor=cgl_blendPixel(base,col,amount*base.a);\n}\n\n"},n=e.inTrigger("Render"),r=CGL.TextureEffect.AddBlendSelect(e,"Blend Mode","normal"),o=e.inValueSlider("Amount",1),i=e.inFloat("Strength",4),a=e.inValueSlider("Width",.1),s=e.inValueSlider("Mul Color",0),l=e.outTrigger("Trigger"),g=e.patch.cgl,c=new CGL.Shader(g,e.name);c.setSource(c.getDefaultVertexShader(),t.edgedetect_frag),new CGL.Uniform(c,"t","tex",0),new CGL.Uniform(c,"f","amount",o),new CGL.Uniform(c,"f","strength",i),new CGL.Uniform(c,"f","width",a);const u=new CGL.Uniform(c,"f","texWidth",128),p=new CGL.Uniform(c,"f","texHeight",128);new CGL.Uniform(c,"f","mulColor",s),CGL.TextureEffect.setupBlending(e,c,r,o),n.onTriggered=function(){CGL.TextureEffect.checkOpInEffect(e,3)&&(g.pushShader(c),g.currentTextureEffect.bind(),g.setTexture(0,g.currentTextureEffect.getCurrentSourceTexture().tex),u.setValue(g.currentTextureEffect.getCurrentSourceTexture().width),p.setValue(g.currentTextureEffect.getCurrentSourceTexture().height),g.currentTextureEffect.finish(),g.popShader(),l.trigger())}},Ops.Gl.TextureEffects.EdgeDetection_v4.prototype=new CABLES.Op,CABLES.OPS["0240e26e-b86d-43b2-8c72-6795bb86dc76"]={f:Ops.Gl.TextureEffects.EdgeDetection_v4,objName:"Ops.Gl.TextureEffects.EdgeDetection_v4"},Ops.Value.Boolean=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inValueBool("value",!1),n=e.outBoolNum("result");function r(){n.get()!=t.get()&&n.set(t.get())}n.set(!1),t.onChange=r},Ops.Value.Boolean.prototype=new CABLES.Op,CABLES.OPS["83e2d74c-9741-41aa-a4d7-1bda4ef55fb3"]={f:Ops.Value.Boolean,objName:"Ops.Value.Boolean"},Ops.Value.MaximumSafeInteger=function(){CABLES.Op.apply(this,arguments);const e=this;e.outNumber("Max Int",Number.MAX_SAFE_INTEGER)},Ops.Value.MaximumSafeInteger.prototype=new CABLES.Op,CABLES.OPS["0efefbb7-461c-4a34-b7fd-28b89b0ceb3f"]={f:Ops.Value.MaximumSafeInteger,objName:"Ops.Value.MaximumSafeInteger"},Ops.Devices.Mouse.MouseButtons=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.outTrigger("Click Left"),n=e.outTrigger("Click Right"),r=e.outTrigger("Double Click"),o=e.outBoolNum("Button pressed Left",!1),i=e.outBoolNum("Button pressed Middle",!1),a=e.outBoolNum("Button pressed Right",!1),s=e.outTrigger("Mouse Down Left"),l=e.outTrigger("Mouse Down Middle"),g=e.outTrigger("Mouse Down Right"),c=e.outTrigger("Mouse Up Left"),u=e.outTrigger("Mouse Up Middle"),p=e.outTrigger("Mouse Up Right"),f=e.inValueSelect("Area",["Canvas","Document"],"Canvas"),h=e.inValueBool("Active",!0),d=e.patch.cgl;let m=null;function C(e){1==e.which?(o.set(!0),s.trigger()):2==e.which?(i.set(!0),l.trigger()):3==e.which&&(a.set(!0),g.trigger())}function S(e){1==e.which?(o.set(!1),c.trigger()):2==e.which?(i.set(!1),u.trigger()):3==e.which&&(a.set(!1),p.trigger())}function O(e){n.trigger(),e.preventDefault()}function x(e){r.trigger()}function b(e){t.trigger()}function E(e){e.touches&&e.touches.length>0&&(e.touches[0].which=1,C(e.touches[0]))}function A(e){S({which:1})}function T(){m&&(m.removeEventListener("touchend",A),m.removeEventListener("touchcancel",A),m.removeEventListener("touchstart",E),m.removeEventListener("dblclick",x),m.removeEventListener("click",b),m.removeEventListener("mousedown",C),m.removeEventListener("mouseup",S),m.removeEventListener("contextmenu",O),m.removeEventListener("mouseleave",S),m=null)}function y(){m&&T(),m=d.canvas,"Document"==f.get()&&(m=document.body),m.addEventListener("touchend",A),m.addEventListener("touchcancel",A),m.addEventListener("touchstart",E),m.addEventListener("dblclick",x),m.addEventListener("click",b),m.addEventListener("mousedown",C),m.addEventListener("mouseup",S),m.addEventListener("contextmenu",O),m.addEventListener("mouseleave",S)}function L(){T(),h.get()&&y()}f.onChange=L,e.onDelete=T,L(),e.onLoaded=L,h.onChange=L},Ops.Devices.Mouse.MouseButtons.prototype=new CABLES.Op,CABLES.OPS["c7e5e545-c8a1-4fef-85c2-45422b947f0d"]={f:Ops.Devices.Mouse.MouseButtons,objName:"Ops.Devices.Mouse.MouseButtons"},Ops.Boolean.IfTrueThen_v2=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inTrigger("exe"),n=e.inValueBool("boolean",!1),r=e.outTrigger("then"),o=e.outTrigger("else");function i(){n.get()?r.trigger():o.trigger()}t.onTriggered=i},Ops.Boolean.IfTrueThen_v2.prototype=new CABLES.Op,CABLES.OPS["9549e2ed-a544-4d33-a672-05c7854ccf5d"]={f:Ops.Boolean.IfTrueThen_v2,objName:"Ops.Boolean.IfTrueThen_v2"},Ops.Gl.TextureEffects.Noise.PixelNoise_v3=function(){CABLES.Op.apply(this,arguments);const e=this,t={pixelnoise2_frag:"IN vec2 texCoord;\nUNI sampler2D tex;\nUNI float amount;\nUNI float numX;\nUNI float numY;\nUNI float addX;\nUNI float addY;\nUNI float addZ;\nUNI float seed2;\nUNI float minIn;\nUNI float maxIn;\n\nfloat random(vec2 co)\n{\n    float r=fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * (5.711+(mod(addZ+5711.210,57111.0))));\n\n    #ifdef LOOP\n        r=abs(r-0.5)*2.0;\n    #endif\n\n    return r;\n}\n\n{{CGL.BLENDMODES3}}\n\nvoid main()\n{\n    vec2 seed=vec2(0.0);\n\n    #ifndef CENTER\n        seed=vec2(floor( texCoord.x*numX+addX),floor( texCoord.y*numY+addY));\n    #endif\n    #ifdef CENTER\n        seed=vec2(floor( (texCoord.x-0.5)*numX+addX),floor( (texCoord.y-0.5)*numY+addY));\n    #endif\n\n    float r,g,b;\n\n    #ifndef RGB\n        r=g=b=random( seed + 0.5711 + seed2 );\n    #endif\n\n    #ifdef RGB\n        r=random( seed+0.5711 + seed2);\n        g=random( seed+0.5712 + seed2);\n        b=random( seed+0.5713 + seed2);\n    #endif\n\n    vec4 rnd = clamp( vec4( r,g,b,1.0 ),vec4(minIn), vec4(maxIn) );\n\n    vec4 base=texture(tex,texCoord);\n\n    outColor=cgl_blendPixel(base,rnd,amount);\n\n}"},n=e.inTrigger("Render"),r=CGL.TextureEffect.AddBlendSelect(e,"Blend Mode","normal"),o=CGL.TextureEffect.AddBlendAlphaMask(e),i=e.inValueSlider("Amount",1),a=e.inValueBool("Loop",!1),s=e.inValueBool("RGB",!1),l=e.inValue("Minimum value",0),g=e.inValue("Maximum value",1),c=e.inValue("Num X",10),u=e.inValue("Num Y",10),p=e.inValue("X",0),f=e.inValue("Y",0),h=e.inValue("Z",0),d=e.inValue("Seed",0),m=e.inBool("Centered",!1),C=e.outTrigger("Next");e.setPortGroup("Look",[s,a,l,g]),e.setPortGroup("Position",[p,f,h]),e.setPortGroup("Scaling",[c,u]);const S=e.patch.cgl,O=new CGL.Shader(S,e.name);O.setSource(O.getDefaultVertexShader(),t.pixelnoise2_frag),new CGL.Uniform(O,"f","amount",i),new CGL.Uniform(O,"f","time",1),new CGL.Uniform(O,"t","tex",0),new CGL.Uniform(O,"f","numX",c),new CGL.Uniform(O,"f","numY",u),new CGL.Uniform(O,"f","addX",p),new CGL.Uniform(O,"f","addY",f),new CGL.Uniform(O,"f","addZ",h),new CGL.Uniform(O,"f","seed2",d),new CGL.Uniform(O,"f","minIn",l),new CGL.Uniform(O,"f","maxIn",g),a.onChange=function(){a.get()?O.define("LOOP"):O.removeDefine("LOOP")},s.onChange=function(){s.get()?O.define("RGB"):O.removeDefine("RGB")},m.onChange=function(){O.toggleDefine("CENTER",m.get())},CGL.TextureEffect.setupBlending(e,O,r,i,o),n.onTriggered=function(){CGL.TextureEffect.checkOpInEffect(e,3)&&(S.pushShader(O),S.currentTextureEffect.bind(),S.setTexture(0,S.currentTextureEffect.getCurrentSourceTexture().tex),S.currentTextureEffect.finish(),S.popShader(),C.trigger())}},Ops.Gl.TextureEffects.Noise.PixelNoise_v3.prototype=new CABLES.Op,CABLES.OPS["01ad08b6-dea4-4765-984c-3885c9c6520f"]={f:Ops.Gl.TextureEffects.Noise.PixelNoise_v3,objName:"Ops.Gl.TextureEffects.Noise.PixelNoise_v3"},Ops.Gl.TextureEffects.Posterize_v2=function(){CABLES.Op.apply(this,arguments);const e=this,t={posterize_frag:"UNI sampler2D tex;\nIN vec2 texCoord;\nUNI float levels;\nUNI float amount;\n\n{{CGL.BLENDMODES3}}\n\nvoid main(void)\n{\n    vec3 srcPixel = texture(tex, texCoord  ).rgb;\n    vec3 amountPerLevel = vec3(1.0/levels);\n    vec3 numOfLevels = floor(srcPixel/amountPerLevel);\n    vec3 col = numOfLevels * (vec3(1.0) / (vec3(levels) - vec3(1.0)));\n\n    vec4 base=texture(tex,texCoord);\n    outColor= cgl_blendPixel(base,vec4(col,base.a),amount);\n}\n\n"},n=e.inTrigger("Render"),r=CGL.TextureEffect.AddBlendSelect(e,"Blend Mode","normal"),o=e.inValueSlider("Amount",1),i=e.inValue("levels",2),a=e.outTrigger("Trigger"),s=e.patch.cgl,l=new CGL.Shader(s,e.name);l.setSource(l.getDefaultVertexShader(),t.posterize_frag),new CGL.Uniform(l,"t","tex",0),new CGL.Uniform(l,"f","levels",i);const g=new CGL.Uniform(l,"f","texWidth",128),c=new CGL.Uniform(l,"f","texHeight",128);new CGL.Uniform(l,"f","amount",o),CGL.TextureEffect.setupBlending(e,l,r,o),n.onTriggered=function(){CGL.TextureEffect.checkOpInEffect(e,3)&&(s.pushShader(l),s.currentTextureEffect.bind(),g.setValue(s.currentTextureEffect.getCurrentSourceTexture().width),c.setValue(s.currentTextureEffect.getCurrentSourceTexture().height),s.setTexture(0,s.currentTextureEffect.getCurrentSourceTexture().tex),s.currentTextureEffect.finish(),s.popShader(),a.trigger())}},Ops.Gl.TextureEffects.Posterize_v2.prototype=new CABLES.Op,CABLES.OPS["19703953-7984-4334-af72-0991425b4850"]={f:Ops.Gl.TextureEffects.Posterize_v2,objName:"Ops.Gl.TextureEffects.Posterize_v2"},Ops.Array.ArrayGetString=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inArray("array"),n=e.inValueInt("index"),r=e.outString("result");function o(){const e=t.get();e&&r.set(e[n.get()])}t.ignoreValueSerialize=!0,n.onChange=o,t.onChange=function(){o()}},Ops.Array.ArrayGetString.prototype=new CABLES.Op,CABLES.OPS["be8f16c0-0c8a-48a2-a92b-45dbf88c76c1"]={f:Ops.Array.ArrayGetString,objName:"Ops.Array.ArrayGetString"},Ops.Cables.AssetPathURL=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inString("Filename",""),n=e.outString("Path");function r(){let r=t.get();if(!t.get())return void n.set("");let o=null;e.storage&&e.storage.blueprint&&e.storage.blueprint.patchId&&(o=e.storage.blueprint.patchId),r=e.patch.getAssetPath(o)+r;let i=e.patch.getFilePath(r);n.set(i)}t.onChange=r,r()},Ops.Cables.AssetPathURL.prototype=new CABLES.Op,CABLES.OPS["e502ae39-c87e-4516-9e78-cb71333bcfff"]={f:Ops.Cables.AssetPathURL,objName:"Ops.Cables.AssetPathURL"},Ops.Array.ArrayToString_v3=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inArray("Array"),n=e.inString("Seperator",","),r=e.inValueBool("New Line"),o=e.outString("Result");function i(){var e=t.get(),i="",a=n.get();r.get()&&(a+="\n"),e&&e.join&&(i=e.join(a)),o.set(i)}t.onChange=o.onChange=n.onChange=r.onChange=i},Ops.Array.ArrayToString_v3.prototype=new CABLES.Op,CABLES.OPS["7b539bb3-8e86-4367-9e00-a637d3cfd87a"]={f:Ops.Array.ArrayToString_v3,objName:"Ops.Array.ArrayToString_v3"},Ops.Patch.Pw01AEC.ForceCanvasSize_Custom=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inTrigger("Trigger"),n=e.inBool("Active",!0),r=e.inSwitch("Force",["Resolution","Aspect Ratio"],"Resolution"),o=e.inBool("Center In Parent",!0),i=e.inBool("Scale to fit Parent",!1),a=e.inInt("Set Width",300),s=e.inInt("Set Height",200),l=e.inDropDown("Aspect Ratio",["Custom","21:9","2:1","16:9","16:10","4:3","1:1","9:16","1:2","iPhoneXr Vert"],"16:9"),g=e.inFloat("Ratio",0),c=e.inDropDown("Fill Parent",["Auto","Width","Height","Both"],"Auto"),u=e.outTrigger("Next"),p=e.outNumber("Width"),f=e.outNumber("Height"),h=e.outNumber("Margin Left"),d=e.outNumber("Margin Top");e.setPortGroup("Size",[a,s]),e.setPortGroup("Proportions",[g,c,l]);let m=0;const C=1,S=2,O=3,x=4;c.onChange=T,r.onChange=E,o.onChange=t.onLinkChanged=y,l.onChange=A;const b=e.patch.cgl;function E(){"Aspect Ratio"==r.get()&&(g.set(100),A()),T()}function A(){const e=l.get();"Custom"!=e&&("16:9"==e?g.set(16/9):"4:3"==e?g.set(4/3):"16:10"==e?g.set(1.6):"21:9"==e?g.set(21/9):"2:1"==e?g.set(2):"1:1"==e?g.set(1):"9:16"==e?g.set(9/16):"1:2"==e?g.set(.5):"iPhoneXr Vert"==e&&g.set(9/19.5))}function T(){const e="Resolution"==r.get();if(a.setUiAttribs({greyout:!e}),s.setUiAttribs({greyout:!e}),l.setUiAttribs({greyout:e}),c.setUiAttribs({greyout:e}),g.setUiAttribs({greyout:e}),m=0,!e){const e=c.get();"Width"==e?m=C:"Height"==e?m=S:"Both"==e?m=O:"Auto"==e&&(m=x)}}function y(){b.canvas.style["margin-top"]="",b.canvas.style["margin-left"]="",h.set(0),d.set(0);const e=b.canvas.parentNode.getBoundingClientRect();b.setSize(e.width,e.height)}"absolute"===window.getComputedStyle(b.canvas).position&&(b.canvas.style.position="initial",e.warn("[cables forceCanvasSize] - canvas was positioned absolute, not compatible with Ops.Gl.ForceCanvasSize")),T(),g.onChange=()=>{y()},n.onChange=function(){n.get()||y()},t.onTriggered=function(){if(!n.get())return u.trigger();let e=a.get(),t=s.get(),r=b.canvas.parentNode.getBoundingClientRect();if(0==r.height&&(b.canvas.parentNode.style.height="100%",r=b.canvas.parentNode.getBoundingClientRect()),0==r.width&&(b.canvas.parentNode.style.width="100%",r=b.canvas.parentNode.getBoundingClientRect()),m==C)e=r.width,t=1*e/g.get();else if(m==S)t=r.height,e=t*g.get();else if(m==x){const n=r;t=n.height,e=t*g.get(),e>n.width&&(e=n.width,t=1*e/g.get())}else if(m==O){const n=r;t=n.height,e=t*g.get(),e<n.width&&(e=n.width,t=1*e/g.get())}if(e=Math.ceil(e),t=Math.ceil(t),o.get()){const n=r,o=(n.height-t)/2,i=(n.width-e)/2;h.set(i),d.set(o),b.canvas.style["margin-top"]=o+"px",b.canvas.style["margin-left"]=i+"px"}else b.canvas.style["margin-top"]="0",b.canvas.style["margin-left"]="0",h.set(0),d.set(0);if(i.get()){const e=r,t=e.width/a.get(),n=e.height/s.get();b.canvas.style.transform="scale("+Math.min(t,n)+")"}b.canvas.width/b.pixelDensity==e&&b.canvas.height/b.pixelDensity==t||(p.set(e),f.set(t),b.setSize(e,t)),u.trigger()}},Ops.Patch.Pw01AEC.ForceCanvasSize_Custom.prototype=new CABLES.Op,CABLES.OPS["3af056c8-9d23-4305-ab36-d9bf5391fd7a"]={f:Ops.Patch.Pw01AEC.ForceCanvasSize_Custom,objName:"Ops.Patch.Pw01AEC.ForceCanvasSize_Custom"},Ops.Math.Ceil=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inValue("Number"),n=e.outNumber("Result");function r(){n.set(Math.ceil(t.get()))}t.onChange=r},Ops.Math.Ceil.prototype=new CABLES.Op,CABLES.OPS["15ba7aa9-b1c3-4b20-b6bf-b52a3ba8c8c5"]={f:Ops.Math.Ceil,objName:"Ops.Math.Ceil"},Ops.Patch.Pw01AEC.GetScaleNumOrFit=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inTriggerButton("Execute"),n=e.inString("URL Param String"),r=e.outTrigger("Scale Set Trigger"),o=e.outNumber("Scale Out"),i=e.outTrigger("Fit Trigger");t.onTriggered=function(){let e=n.get();if(!("string"==typeof e||e instanceof String))return;let t=parseFloat(e);if(console.log(t,e),!isNaN(t))return o.set(t),void r.trigger();"fit"===e&&i.trigger()}},Ops.Patch.Pw01AEC.GetScaleNumOrFit.prototype=new CABLES.Op,CABLES.OPS["bc80b842-5018-4570-a26d-071620efe66c"]={f:Ops.Patch.Pw01AEC.GetScaleNumOrFit,objName:"Ops.Patch.Pw01AEC.GetScaleNumOrFit"},Ops.String.StringEquals=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inString("String 1"),n=e.inString("String 2"),r=e.outBoolNum("Result");t.onChange=n.onChange=function(){r.set(t.get()==n.get())}},Ops.String.StringEquals.prototype=new CABLES.Op,CABLES.OPS["ef15195a-760b-4ac5-9630-322b0ba7b722"]={f:Ops.String.StringEquals,objName:"Ops.String.StringEquals"},Ops.Ui.VizGraph=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inFloat("Number 1"),n=e.inFloat("Number 2"),r=e.inFloat("Number 3"),o=e.inFloat("Number 4"),i=e.inFloat("Number 5"),a=e.inFloat("Number 6"),s=e.inFloat("Number 7"),l=e.inFloat("Number 8"),g=e.inTriggerButton("Reset");e.setUiAttrib({height:150,resizable:!0});let c=[],u=-Number.MAX_VALUE,p=Number.MAX_VALUE;t.onLinkChanged=n.onLinkChanged=r.onLinkChanged=o.onLinkChanged=i.onLinkChanged=a.onLinkChanged=s.onLinkChanged=l.onLinkChanged=g.onTriggered=()=>{u=-Number.MAX_VALUE,p=Number.MAX_VALUE,c=[]},e.renderVizLayer=(t,n)=>{const r=CABLES.UI.uiProfiler.start("previewlayer graph"),o=["#00ffff","#ffff00","#ff00ff","#0000ff","#00ff00","#ff0000","#ffffff","#888888"];t.fillStyle="#222",t.fillRect(n.x,n.y,n.width,n.height);for(let r=0;r<e.portsIn.length;r++){if(!e.portsIn[r].isLinked())continue;const i=e.portsIn[r].get();u=Math.max(e.portsIn[r].get(),u),p=Math.min(e.portsIn[r].get(),p),c[r]||(c[r]=[]),c[r].push(i),c[r].length>60&&c[r].shift();const a=n.width/60;t.lineWidth=2,t.strokeStyle="#555555",t.beginPath(),t.moveTo(n.x,CABLES.map(0,p,u,n.height,0)+n.y),t.lineTo(n.x+n.width,CABLES.map(0,p,u,n.height,0)+n.y),t.stroke(),t.strokeStyle=o[r],t.beginPath();for(let e=0;e<c[r].length;e++){let o=c[r][e];o=CABLES.map(o,p,u,n.height,0),o+=n.y,0===e?t.moveTo(n.x,o):t.lineTo(n.x+e*a,o)}t.stroke()}t.fillStyle="#888",t.fillText("max:"+Math.round(100*u)/100,n.x+10,n.y+n.height-10),t.fillText("min:"+Math.round(100*p)/100,n.x+10,n.y+n.height-30),r.finish()}},Ops.Ui.VizGraph.prototype=new CABLES.Op,CABLES.OPS["13c54eb4-60ef-4b9c-8425-d52a431f5c87"]={f:Ops.Ui.VizGraph,objName:"Ops.Ui.VizGraph"},Ops.Vars.VarGetString=function(){CABLES.Op.apply(this,arguments);const e=this;var t=e.outString("Value");e.varName=e.inValueSelect("Variable",[],"",!0),new CABLES.VarGetOpWrapper(e,"string",e.varName,t)},Ops.Vars.VarGetString.prototype=new CABLES.Op,CABLES.OPS["3ad08cfc-bce6-4175-9746-fef2817a3b12"]={f:Ops.Vars.VarGetString,objName:"Ops.Vars.VarGetString"},Ops.String.FreezeString=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inString("String","default"),n=e.inTriggerButton("Button"),r=e.inString("StoredString"),o=e.outString("Frozen String");function i(){r.set(t.get()),o.set(r.get())}n.onTriggered=r.onTriggered=i,r.setUiAttribs({hideParam:!0,hidePort:!0,ignoreBigPort:!0}),o.onLinkChanged=()=>{o.set(r.get())}},Ops.String.FreezeString.prototype=new CABLES.Op,CABLES.OPS["9ae2598f-8b5a-4749-aff3-a507c9957225"]={f:Ops.String.FreezeString,objName:"Ops.String.FreezeString"},Ops.Value.NumberSwitchBoolean=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inValueBool("Boolean"),n=e.inValue("Value false",0),r=e.inValue("Value true",1),o=e.outNumber("Result");function i(){t.get()?o.set(r.get()):o.set(n.get())}t.onChange=r.onChange=n.onChange=i,e.setPortGroup("Output Values",[r,n])},Ops.Value.NumberSwitchBoolean.prototype=new CABLES.Op,CABLES.OPS["637c5fa8-840d-4535-96ab-3d27b458a8ba"]={f:Ops.Value.NumberSwitchBoolean,objName:"Ops.Value.NumberSwitchBoolean"},Ops.Gl.Textures.ColorTexture=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inValueSlider("r",Math.random()),n=e.inValueSlider("g",Math.random()),r=e.inValueSlider("b",Math.random()),o=e.inValueSlider("a",1),i=e.outTexture("texture_out");t.setUiAttribs({colorPick:!0});const a=e.patch.cgl;let s=null,l=!1;function g(){const e=l||t.get()<0||t.get()>1||n.get()<0||n.get()>1||r.get()<0||r.get()>1;s&&l==e||(s&&s.dispose(),s=1==a.glVersion?new CGL.Framebuffer(a,8,8,{name:"colorTexture"}):new CGL.Framebuffer2(a,8,8,{name:"colorTexture",depth:!1,isFloatingPointTexture:e}),s.setFilter(CGL.Texture.FILTER_LINEAR),l=e),s.renderStart(),a.gl.clearColor(t.get(),n.get(),r.get(),o.get()),a.gl.clear(a.gl.COLOR_BUFFER_BIT),s.renderEnd(),i.setRef(s.getTextureColor())}t.onChange=n.onChange=r.onChange=o.onChange=()=>{a.addNextFrameOnceCallback(g)},a.addNextFrameOnceCallback(g),e.onDelete=()=>{s.dispose()}},Ops.Gl.Textures.ColorTexture.prototype=new CABLES.Op,CABLES.OPS["59b94270-0364-4c0f-a9fc-ba2561696a23"]={f:Ops.Gl.Textures.ColorTexture,objName:"Ops.Gl.Textures.ColorTexture"},Ops.Gl.Textures.SwitchTextures_v2=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inTrigger("exec"),n=this.inValueInt("num"),r=e.inValueBool("Default Texture Transparent",!0),o=e.outTrigger("Next"),i=this.outTexture("texture"),a=e.patch.cgl,s=[];let l=0,g=-1,c=CGL.Texture.getEmptyTexture(a);e.toWorkPortsNeedToBeLinked(t),t.onTriggered=function(){p(),o.trigger()},r.onChange=function(){c=r.get()?CGL.Texture.getEmptyTexture(a):CGL.Texture.getTempTexture(a),p(!0)};for(let t=0;t<16;t++){const n=e.inTexture("texture"+t);s.push(n),n.onChange=u}function u(){p(!0)}function p(e){if(l=parseInt(n.get(),10),!e){if(l==g)return;if(l!=l)return}(isNaN(l)||l<0||l>s.length-1)&&(l=0),s[l].get()?i.set(s[l].get()):i.set(c),g=l}},Ops.Gl.Textures.SwitchTextures_v2.prototype=new CABLES.Op,CABLES.OPS["a82ae429-ac07-4760-882b-595a857c7ae0"]={f:Ops.Gl.Textures.SwitchTextures_v2,objName:"Ops.Gl.Textures.SwitchTextures_v2"},Ops.Ui.VizString=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inString("String",""),n=e.outString("Result");e.setUiAttrib({widthOnlyGrow:!0}),t.onChange=()=>{let r=t.get();e.patch.isEditorMode()&&(r=null===r?"null":void 0===r?"undefined":'"'+(String(r)||"")+'"',e.setTitle(r)),n.set(t.get())}},Ops.Ui.VizString.prototype=new CABLES.Op,CABLES.OPS["b04ff547-f557-4a54-a3ad-8a668fe1303d"]={f:Ops.Ui.VizString,objName:"Ops.Ui.VizString"},Ops.Trigger.TriggerString=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inTriggerButton("Trigger"),n=e.inString("String",""),r=e.outTrigger("Next"),o=e.outString("Result");o.changeAlways=!0,t.onTriggered=function(){o.set(n.get()),r.trigger()}},Ops.Trigger.TriggerString.prototype=new CABLES.Op,CABLES.OPS["217482b8-2ee6-4609-b7ad-4550e6aaa371"]={f:Ops.Trigger.TriggerString,objName:"Ops.Trigger.TriggerString"},Ops.Boolean.Or=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inValueBool("bool 1"),n=e.inValueBool("bool 2"),r=e.inValueBool("bool 3"),o=e.inValueBool("bool 4"),i=e.inValueBool("bool 5"),a=e.inValueBool("bool 6"),s=e.inValueBool("bool 7"),l=e.inValueBool("bool 8"),g=e.inValueBool("bool 9"),c=e.inValueBool("bool 10"),u=e.outBoolNum("result");function p(){u.set(t.get()||n.get()||r.get()||o.get()||i.get()||a.get()||s.get()||l.get()||g.get()||c.get())}t.onChange=n.onChange=r.onChange=o.onChange=i.onChange=a.onChange=s.onChange=l.onChange=g.onChange=c.onChange=p},Ops.Boolean.Or.prototype=new CABLES.Op,CABLES.OPS["b3b36238-4592-4e11-afe3-8361c4fd6be5"]={f:Ops.Boolean.Or,objName:"Ops.Boolean.Or"},Ops.Patch.Pw01AEC.TimeLinePlayer_CustomFPS=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inTriggerButton("Play"),n=e.inTriggerButton("Pause"),r=e.inTriggerButton("rewind"),o=e.inFloat("Set current time",0),i=e.inFloat("Set ideal FPS",30),a=e.outTrigger("play trigger"),s=e.outTrigger("pause trigger"),l=e.outTrigger("rewind trigger"),g=e.outBool("is Playing"),c=e.outNumber("set time (seconds)"),u=e.outNumber("current time"),p=e.outNumber("current frame");t.onTriggered=function(){e.patch.timer.play(),e.patch.timer.setTime(o.get()),c.set(o.get()),a.trigger()},n.onTriggered=function(){e.patch.timer.pause(),s.trigger()},e.onAnimFrame=function(t){p.set(Math.floor(t*i.get())),u.set(t),g.set(e.patch.timer.isPlaying())},r.onTriggered=function(){e.patch.timer.setTime(0),l.trigger()}},Ops.Patch.Pw01AEC.TimeLinePlayer_CustomFPS.prototype=new CABLES.Op,CABLES.OPS["472dda32-6376-4907-a0f9-597e3fc6b556"]={f:Ops.Patch.Pw01AEC.TimeLinePlayer_CustomFPS,objName:"Ops.Patch.Pw01AEC.TimeLinePlayer_CustomFPS"},Ops.Gl.SaveScreenShot_v3=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inString("Filename","cables"),n=e.inTriggerButton("Screenshot"),r=e.outTrigger("Finished"),o=e.patch.cgl;n.onTriggered=function(){o.saveScreenshot(t.get(),(function(){r.trigger(),e.patch.resume()}))}},Ops.Gl.SaveScreenShot_v3.prototype=new CABLES.Op,CABLES.OPS["76843a4d-947f-41ca-9c8f-0faa6ce7380a"]={f:Ops.Gl.SaveScreenShot_v3,objName:"Ops.Gl.SaveScreenShot_v3"},Ops.TimeLine.TimeLineRewind=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inTriggerButton("exe"),n=e.outTrigger("Next");t.onTriggered=function(){e.patch.timer.setTime(0),n.trigger()}},Ops.TimeLine.TimeLineRewind.prototype=new CABLES.Op,CABLES.OPS["d3408604-858c-4226-8d4c-1ef669956f35"]={f:Ops.TimeLine.TimeLineRewind,objName:"Ops.TimeLine.TimeLineRewind"},Ops.Array.ArrayFloor=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inArray("In"),n=e.outArray("Result"),r=[];n.set(r),t.onChange=function(){var e=t.get();if(e){r.length!=e.length&&(r.length=e.length);for(var o=0;o<e.length;o++)r[o]=Math.floor(e[o]);n.set(null),n.set(r)}else n.set(null)}},Ops.Array.ArrayFloor.prototype=new CABLES.Op,CABLES.OPS["6ddbb878-5c95-4e4d-a068-760ff5bcf1f6"]={f:Ops.Array.ArrayFloor,objName:"Ops.Array.ArrayFloor"},Ops.Gl.TextureEffects.Clarity=function(){CABLES.Op.apply(this,arguments);const e=this,t={clarity_frag:"IN vec2 texCoord;\nUNI sampler2D tex;\nUNI float amount;\nUNI float pX,pY;\n\nvec3 desaturate(vec4 color)\n{\n    vec3 c= vec3(dot(vec3(0.2126,0.7152,0.0722), color.rgb));\n    return c;\n}\n\nvoid main()\n{\n    vec4 col=texture(tex,texCoord);\n\n    vec3 gray=desaturate(col);\n    vec3 m=smoothstep(0.2,0.5,gray)*smoothstep(0.75,0.5,gray);\n    vec4 col2=vec4(1.0);\n\n    col2.rgb = ((col.rgb - 0.5) * max(( vec3(amount)*m+0.5)*2.0, 0.0))+0.5;\n\n    outColor= col2;\n}\n\n\n"},n=e.inTrigger("Render"),r=e.outTrigger("Trigger"),o=e.inFloat("amount",.5),i=e.patch.cgl,a=new CGL.Shader(i,e.name);a.setSource(a.getDefaultVertexShader(),t.clarity_frag),new CGL.Uniform(a,"t","tex",0),new CGL.Uniform(a,"f","amount",o),n.onTriggered=function(){CGL.TextureEffect.checkOpInEffect(e)&&(i.pushShader(a),i.currentTextureEffect.bind(),i.setTexture(0,i.currentTextureEffect.getCurrentSourceTexture().tex),i.currentTextureEffect.finish(),i.popShader(),r.trigger())}},Ops.Gl.TextureEffects.Clarity.prototype=new CABLES.Op,CABLES.OPS["37d66c32-5594-4509-bba0-0ba2cbb706d8"]={f:Ops.Gl.TextureEffects.Clarity,objName:"Ops.Gl.TextureEffects.Clarity"},Ops.Gl.TextureEffects.Noise.Noise_v2=function(){CABLES.Op.apply(this,arguments);const e=this,t={noise_frag:"IN vec2 texCoord;\nUNI sampler2D tex;\nUNI float amount;\nUNI float time;\nUNI float thresh;\n\n#ifdef HAS_MULMASK\n    UNI sampler2D texMul;\n#endif\n\n{{CGL.BLENDMODES3}}\n{{MODULES_HEAD}}\n\n{{CGL.RANDOM_TEX}}\n\nvoid main()\n{\n    vec4 rnd;\n\n    #ifdef RGB\n        rnd=vec4(cgl_random3(texCoord.xy+vec2(time)),1.0);\n    #else\n        float r=cgl_random(texCoord.xy+vec2(time));\n        rnd=vec4( r,r,r,1.0 );\n    #endif\n\n    vec4 base=texture(tex,texCoord);\n    vec4 col=rnd;//( _blend(base.rgb,rnd.rgb) ,1.0);\n\n    #ifdef NORMALIZE\n        col.rgb=(col.rgb-0.5)*2.0;\n    #endif\n\n    #ifdef HAS_MULMASK\n        col.rgb*=texture(texMul,texCoord).rgb;\n    #endif\n\n    col*=step(thresh,cgl_random(texCoord.xy*11.0+vec2(time)));\n\n\n    outColor=cgl_blendPixel(base,col,amount);\n}"},n=e.inTrigger("Render"),r=CGL.TextureEffect.AddBlendSelect(e,"Blend Mode","normal"),o=CGL.TextureEffect.AddBlendAlphaMask(e),i=e.inValueSlider("Amount",1),a=e.inValueSlider("Threshold",0),s=e.inValueBool("Animated",!0),l=e.inValueBool("RGB",!1),g=e.inValueBool("Normalize",!1),c=e.inTexture("Multiply"),u=e.outTrigger("Next"),p=e.patch.cgl,f=new CGL.Shader(p,e.name),h=(new CGL.Uniform(f,"f","amount",i),new CGL.Uniform(f,"f","time",1));new CGL.Uniform(f,"f","thresh",a),new CGL.Uniform(f,"t","tex",0),new CGL.Uniform(f,"t","texMul",1),f.setSource(f.getDefaultVertexShader(),t.noise_frag),CGL.TextureEffect.setupBlending(e,f,r,i,o),e.toWorkPortsNeedToBeLinked(n),c.onChange=g.onChange=l.onChange=function(){f.toggleDefine("HAS_MULMASK",c.get()),f.toggleDefine("RGB",l.get()),f.toggleDefine("NORMALIZE",g.get())},n.onTriggered=function(){CGL.TextureEffect.checkOpInEffect(e,3)&&(s.get()?h.setValue(e.patch.freeTimer.get()/1e3%100):h.setValue(0),p.pushShader(f),p.setTexture(0,p.currentTextureEffect.getCurrentSourceTexture().tex),c.get()&&p.setTexture(1,c.get().tex),p.currentTextureEffect.bind(),p.currentTextureEffect.finish(),p.popShader(),u.trigger())}},Ops.Gl.TextureEffects.Noise.Noise_v2.prototype=new CABLES.Op,CABLES.OPS["b1d9aacc-dc52-43a6-a00f-414f08768800"]={f:Ops.Gl.TextureEffects.Noise.Noise_v2,objName:"Ops.Gl.TextureEffects.Noise.Noise_v2"},Ops.Html.ElementFadeInOut=function(){CABLES.Op.apply(this,arguments);const e=this,t={fadeInOut_css:"\n.CABLES_animFadedOut\n{\n    display:none !important;\n    opacity:0;\n}\n\n.CABLES_animFadeOut\n{\n    animation: CABLES_keysFadeOut $LENGTHs normal forwards ease-in-out;\n}\n\n.CABLES_animFadeIn\n{\n    /*display:block;*/\n    animation: CABLES_keysFadeIn $LENGTHs normal forwards ease-in-out;\n}\n\n@keyframes CABLES_keysFadeIn {\n    from { opacity: 0; }\n    to   { opacity: $FULLOPACITY; }\n}\n\n@keyframes CABLES_keysFadeOut {\n    from { opacity: $FULLOPACITY; }\n    to   { opacity: 0; }\n}\n"},n=e.inObject("HTML Element"),r=e.inValueBool("Visible",!0),o=e.inValue("Duration",.5),i=e.inValue("Opacity",1),a=e.outBoolNum("Is Showing",!1);let s=null;o.onChange=f,i.onChange=f,r.onChange=u,n.onChange=u;let l=null;const g="css_"+CABLES.uuid();f();let c=!0;function u(){const e=n.get();c?l&&e&&(r.get()?(a.set(!0),e&&e.classList&&!e.classList.contains("CABLES_animFadeIn")&&(clearTimeout(s),e.classList.remove("CABLES_animFadedOut"),e.classList.remove("CABLES_animFadeOut"),e.classList.add("CABLES_animFadeIn"),s=setTimeout((function(){e.classList.remove("CABLES_animFadeIn"),a.set(!0)}),1e3*o.get()))):(a.set(!0),e&&e.classList&&!e.classList.contains("CABLES_animFadeOut")&&(clearTimeout(s),e.classList.remove("CABLES_animFadeIn"),e.classList.add("CABLES_animFadeOut"),s=setTimeout((function(){e.classList.add("CABLES_animFadedOut"),a.set(!1)}),1e3*o.get())))):setTimeout(u,50)}function p(){let e=t.fadeInOut_css;for(;e.indexOf("$LENGTH")>-1;)e=e.replace("$LENGTH",o.get());for(;e.indexOf("$FULLOPACITY")>-1;)e=e.replace("$FULLOPACITY",i.get());return e}function f(){l=document.getElementById(g),l?l.textContent=p():(l=document.createElement("style"),l.type="text/css",l.id=g,l.textContent=p(),document.getElementsByTagName("body")[0].appendChild(l))}c=!0,e.onLoaded=function(){c=!0,u(),a.set(r.get())},e.onDelete=function(){const e=n.get();e&&e.classList&&(e.classList.remove("CABLES_animFadeIn"),e.classList.remove("CABLES_animFadedOut"),e.classList.remove("CABLES_animFadeOut")),l=document.getElementById(g),l&&l.remove()}},Ops.Html.ElementFadeInOut.prototype=new CABLES.Op,CABLES.OPS["392e65eb-4ebe-4adb-8711-e4cfe059c6c9"]={f:Ops.Html.ElementFadeInOut,objName:"Ops.Html.ElementFadeInOut"},Ops.Html.FontFile_v2=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inUrl("file",[".otf",".ttf",".woff",".woff2"]),n=e.inString("family"),r=e.outBoolNum("Loaded"),o=e.outTrigger("Loaded Trigger");let i,a=null;function s(){if(t.get()&&n.get())if(document.fonts)i=new FontFace(n.get(),"url("+e.patch.getFilePath(String(t.get()))+")"),a=e.patch.cgl.patch.loading.start("FontFile",t.get(),e),document.fonts.add(i),i.load(),i.loaded.then((t=>{r.set(!0),o.trigger(),e.patch.cgl.patch.loading.finished(a),e.patch.emitEvent("fontLoaded",n.get())}),(t=>{e.setUiError("loadingerror","Font loading error!"+i.status)}));else{const r=e.patch.getFilePath(String(t.get())),o="".endl()+"@font-face".endl()+"{".endl()+'  font-family: "'+n.get()+'";'.endl()+'  src: url("'+r+'") format("truetype");'.endl()+"}",i=document.createElement("style");i.type="text/css",i.innerHTML=o,document.getElementsByTagName("head")[document.getElementsByTagName("head").length-1].appendChild(i)}}t.onChange=function(){r.set(!1),s()},n.onChange=s},Ops.Html.FontFile_v2.prototype=new CABLES.Op,CABLES.OPS["68177370-116e-4c76-aef3-3b10d68e7227"]={f:Ops.Html.FontFile_v2,objName:"Ops.Html.FontFile_v2"},Ops.Math.Compare.GreaterOrEquals=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.outBoolNum("result"),n=e.inValueFloat("number1"),r=e.inValueFloat("number2");function o(){t.set(n.get()>=r.get())}n.onLinkChanged=r.onLinkChanged=n.onChange=r.onChange=o},Ops.Math.Compare.GreaterOrEquals.prototype=new CABLES.Op,CABLES.OPS["5f9ce320-1e8d-49cb-9927-337e0b3f4d45"]={f:Ops.Math.Compare.GreaterOrEquals,objName:"Ops.Math.Compare.GreaterOrEquals"},Ops.Html.AppendChild_v2=function(){CABLES.Op.apply(this,arguments);const e=this;let t=e.patch.cgl.canvas.parentElement,n=null,r=null,o=e.inObject("Parent",null,"element"),i=e.inObject("Child",null,"element"),a=e.outObject("Parent Out",null,"element"),s=e.outObject("Child Out",null,"element");function l(){let e=o.get(),t=i.get();e!==n&&(e?g(e,t):c(0,t),n=e),t!==r&&(t?u(e,t):p(),r=t),a.set(e),s.set(t)}function g(e,t){t&&e.appendChild(t)}function c(e,n){n&&t.appendChild(n)}function u(e,t){e&&e.appendChild(t)}function p(e,n){r&&t.appendChild(r)}o.onChange=l,i.onChange=l},Ops.Html.AppendChild_v2.prototype=new CABLES.Op,CABLES.OPS["e15cfbc7-d2fa-4348-8964-66d02aec77aa"]={f:Ops.Html.AppendChild_v2,objName:"Ops.Html.AppendChild_v2"},Ops.Gl.TextureEffects.Hue=function(){CABLES.Op.apply(this,arguments);const e=this,t={hue_frag:"UNI float hue;\n\n#ifdef HAS_TEXTURES\n  IN vec2 texCoord;\n  UNI sampler2D tex;\n#endif\n\n#ifdef TEX_MASK\n    UNI sampler2D texMask;\n#endif\n#ifdef TEX_OFFSET\n    UNI sampler2D texOffset;\n#endif\n\nvec3 rgb2hsv(vec3 c)\n{\n    vec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\n    vec4 p = mix(vec4(c.bg, K.wz), vec4(c.gb, K.xy), step(c.b, c.g));\n    vec4 q = mix(vec4(p.xyw, c.r), vec4(c.r, p.yzx), step(p.x, c.r));\n\n    float d = q.x - min(q.w, q.y);\n    float e = 1.0e-10;\n    return vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), d / (q.x + e), q.x);\n}\n\nvec3 hsv2rgb(vec3 c)\n{\n    vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n    vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n    return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\n\nvoid main()\n{\n   vec4 col=vec4(1.0,0.0,0.0,1.0);\n    #ifdef HAS_TEXTURES\n        col=texture(tex,texCoord);\n        float h=hue;\n\n        #ifdef TEX_OFFSET\n            h += texture(texOffset,texCoord).r;\n        #endif\n\n\n        vec3 hsv = rgb2hsv(col.rgb);\n        hsv.x=hsv.x+h;\n\n        #ifndef TEX_MASK\n            col.rgb = hsv2rgb(hsv);\n        #endif\n\n        #ifdef TEX_MASK\n            col.rgb = mix(col.rgb,hsv2rgb(hsv),texture(texMask,texCoord).r);\n        #endif\n\n   #endif\n   outColor= col;\n}"},n=e.inTrigger("render"),r=e.inValueSlider("hue",1),o=e.inTexture("Mask"),i=e.inTexture("Offset"),a=e.outTrigger("trigger"),s=e.patch.cgl,l=new CGL.Shader(s,e.name);l.setSource(l.getDefaultVertexShader(),t.hue_frag),new CGL.Uniform(l,"t","tex",0),new CGL.Uniform(l,"t","texMask",1),new CGL.Uniform(l,"t","texOffset",2);const g=new CGL.Uniform(l,"f","hue",1);r.onChange=function(){g.setValue(r.get())},o.onChange=i.onChange=()=>{l.toggleDefine("TEX_MASK",o.get()),l.toggleDefine("TEX_OFFSET",i.get())},n.onTriggered=function(){CGL.TextureEffect.checkOpInEffect(e)&&(s.pushShader(l),s.currentTextureEffect.bind(),s.setTexture(0,s.currentTextureEffect.getCurrentSourceTexture().tex),o.get()&&s.setTexture(1,o.get().tex),i.get()&&s.setTexture(2,i.get().tex),s.currentTextureEffect.finish(),s.popShader(),a.trigger())}},Ops.Gl.TextureEffects.Hue.prototype=new CABLES.Op,CABLES.OPS["94ef0da0-c920-415c-81b0-fecbd437991d"]={f:Ops.Gl.TextureEffects.Hue,objName:"Ops.Gl.TextureEffects.Hue"},Ops.Devices.Mobile.ScreenOrientation=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.outNumber("Angle"),n=e.outString("Description");let r=0;function o(){if(r++,!screen.orientation)return;screen.orientation.hasOwnProperty("angle")&&t.set(screen.orientation.angle);let e=screen.orientation.type+" #"+r+" WINORIENT:"+window.orientation;n.set(e)}window.addEventListener("resize",o,!1),window.addEventListener("orientationchange",o,!1),o(),screen&&screen.orientation&&screen.orientation.addEventListener("change",o),e.onDelete=function(){window.removeEventListener("resize",o),window.removeEventListener("orientationchange",o)}},Ops.Devices.Mobile.ScreenOrientation.prototype=new CABLES.Op,CABLES.OPS["ef8f5f5a-4652-4fad-983b-aca96d9cc13b"]={f:Ops.Devices.Mobile.ScreenOrientation,objName:"Ops.Devices.Mobile.ScreenOrientation"},Ops.String.StringContains_v2=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inString("String"),n=e.inString("SearchValue"),r=e.outBoolNum("Found",!1),o=e.outNumber("Index",-1);function i(){if(t.get()&&n.get()&&n.get().length>0){const e=t.get().indexOf(n.get());o.set(e),r.set(e>-1)}else o.set(-1),r.set(!1)}n.onChange=t.onChange=i,i()},Ops.String.StringContains_v2.prototype=new CABLES.Op,CABLES.OPS["2ca3e5d7-e6b4-46a7-8381-3fe1ad8b6879"]={f:Ops.String.StringContains_v2,objName:"Ops.String.StringContains_v2"},Ops.Value.FilterValidNumber=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inFloat("Number",0),n=e.inBool("Invalid when 0",!1),r=e.inBool("Invalid when <0",!1),o=e.outNumber("Last Valid Number"),i=e.outBool("Is Valid");function a(){const e=t.get();var a=!0;null!=e&&e==e||(a=!1),n.get()&&0===e&&(a=!1),r.get()&&e<0&&(a=!1),a&&o.set(e),i.set(a)}n.onChange=r.onChange=t.onChange=a},Ops.Value.FilterValidNumber.prototype=new CABLES.Op,CABLES.OPS["5a4db4ef-33d2-4131-9825-aa926f1f5a98"]={f:Ops.Value.FilterValidNumber,objName:"Ops.Value.FilterValidNumber"},Ops.String.ParseInt_v2=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inString("String",5711),n=e.outNumber("Number");t.onChange=function(){let e=parseInt(t.get());e!=e&&(e=0),n.set(e)}},Ops.String.ParseInt_v2.prototype=new CABLES.Op,CABLES.OPS["6d208424-daf2-4a2b-874f-daac406c1f66"]={f:Ops.String.ParseInt_v2,objName:"Ops.String.ParseInt_v2"},Ops.Trigger.IsTriggered=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inTrigger("Trigger"),n=e.outTrigger("Next"),r=e.outBoolNum("Was Triggered",!1);let o=0;e.onAnimFrame=function(e){o++,o>1&&r.set(!1)},t.onTriggered=function(){o=0,r.set(!0),n.trigger()}},Ops.Trigger.IsTriggered.prototype=new CABLES.Op,CABLES.OPS["7c96fee9-4c2f-45e1-a41b-096b06d286b8"]={f:Ops.Trigger.IsTriggered,objName:"Ops.Trigger.IsTriggered"},Ops.Array.ShuffleArray_v2=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inArray("Array3"),n=e.inFloat("Seed",1),r=e.outArray("Result");let o=[],i=[];function a(e){let t=0,n=0,r=null;for(t=e.length-1;t>0;t-=1)n=Math.floor(Math.seededRandom()*(t+1)),r=e[t],e[t]=e[n],e[n]=r}function s(){const e=t.get();if(!e)return void r.set(null);e.length!=o.length&&(i.length=o.length=e.length);let s=0;Math.randomSeed=n.get();for(let t=0;t<e.length;t++)i[t]=t;a(i);for(let t=0;t<e.length;t++)s=i[t],o[t]=e[s];r.set(null),r.set(o)}t.onChange=s,n.onChange=s},Ops.Array.ShuffleArray_v2.prototype=new CABLES.Op,CABLES.OPS["ea752da3-79f4-4674-95bf-722634365f53"]={f:Ops.Array.ShuffleArray_v2,objName:"Ops.Array.ShuffleArray_v2"},Ops.Gl.RenderAnim_v2=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inTrigger("Render"),n=e.outTrigger("Next"),r=e.inDropDown("File Type",["PNG","JPG","WebP","WebM"],"PNG"),o=e.inBool("ZIP multiple files",!1),i=e.inBool("Download Files",!0),a=e.inString("Filename","cables"),s=e.inFloatSlider("Quality",.8),l=e.inSwitch("Duration Type",["Seconds","Frames"],"Seconds"),g=e.inInt("Duration",1),c=e.inInt("FPS",30),u=e.inValueBool("Transparency",!1),p=e.inValueBool("Use Canvas Size",!0),f=e.inValueInt("texture width",512),h=e.inValueInt("texture height",512),d=e.inTriggerButton("Start"),m=e.outNumber("Progress",0),C=e.outNumber("Frame",0),S=e.outString("Status","Waiting"),O=e.outBool("Started"),x=e.outString("Data URL"),b=e.outTrigger("Finished");e.setPortGroup("File",[r,o,i,a,s]),e.setPortGroup("Size",[p,f,h]),e.setPortGroup("Timing",[c,l,g]),x.ignoreValueSerialize=!0,t.onTriggered=U;let E=!1,A=0,T=30,y=31,L=CABLES.shortId(),v=!1;const B=[];let w=-1,P=0,N="",_=null,M=e.patch.cgl.canvasWidth,V=e.patch.cgl.canvasHeight;function G(){s.setUiAttribs({greyout:"PNG"==r.get()})}function F(){f.setUiAttribs({greyout:p.get()}),h.setUiAttribs({greyout:p.get()})}function I(){y>=0&&(P=Math.max(0,A*(1/T)),e.patch.timer.setTime(P),CABLES.overwriteTime=P,e.patch.freeTimer.setTime(P))}function R(){E=!1,CABLES.overwriteTime=void 0,S.set("Finished")}function U(){if(O.set(E),!E)return void n.trigger();const t=CABLES.internalNow;if(E&&(CABLES.internalNow=function(){return 1e3*P},I()),w==A)return void n.trigger();w=A;let o=A/y;if(o<0&&(o=0),m.set(o),C.set(A),n.trigger(),CABLES.internalNow=t,v=!1,A>y){if(e.log("FINISHED..."),e.log("ffmpeg -y -framerate 30 -f image2 -i "+N+"_%d.png  -b 9999k -vcodec mpeg4 "+L+".mp4"),p.get()||(e.patch.cgl.setSize(M,V),e.patch.cgl.updateSize()),_)_.generateAsync({type:"blob"}).then((function(e){const t=document.createElement("a");t.download=N+".zip",t.href=URL.createObjectURL(e),i.get()&&t.click(),R(),x.isLinked()?D(e,(e=>{x.set(e),b.trigger()})):(x.set(null),b.trigger())}));else if("WebM"==r.get()){try{S.set("Creating Video File from frames"),e.log("webm frames",B.length);const t=Whammy.fromImageArray(B,T),n=window.URL.createObjectURL(t),r=document.createElement("a");r.setAttribute("download",N+".webm"),r.setAttribute("href",n),document.body.appendChild(r),i.get()&&r.click(),R(),x.isLinked()?D(t,(e=>{x.set(e),b.trigger()})):(x.set(null),b.trigger())}catch(t){e.logError(t)}B.length=0}else R();return}let a="image/png",l="png";"JPG"==r.get()?(a="image/jpeg",l="jpg"):"WebP"==r.get()&&(a="image/webp",l="webp"),A>0?(S.set("Rendering Frame "+A+" of "+y),e.log("Rendering Frame "+A+" of "+y,P),"WebM"==r.get()?(B.push(e.patch.cgl.canvas.toDataURL("image/webp",.999*s.get())),A++,I()):(e.log("screenshotting frame...",A),e.patch.cgl.screenShot((t=>{if(t)if(_){let e=N+"_"+A+"."+l;_.file(e,t,{base64:!1}),A++,I()}else{let e=N+"_"+L+"_"+A+"."+l;const n=document.createElement("a");n.download=e,n.href=URL.createObjectURL(t),setTimeout((()=>{x.isLinked()?D(t,(e=>{x.set(e)})):x.set(null),i.get()&&n.click(),A++,I()}),200)}else e.log("screenshot: no blob")}),!u.get(),a,s.get()))):(S.set("Prerendering..."),e.log("pre ",A,P),e.patch.cgl.screenShot((e=>{A++,I()})))}function D(e,t){let n=new FileReader;n.onload=function(e){t(e.target.result)},n.readAsDataURL(e)}r.onChange=G,p.onChange=F,G(),F(),o.onChange=()=>{_=null},d.onTriggered=function(){N=a.get(),e.log("pref",N),B.length=0,S.set("Starting"),T=c.get(),y=g.get()*T,"Frames"==l.get()&&(y=g.get()),L=CABLES.shortId(),I(),o.get()&&(_=new JSZip),p.get()||(M=CABLES.patch.cgl.canvasWidth,V=CABLES.patch.cgl.canvasHeight,e.patch.cgl.setSize(f.get()/CABLES.patch.cgl.pixelDensity,h.get()/CABLES.patch.cgl.pixelDensity),e.patch.cgl.updateSize()),0==y?(A=0,E=!0):(A=-20,E=!0,w=-9999)}},Ops.Gl.RenderAnim_v2.prototype=new CABLES.Op,CABLES.OPS["c05e54a3-3ed5-4941-a412-01134f53f0ac"]={f:Ops.Gl.RenderAnim_v2,objName:"Ops.Gl.RenderAnim_v2"},Ops.Cables.PatchInfo_v2=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.outObject("Config"),n=e.outString("Name"),r=e.outString("Patch Id"),o=e.outString("Namespace"),i=e.outNumber("Last Saved"),a=e.outNumber("Last Exported"),s=u();function l(){let e=null;return s&&s._id&&(e=s._id),s&&s.config&&s.config.patch&&s.config.patch._id&&(e=s.config.patch._id),window.gui&&window.gui.patchId&&(e=window.gui.patchId),window.CABLES&&window.CABLES.patchId&&(e=window.CABLES.patchId),CABLES.patchId&&(e=CABLES.patchId),e}function g(){let e=null;return s&&s.config&&s.config.patch&&(e=s.config.patch.updated),window.gui&&window.gui.project&&(e=window.gui.project().updated),new Date(e).getTime()}function c(){let e=null;if(s&&s.config&&s.config.patch&&s.config.patch.deployments&&s.config.patch.deployments.lastDeployment&&(e=s.config.patch.deployments.lastDeployment.date),window.gui&&window.gui.project){const t=window.gui.project();t.deployments&&t.deployments.lastDeployment&&(e=t.deployments.lastDeployment.date)}return new Date(e).getTime()}function u(){let t=null;return CABLES&&CABLES.exportedPatch&&(t=CABLES.exportedPatch),CABLES&&CABLES.patch&&(t=CABLES.patch),e.patch&&(t=e.patch),t}t.set(s.config),n.set(s.name),r.set(l()),o.set(s.namespace),i.set(g()),a.set(c())},Ops.Cables.PatchInfo_v2.prototype=new CABLES.Op,CABLES.OPS["7187c2f2-67a9-479e-92c4-0e415443f504"]={f:Ops.Cables.PatchInfo_v2,objName:"Ops.Cables.PatchInfo_v2"},Ops.String.StringReplace=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inString("String"),n=e.inString("Search For","foo"),r=e.inString("Replace","bar"),o=e.inSwitch("Replace What",["All","First"],"All"),i=e.outString("Result");function a(){e.setUiError("exception",null);let a="";try{a="All"==o.get()?String(t.get()).replace(new RegExp(n.get(),"g"),r.get()):String(t.get()).replace(n.get(),r.get())}catch(t){e.setUiError("exception","exception "+t.message)}i.set(a)}r.onChange=t.onChange=o.onChange=n.onChange=a},Ops.String.StringReplace.prototype=new CABLES.Op,CABLES.OPS["4a053e7a-6b00-4e71-bd51-90cdb190994c"]={f:Ops.String.StringReplace,objName:"Ops.String.StringReplace"},Ops.Date.DateFormatter=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inValue("Timestamp"),n=e.inObject("Date"),r=e.inString("Format","YYYY-MM-DD"),o=e.outString("StringDate");function i(e){const t=moment(e),n=r.get();o.set(t.format(n))}t.onChange=function(){const e=t.get();i(new Date(e))},n.onChange=function(){i(n.get())},r.onChange=function(){i(new Date)}},Ops.Date.DateFormatter.prototype=new CABLES.Op,CABLES.OPS["8933d01f-39ac-428c-a64b-902c534a4fc0"]={f:Ops.Date.DateFormatter,objName:"Ops.Date.DateFormatter"},Ops.String.ConcatMulti_v2=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inBool("add spaces",!1),n=e.inBool("new lines",!1),r=[],o=e.outString("concat string");r.onChange=t.onChange=n.onChange=i,t.setUiAttribs({hidePort:!0}),n.setUiAttribs({hidePort:!0});for(let t=0;t<8;t++){let n=e.inString("string "+t);r.push(n),n.onChange=i}function i(){let e="",i="",a=t.get();for(let t=0;t<r.length;t++){const o=r[t].get();o&&(t>0&&a&&(e+=" "),t>0&&n.get()&&(i="\n"),e+=i,e+=o)}o.set(e)}},Ops.String.ConcatMulti_v2.prototype=new CABLES.Op,CABLES.OPS["bc110e48-812d-489d-b1b3-b09c644c6982"]={f:Ops.String.ConcatMulti_v2,objName:"Ops.String.ConcatMulti_v2"},Ops.Date.DateAndTime=function(){CABLES.Op.apply(this,arguments);const e=this;let t=500,n=50,r=t;const o=e.outNumber("Year"),i=e.outNumber("Month"),a=e.outNumber("Day"),s=e.outNumber("Hours"),l=e.outNumber("Minutes"),g=e.outNumber("Seconds"),c=e.outNumber("Timestamp"),u=e.inInt("Update Rate",t);let p=new Date,f=setTimeout(h,t);function h(){p=new Date,g.set(p.getSeconds()),l.set(p.getMinutes()),s.set(p.getHours()),a.set(p.getDate()),i.set(p.getMonth()),o.set(p.getFullYear()),f=setTimeout(h,r),c.set(Date.now())}h(),u.onChange=function(){let e=u.get();e&&e>=n&&(r=e)},e.onDelete=function(){clearTimeout(f)}},Ops.Date.DateAndTime.prototype=new CABLES.Op,CABLES.OPS["beff95ec-7b50-4b6e-80b8-a7e4ab97d8cc"]={f:Ops.Date.DateAndTime,objName:"Ops.Date.DateAndTime"},Ops.Boolean.BoolByTrigger=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inTriggerButton("True"),n=e.inTriggerButton("false"),r=e.outBoolNum("Result");t.onTriggered=function(){r.set(!0)},n.onTriggered=function(){r.set(!1)}},Ops.Boolean.BoolByTrigger.prototype=new CABLES.Op,CABLES.OPS["31f65abe-9d6c-4ba6-a291-ef2de41d2087"]={f:Ops.Boolean.BoolByTrigger,objName:"Ops.Boolean.BoolByTrigger"},Ops.Gl.DownloadTexture_v2=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inTexture("Texture"),n=e.inTriggerButton("Download"),r=e.inString("Filename","screenshot"),o=e.outBoolNum("Finished"),i=e.patch.cgl.gl;let a=null;function s(e,t){const n=atob(e.split(",")[1]),r=n.length,o=new Uint8Array(r);for(let e=0;e<r;e++)o[e]=n.charCodeAt(e);t(new Blob([o],{type:"image/png"}))}n.onTriggered=function(){if(!t.get()||!t.get().tex)return;o.set(!1);const n=t.get().width,l=t.get().height;t.get().textureType==CGL.Texture.TYPE_FLOAT?e.setUiError("fptex","Texture is more than 8 bit, not possible to create files with high precision"):e.setUiError("fptex",null),a||(a=i.createFramebuffer()),i.bindFramebuffer(i.FRAMEBUFFER,a),i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,t.get().tex,0);const g=i.checkFramebufferStatus(i.FRAMEBUFFER)==i.FRAMEBUFFER_COMPLETE;if(i.bindFramebuffer(i.FRAMEBUFFER,null),!g)return o.set(!0),void e.logError("cannot read texture!");i.bindFramebuffer(i.FRAMEBUFFER,a);const c=new Uint8Array(n*l*4);i.readPixels(0,0,n,l,i.RGBA,i.UNSIGNED_BYTE,c),i.bindFramebuffer(i.FRAMEBUFFER,null);const u=document.createElement("canvas");u.width=n,u.height=l;const p=u.getContext("2d"),f=p.createImageData(n,l);f.data.set(c);const h=f.data;Array.from({length:l},((e,t)=>h.slice(t*n*4,(t+1)*n*4))).forEach(((e,t)=>h.set(e,(l-t-1)*n*4))),p.putImageData(f,0,0),s(u.toDataURL(),(function(e){const t=navigator.userAgent||navigator.vendor||window.opera;if(/iPad|iPhone|iPod/.test(t)&&!window.MSStream){const t=new FileReader;t.onload=function(e){window.location.href=t.result},t.readAsDataURL(e)}else{const t=document.createElement("a");t.download=r.get()+".png",t.href=URL.createObjectURL(e),document.body.appendChild(t),t.click()}o.set(!0)}))}},Ops.Gl.DownloadTexture_v2.prototype=new CABLES.Op,CABLES.OPS["00d2a6ea-5843-43d0-9428-dbc47c112e6e"]={f:Ops.Gl.DownloadTexture_v2,objName:"Ops.Gl.DownloadTexture_v2"},Ops.Gl.TextureEffects.ImageComposeSnapshot=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inTrigger("Update"),n=e.outTrigger("trigger"),r=e.outTexture("Texture"),o=e.patch.cgl;let i=new CGL.CopyTexture(o,"textureThief",{}),a=!1,s=-1,l=-1;t.onTriggered=()=>{if(!CGL.TextureEffect.checkOpInEffect(e))return;const t=o.currentTextureEffect;t.endEffect();const g=o.currentTextureEffect.getCurrentSourceTexture().isFloatingPoint(),c=o.currentTextureEffect.getCurrentSourceTexture().wrap,u=o.currentTextureEffect.getCurrentSourceTexture().filter;a==g&&s==c&&l==u||(i=new CGL.CopyTexture(o,"textureThief",{isFloatingPointTexture:g,wrap:c,filter:u}),a=g,s=c,l=u),o.getViewPort(),r.set(CGL.Texture.getEmptyTexture(o));const p=o.currentTextureEffect.getCurrentSourceTexture();r.set(i.copy(p)),t.continueEffect(),n.trigger()}},Ops.Gl.TextureEffects.ImageComposeSnapshot.prototype=new CABLES.Op,CABLES.OPS["e15c0803-02bb-4783-9d75-e75abd70d910"]={f:Ops.Gl.TextureEffects.ImageComposeSnapshot,objName:"Ops.Gl.TextureEffects.ImageComposeSnapshot"},Ops.Devices.TouchScreen=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inValueBool("Disable Scaling",!0),n=e.inValueBool("Disable Scroll",!0),r=e.inValueBool("HDPI Coordinates",!1),o=e.inValueBool("Active",!0),i=e.outNumber("Touched",!1),a=e.outNumber("Fingers",0),s=e.outNumber("Finger 1 X",0),l=e.outNumber("Finger 1 Y",0),g=e.outNumber("Finger 1 Force",0),c=e.outNumber("Finger 2 X",0),u=e.outNumber("Finger 2 Y",0),p=e.outNumber("Finger 2 Force",0),f=e.inSwitch("Area",["Canvas","Document"],"Canvas"),h=e.outArray("Events"),d=e.inValueBool("Normalize Coordinates"),m=e.inValueBool("Flip Y"),C=e.outTrigger("Touch Start"),S=e.outTrigger("Touch End");function O(t){if(t.touches&&t.touches.length>0){var n=t.target.getBoundingClientRect(),o=t.touches[0].clientX-t.touches[0].target.offsetLeft,i=t.touches[0].clientY-t.touches[0].target.offsetTop;m.get()&&(i=n.height-i),r.get()&&(o*=e.patch.cgl.pixelDensity||1,i*=e.patch.cgl.pixelDensity||1),d.get()&&(o=o/n.width*2-1,i=i/n.height*2-1),s.set(o),l.set(i),t.touches[0].force&&g.set(t.touches[0].force)}t.touches&&t.touches.length>1&&(n=t.target.getBoundingClientRect(),o=t.touches[1].clientX-t.touches[1].target.offsetLeft,i=t.touches[1].clientY-t.touches[1].target.offsetTop,r.get()&&(o*=e.patch.cgl.pixelDensity||1,i*=e.patch.cgl.pixelDensity||1),d.get()&&(o=o/n.width*2-1,i=i/n.height*2-1),c.set(o),u.set(i),t.touches[1].force&&p.set(t.touches[1].force)),h.set(t.touches)}f.onChange=L;const x=function(e){i.set(!0),O(e),a.set(e.touches.length),C.trigger()},b=function(e){i.set(!1),g.set(0),p.set(0),O(e),a.set(e.touches.length),S.trigger()},E=function(e){O(e),a.set(e.touches.length),n.get()||t.get()&&1!==e.scale?(e.preventDefault(),document.body.style["touch-action"]="none"):document.body.style["touch-action"]="initial"},A=e.patch.cgl;let T=null;function y(){T.addEventListener("touchmove",E,{passive:!0}),T.addEventListener("touchstart",x,{passive:!0}),T.addEventListener("touchend",b,{passive:!0})}function L(){v(),T="Document"==f.get()?document:A.canvas,o.get()&&y()}function v(){T&&(T.removeEventListener("touchmove",E),T.removeEventListener("touchstart",x),T.removeEventListener("touchend",b)),T=null}o.onChange=function(){L()},L()},Ops.Devices.TouchScreen.prototype=new CABLES.Op,CABLES.OPS["cedffacf-0f09-4342-bd21-540bd9c8037d"]={f:Ops.Devices.TouchScreen,objName:"Ops.Devices.TouchScreen"},Ops.Trigger.TriggerIfIncreased=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inFloat("Value"),n=e.outTrigger("Trigger");let r=-Number.MAX_VALUE;t.onChange=function(){const e=t.get();e>r&&n.trigger(),r=e}},Ops.Trigger.TriggerIfIncreased.prototype=new CABLES.Op,CABLES.OPS["bc820891-48c7-4287-9b5e-4196e192741b"]={f:Ops.Trigger.TriggerIfIncreased,objName:"Ops.Trigger.TriggerIfIncreased"},Ops.Patch.Pw01AEC.FxHashContext=function(){CABLES.Op.apply(this,arguments);const e=this;(!CABLES.fakefxhash&&!window.fxhash||CABLES.fakefxhash)&&(CABLES.fakefxhash=!0);const t=!CABLES.fakefxhash,n=e.outString("context",""),r=(e.outBoolNum("faking",!t),e.outBoolNum("standalone",!1)),o=e.outBoolNum("capture/preview",!1),i=e.outBoolNum("minting",!1);if(t&&$fx){const e=$fx.context;n.set(e),r.set("standalone"===e),o.set("capture"===e),i.set("minting"===e)}else n.set("faking")},Ops.Patch.Pw01AEC.FxHashContext.prototype=new CABLES.Op,CABLES.OPS["1710d10e-c07d-487d-8ca4-dc139c7d6eb9"]={f:Ops.Patch.Pw01AEC.FxHashContext,objName:"Ops.Patch.Pw01AEC.FxHashContext"},Ops.Patch.Pw01AEC.NumberGetRangeNameString=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inFloat("Input",0),n=e.inString("Default","default"),r=5,o=[];for(let t=0;t<r;t++)o.push({index:t+1,min:e.inFloat(`Min ${t+1}`,0),name:e.inString(`Name ${t+1}`,`Name ${t+1}`)});const i=e.outString("Range Name",n.get()),a=e.outNumber("Range Index",0);t.onChange=s,n.onChange=s;for(let e=0;e<r;e++)o[e].min.onChange=s,o[e].name.onChange=s;function s(){const e=t.get();let r=n.get(),s=0;for(let t=0;t<o.length;t++){const n=o[t],i=n.min.get(),a=n.name.get();if(!a||""===a)break;if(isNaN(i))break;if(t>0&&i<=o[t-1].min.get())break;if(e<i)break;r=n.name.get(),s=n.index}i.set(r),a.set(s)}},Ops.Patch.Pw01AEC.NumberGetRangeNameString.prototype=new CABLES.Op,CABLES.OPS["2fd46a79-be51-4ae6-aebc-aa5f68b48c33"]={f:Ops.Patch.Pw01AEC.NumberGetRangeNameString,objName:"Ops.Patch.Pw01AEC.NumberGetRangeNameString"},Ops.String.SwitchStringBoolean=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inValueBool("Boolean"),n=e.inString("True","Yes"),r=e.inString("False","No"),o=e.outString("Result");function i(){t.get()?o.set(n.get()):o.set(r.get())}t.onChange=r.onChange=n.onChange=i,i()},Ops.String.SwitchStringBoolean.prototype=new CABLES.Op,CABLES.OPS["19e3c428-22ce-45a3-b903-fddfc46fc0a3"]={f:Ops.String.SwitchStringBoolean,objName:"Ops.String.SwitchStringBoolean"},Ops.Patch.Pw01AEC.FxHashPreview=function(){CABLES.Op.apply(this,arguments);const e=this;(!CABLES.fakefxhash&&!window.fxhash||CABLES.fakefxhash)&&(CABLES.fakefxhash=!0);const t=!CABLES.fakefxhash,n=e.inTriggerButton("Trigger Preview"),r=e.inTriggerButton("Reset"),o=e.outTrigger("Then");e.outBoolNum("fxhash environment",t);let i=!1;const a=e.outBoolNum("Function Called",i);r.onTriggered=()=>{i=!1,a.set(i)},n.onTriggered=()=>{i||(t&&window.fxpreview?window.fxpreview():console.warn("No FxHash snippet! No preview!"),i=!0,a.set(i),o.trigger())}},Ops.Patch.Pw01AEC.FxHashPreview.prototype=new CABLES.Op,CABLES.OPS["77c23472-3830-464b-a1fe-14b534c6d3c0"]={f:Ops.Patch.Pw01AEC.FxHashPreview,objName:"Ops.Patch.Pw01AEC.FxHashPreview"},Ops.Patch.Pw01AEC.NamedConsoleLog=function(){CABLES.Op.apply(this,arguments);const e=this,t=e.inString("Name String",""),n=e.inFloat("Number",0),r=e.inString("String",""),o=console.debug;function i(e){return"string"==typeof e&&!isNaN(e)&&!isNaN(parseFloat(e))}n.onChange=function(){o(t.get(),n.get())},r.onChange=function(){o(t.get(),r.get())},t.onChange=function(){let n=t.get();if(e.patch.isEditorMode()){let t="";null===n?t="null":void 0===n?t="undefined":i(t)?(t=""+Math.round(1e4*n)/1e4,"-"!=t[0]&&(t=" "+t)):t=n,e.setUiAttribs({extendTitle:t})}}},Ops.Patch.Pw01AEC.NamedConsoleLog.prototype=new CABLES.Op,CABLES.OPS["59d1a055-d7aa-48d6-b33f-481a6e31ae2b"]={f:Ops.Patch.Pw01AEC.NamedConsoleLog,objName:"Ops.Patch.Pw01AEC.NamedConsoleLog"},window.addEventListener("load",(function(e){CABLES.jsLoaded=new Event("CABLES.jsLoaded"),document.dispatchEvent(CABLES.jsLoaded)}));